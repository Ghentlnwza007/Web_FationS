(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function XI(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var kp={exports:{}},Vc={},Np={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jw;function EA(){if(jw)return Re;jw=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),I=Symbol.iterator;function E(b){return b===null||typeof b!="object"?null:(b=I&&b[I]||b["@@iterator"],typeof b=="function"?b:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,U={};function L(b,X,Se){this.props=b,this.context=X,this.refs=U,this.updater=Se||A}L.prototype.isReactComponent={},L.prototype.setState=function(b,X){if(typeof b!="object"&&typeof b!="function"&&b!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,b,X,"setState")},L.prototype.forceUpdate=function(b){this.updater.enqueueForceUpdate(this,b,"forceUpdate")};function oe(){}oe.prototype=L.prototype;function J(b,X,Se){this.props=b,this.context=X,this.refs=U,this.updater=Se||A}var W=J.prototype=new oe;W.constructor=J,O(W,L.prototype),W.isPureReactComponent=!0;var Y=Array.isArray,he=Object.prototype.hasOwnProperty,Q={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function S(b,X,Se){var Ce,Ve={},Le=null,$e=null;if(X!=null)for(Ce in X.ref!==void 0&&($e=X.ref),X.key!==void 0&&(Le=""+X.key),X)he.call(X,Ce)&&!P.hasOwnProperty(Ce)&&(Ve[Ce]=X[Ce]);var Ue=arguments.length-2;if(Ue===1)Ve.children=Se;else if(1<Ue){for(var Je=Array(Ue),hn=0;hn<Ue;hn++)Je[hn]=arguments[hn+2];Ve.children=Je}if(b&&b.defaultProps)for(Ce in Ue=b.defaultProps,Ue)Ve[Ce]===void 0&&(Ve[Ce]=Ue[Ce]);return{$$typeof:n,type:b,key:Le,ref:$e,props:Ve,_owner:Q.current}}function R(b,X){return{$$typeof:n,type:b.type,key:X,ref:b.ref,props:b.props,_owner:b._owner}}function j(b){return typeof b=="object"&&b!==null&&b.$$typeof===n}function N(b){var X={"=":"=0",":":"=2"};return"$"+b.replace(/[=:]/g,function(Se){return X[Se]})}var M=/\/+/g;function k(b,X){return typeof b=="object"&&b!==null&&b.key!=null?N(""+b.key):X.toString(36)}function be(b,X,Se,Ce,Ve){var Le=typeof b;(Le==="undefined"||Le==="boolean")&&(b=null);var $e=!1;if(b===null)$e=!0;else switch(Le){case"string":case"number":$e=!0;break;case"object":switch(b.$$typeof){case n:case e:$e=!0}}if($e)return $e=b,Ve=Ve($e),b=Ce===""?"."+k($e,0):Ce,Y(Ve)?(Se="",b!=null&&(Se=b.replace(M,"$&/")+"/"),be(Ve,X,Se,"",function(hn){return hn})):Ve!=null&&(j(Ve)&&(Ve=R(Ve,Se+(!Ve.key||$e&&$e.key===Ve.key?"":(""+Ve.key).replace(M,"$&/")+"/")+b)),X.push(Ve)),1;if($e=0,Ce=Ce===""?".":Ce+":",Y(b))for(var Ue=0;Ue<b.length;Ue++){Le=b[Ue];var Je=Ce+k(Le,Ue);$e+=be(Le,X,Se,Je,Ve)}else if(Je=E(b),typeof Je=="function")for(b=Je.call(b),Ue=0;!(Le=b.next()).done;)Le=Le.value,Je=Ce+k(Le,Ue++),$e+=be(Le,X,Se,Je,Ve);else if(Le==="object")throw X=String(b),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.");return $e}function Ct(b,X,Se){if(b==null)return b;var Ce=[],Ve=0;return be(b,Ce,"","",function(Le){return X.call(Se,Le,Ve++)}),Ce}function Ft(b){if(b._status===-1){var X=b._result;X=X(),X.then(function(Se){(b._status===0||b._status===-1)&&(b._status=1,b._result=Se)},function(Se){(b._status===0||b._status===-1)&&(b._status=2,b._result=Se)}),b._status===-1&&(b._status=0,b._result=X)}if(b._status===1)return b._result.default;throw b._result}var Xe={current:null},ce={transition:null},we={ReactCurrentDispatcher:Xe,ReactCurrentBatchConfig:ce,ReactCurrentOwner:Q};function me(){throw Error("act(...) is not supported in production builds of React.")}return Re.Children={map:Ct,forEach:function(b,X,Se){Ct(b,function(){X.apply(this,arguments)},Se)},count:function(b){var X=0;return Ct(b,function(){X++}),X},toArray:function(b){return Ct(b,function(X){return X})||[]},only:function(b){if(!j(b))throw Error("React.Children.only expected to receive a single React element child.");return b}},Re.Component=L,Re.Fragment=t,Re.Profiler=i,Re.PureComponent=J,Re.StrictMode=r,Re.Suspense=m,Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=we,Re.act=me,Re.cloneElement=function(b,X,Se){if(b==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+b+".");var Ce=O({},b.props),Ve=b.key,Le=b.ref,$e=b._owner;if(X!=null){if(X.ref!==void 0&&(Le=X.ref,$e=Q.current),X.key!==void 0&&(Ve=""+X.key),b.type&&b.type.defaultProps)var Ue=b.type.defaultProps;for(Je in X)he.call(X,Je)&&!P.hasOwnProperty(Je)&&(Ce[Je]=X[Je]===void 0&&Ue!==void 0?Ue[Je]:X[Je])}var Je=arguments.length-2;if(Je===1)Ce.children=Se;else if(1<Je){Ue=Array(Je);for(var hn=0;hn<Je;hn++)Ue[hn]=arguments[hn+2];Ce.children=Ue}return{$$typeof:n,type:b.type,key:Ve,ref:Le,props:Ce,_owner:$e}},Re.createContext=function(b){return b={$$typeof:l,_currentValue:b,_currentValue2:b,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},b.Provider={$$typeof:a,_context:b},b.Consumer=b},Re.createElement=S,Re.createFactory=function(b){var X=S.bind(null,b);return X.type=b,X},Re.createRef=function(){return{current:null}},Re.forwardRef=function(b){return{$$typeof:d,render:b}},Re.isValidElement=j,Re.lazy=function(b){return{$$typeof:v,_payload:{_status:-1,_result:b},_init:Ft}},Re.memo=function(b,X){return{$$typeof:g,type:b,compare:X===void 0?null:X}},Re.startTransition=function(b){var X=ce.transition;ce.transition={};try{b()}finally{ce.transition=X}},Re.unstable_act=me,Re.useCallback=function(b,X){return Xe.current.useCallback(b,X)},Re.useContext=function(b){return Xe.current.useContext(b)},Re.useDebugValue=function(){},Re.useDeferredValue=function(b){return Xe.current.useDeferredValue(b)},Re.useEffect=function(b,X){return Xe.current.useEffect(b,X)},Re.useId=function(){return Xe.current.useId()},Re.useImperativeHandle=function(b,X,Se){return Xe.current.useImperativeHandle(b,X,Se)},Re.useInsertionEffect=function(b,X){return Xe.current.useInsertionEffect(b,X)},Re.useLayoutEffect=function(b,X){return Xe.current.useLayoutEffect(b,X)},Re.useMemo=function(b,X){return Xe.current.useMemo(b,X)},Re.useReducer=function(b,X,Se){return Xe.current.useReducer(b,X,Se)},Re.useRef=function(b){return Xe.current.useRef(b)},Re.useState=function(b){return Xe.current.useState(b)},Re.useSyncExternalStore=function(b,X,Se){return Xe.current.useSyncExternalStore(b,X,Se)},Re.useTransition=function(){return Xe.current.useTransition()},Re.version="18.3.1",Re}var Vw;function Ug(){return Vw||(Vw=1,Np.exports=EA()),Np.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lw;function TA(){if(Lw)return Vc;Lw=1;var n=Ug(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(d,m,g){var v,I={},E=null,A=null;g!==void 0&&(E=""+g),m.key!==void 0&&(E=""+m.key),m.ref!==void 0&&(A=m.ref);for(v in m)r.call(m,v)&&!a.hasOwnProperty(v)&&(I[v]=m[v]);if(d&&d.defaultProps)for(v in m=d.defaultProps,m)I[v]===void 0&&(I[v]=m[v]);return{$$typeof:e,type:d,key:E,ref:A,props:I,_owner:i.current}}return Vc.Fragment=t,Vc.jsx=l,Vc.jsxs=l,Vc}var Ow;function xA(){return Ow||(Ow=1,kp.exports=TA()),kp.exports}var u=xA(),$=Ug();const vf=XI($);var Ed={},Pp={exports:{}},xn={},Rp={exports:{}},bp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mw;function SA(){return Mw||(Mw=1,(function(n){function e(ce,we){var me=ce.length;ce.push(we);e:for(;0<me;){var b=me-1>>>1,X=ce[b];if(0<i(X,we))ce[b]=we,ce[me]=X,me=b;else break e}}function t(ce){return ce.length===0?null:ce[0]}function r(ce){if(ce.length===0)return null;var we=ce[0],me=ce.pop();if(me!==we){ce[0]=me;e:for(var b=0,X=ce.length,Se=X>>>1;b<Se;){var Ce=2*(b+1)-1,Ve=ce[Ce],Le=Ce+1,$e=ce[Le];if(0>i(Ve,me))Le<X&&0>i($e,Ve)?(ce[b]=$e,ce[Le]=me,b=Le):(ce[b]=Ve,ce[Ce]=me,b=Ce);else if(Le<X&&0>i($e,me))ce[b]=$e,ce[Le]=me,b=Le;else break e}}return we}function i(ce,we){var me=ce.sortIndex-we.sortIndex;return me!==0?me:ce.id-we.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var m=[],g=[],v=1,I=null,E=3,A=!1,O=!1,U=!1,L=typeof setTimeout=="function"?setTimeout:null,oe=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function W(ce){for(var we=t(g);we!==null;){if(we.callback===null)r(g);else if(we.startTime<=ce)r(g),we.sortIndex=we.expirationTime,e(m,we);else break;we=t(g)}}function Y(ce){if(U=!1,W(ce),!O)if(t(m)!==null)O=!0,Ft(he);else{var we=t(g);we!==null&&Xe(Y,we.startTime-ce)}}function he(ce,we){O=!1,U&&(U=!1,oe(S),S=-1),A=!0;var me=E;try{for(W(we),I=t(m);I!==null&&(!(I.expirationTime>we)||ce&&!N());){var b=I.callback;if(typeof b=="function"){I.callback=null,E=I.priorityLevel;var X=b(I.expirationTime<=we);we=n.unstable_now(),typeof X=="function"?I.callback=X:I===t(m)&&r(m),W(we)}else r(m);I=t(m)}if(I!==null)var Se=!0;else{var Ce=t(g);Ce!==null&&Xe(Y,Ce.startTime-we),Se=!1}return Se}finally{I=null,E=me,A=!1}}var Q=!1,P=null,S=-1,R=5,j=-1;function N(){return!(n.unstable_now()-j<R)}function M(){if(P!==null){var ce=n.unstable_now();j=ce;var we=!0;try{we=P(!0,ce)}finally{we?k():(Q=!1,P=null)}}else Q=!1}var k;if(typeof J=="function")k=function(){J(M)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,Ct=be.port2;be.port1.onmessage=M,k=function(){Ct.postMessage(null)}}else k=function(){L(M,0)};function Ft(ce){P=ce,Q||(Q=!0,k())}function Xe(ce,we){S=L(function(){ce(n.unstable_now())},we)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){O||A||(O=!0,Ft(he))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(ce){switch(E){case 1:case 2:case 3:var we=3;break;default:we=E}var me=E;E=we;try{return ce()}finally{E=me}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,we){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var me=E;E=ce;try{return we()}finally{E=me}},n.unstable_scheduleCallback=function(ce,we,me){var b=n.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?b+me:b):me=b,ce){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=me+X,ce={id:v++,callback:we,priorityLevel:ce,startTime:me,expirationTime:X,sortIndex:-1},me>b?(ce.sortIndex=me,e(g,ce),t(m)===null&&ce===t(g)&&(U?(oe(S),S=-1):U=!0,Xe(Y,me-b))):(ce.sortIndex=X,e(m,ce),O||A||(O=!0,Ft(he))),ce},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(ce){var we=E;return function(){var me=E;E=we;try{return ce.apply(this,arguments)}finally{E=me}}}})(bp)),bp}var Fw;function AA(){return Fw||(Fw=1,Rp.exports=SA()),Rp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uw;function CA(){if(Uw)return xn;Uw=1;var n=Ug(),e=AA();function t(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function a(s,o){l(s,o),l(s+"Capture",o)}function l(s,o){for(i[s]=o,s=0;s<o.length;s++)r.add(o[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},I={};function E(s){return m.call(I,s)?!0:m.call(v,s)?!1:g.test(s)?I[s]=!0:(v[s]=!0,!1)}function A(s,o,c,f){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return f?!1:c!==null?!c.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function O(s,o,c,f){if(o===null||typeof o>"u"||A(s,o,c,f))return!0;if(f)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function U(s,o,c,f,p,y,T){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=f,this.attributeNamespace=p,this.mustUseProperty=c,this.propertyName=s,this.type=o,this.sanitizeURL=y,this.removeEmptyString=T}var L={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){L[s]=new U(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var o=s[0];L[o]=new U(o,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){L[s]=new U(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){L[s]=new U(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){L[s]=new U(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){L[s]=new U(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){L[s]=new U(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){L[s]=new U(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){L[s]=new U(s,5,!1,s.toLowerCase(),null,!1,!1)});var oe=/[\-:]([a-z])/g;function J(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var o=s.replace(oe,J);L[o]=new U(o,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var o=s.replace(oe,J);L[o]=new U(o,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var o=s.replace(oe,J);L[o]=new U(o,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){L[s]=new U(s,1,!1,s.toLowerCase(),null,!1,!1)}),L.xlinkHref=new U("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){L[s]=new U(s,1,!1,s.toLowerCase(),null,!0,!0)});function W(s,o,c,f){var p=L.hasOwnProperty(o)?L[o]:null;(p!==null?p.type!==0:f||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(O(o,c,p,f)&&(c=null),f||p===null?E(o)&&(c===null?s.removeAttribute(o):s.setAttribute(o,""+c)):p.mustUseProperty?s[p.propertyName]=c===null?p.type===3?!1:"":c:(o=p.attributeName,f=p.attributeNamespace,c===null?s.removeAttribute(o):(p=p.type,c=p===3||p===4&&c===!0?"":""+c,f?s.setAttributeNS(f,o,c):s.setAttribute(o,c))))}var Y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,he=Symbol.for("react.element"),Q=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),N=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),be=Symbol.for("react.suspense_list"),Ct=Symbol.for("react.memo"),Ft=Symbol.for("react.lazy"),Xe=Symbol.for("react.offscreen"),ce=Symbol.iterator;function we(s){return s===null||typeof s!="object"?null:(s=ce&&s[ce]||s["@@iterator"],typeof s=="function"?s:null)}var me=Object.assign,b;function X(s){if(b===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);b=o&&o[1]||""}return`
`+b+s}var Se=!1;function Ce(s,o){if(!s||Se)return"";Se=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(H){var f=H}Reflect.construct(s,[],o)}else{try{o.call()}catch(H){f=H}s.call(o.prototype)}else{try{throw Error()}catch(H){f=H}s()}}catch(H){if(H&&f&&typeof H.stack=="string"){for(var p=H.stack.split(`
`),y=f.stack.split(`
`),T=p.length-1,C=y.length-1;1<=T&&0<=C&&p[T]!==y[C];)C--;for(;1<=T&&0<=C;T--,C--)if(p[T]!==y[C]){if(T!==1||C!==1)do if(T--,C--,0>C||p[T]!==y[C]){var D=`
`+p[T].replace(" at new "," at ");return s.displayName&&D.includes("<anonymous>")&&(D=D.replace("<anonymous>",s.displayName)),D}while(1<=T&&0<=C);break}}}finally{Se=!1,Error.prepareStackTrace=c}return(s=s?s.displayName||s.name:"")?X(s):""}function Ve(s){switch(s.tag){case 5:return X(s.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 2:case 15:return s=Ce(s.type,!1),s;case 11:return s=Ce(s.type.render,!1),s;case 1:return s=Ce(s.type,!0),s;default:return""}}function Le(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case P:return"Fragment";case Q:return"Portal";case R:return"Profiler";case S:return"StrictMode";case k:return"Suspense";case be:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case N:return(s.displayName||"Context")+".Consumer";case j:return(s._context.displayName||"Context")+".Provider";case M:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Ct:return o=s.displayName||null,o!==null?o:Le(s.type)||"Memo";case Ft:o=s._payload,s=s._init;try{return Le(s(o))}catch{}}return null}function $e(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Le(o);case 8:return o===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Ue(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Je(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function hn(s){var o=Je(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),f=""+s[o];if(!s.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return p.call(this)},set:function(T){f=""+T,y.call(this,T)}}),Object.defineProperty(s,o,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(T){f=""+T},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Jo(s){s._valueTracker||(s._valueTracker=hn(s))}function Bl(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var c=o.getValue(),f="";return s&&(f=Je(s)?s.checked?"true":"false":s.value),s=f,s!==c?(o.setValue(s),!0):!1}function Rs(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Yo(s,o){var c=o.checked;return me({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??s._wrapperState.initialChecked})}function ah(s,o){var c=o.defaultValue==null?"":o.defaultValue,f=o.checked!=null?o.checked:o.defaultChecked;c=Ue(o.value!=null?o.value:c),s._wrapperState={initialChecked:f,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Xo(s,o){o=o.checked,o!=null&&W(s,"checked",o,!1)}function Fi(s,o){Xo(s,o);var c=Ue(o.value),f=o.type;if(c!=null)f==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+c):s.value!==""+c&&(s.value=""+c);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}o.hasOwnProperty("value")?kt(s,o.type,c):o.hasOwnProperty("defaultValue")&&kt(s,o.type,Ue(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(s.defaultChecked=!!o.defaultChecked)}function zl(s,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var f=o.type;if(!(f!=="submit"&&f!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+s._wrapperState.initialValue,c||o===s.value||(s.value=o),s.defaultValue=o}c=s.name,c!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,c!==""&&(s.name=c)}function kt(s,o,c){(o!=="number"||Rs(s.ownerDocument)!==s)&&(c==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+c&&(s.defaultValue=""+c))}var It=Array.isArray;function tr(s,o,c,f){if(s=s.options,o){o={};for(var p=0;p<c.length;p++)o["$"+c[p]]=!0;for(c=0;c<s.length;c++)p=o.hasOwnProperty("$"+s[c].value),s[c].selected!==p&&(s[c].selected=p),p&&f&&(s[c].defaultSelected=!0)}else{for(c=""+Ue(c),o=null,p=0;p<s.length;p++){if(s[p].value===c){s[p].selected=!0,f&&(s[p].defaultSelected=!0);return}o!==null||s[p].disabled||(o=s[p])}o!==null&&(o.selected=!0)}}function Wl(s,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return me({},o,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function ql(s,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(t(92));if(It(c)){if(1<c.length)throw Error(t(93));c=c[0]}o=c}o==null&&(o=""),c=o}s._wrapperState={initialValue:Ue(c)}}function lh(s,o){var c=Ue(o.value),f=Ue(o.defaultValue);c!=null&&(c=""+c,c!==s.value&&(s.value=c),o.defaultValue==null&&s.defaultValue!==c&&(s.defaultValue=c)),f!=null&&(s.defaultValue=""+f)}function bs(s){var o=s.textContent;o===s._wrapperState.initialValue&&o!==""&&o!==null&&(s.value=o)}function $l(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zo(s,o){return s==null||s==="http://www.w3.org/1999/xhtml"?$l(o):s==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Ds,ch=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,c,f,p){MSApp.execUnsafeLocalFunction(function(){return s(o,c,f,p)})}:s})(function(s,o){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=o;else{for(Ds=Ds||document.createElement("div"),Ds.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Ds.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;o.firstChild;)s.appendChild(o.firstChild)}});function Ui(s,o){if(o){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=o;return}}s.textContent=o}var js={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uh=["Webkit","ms","Moz","O"];Object.keys(js).forEach(function(s){uh.forEach(function(o){o=o+s.charAt(0).toUpperCase()+s.substring(1),js[o]=js[s]})});function Vs(s,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||js.hasOwnProperty(s)&&js[s]?(""+o).trim():o+"px"}function ea(s,o){s=s.style;for(var c in o)if(o.hasOwnProperty(c)){var f=c.indexOf("--")===0,p=Vs(c,o[c],f);c==="float"&&(c="cssFloat"),f?s.setProperty(c,p):s[c]=p}}var Hl=me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nr(s,o){if(o){if(Hl[s]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function ta(s,o){if(s.indexOf("-")===-1)return typeof o.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ls=null;function na(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var es=null,ts=null,gt=null;function Gl(s){if(s=wc(s)){if(typeof es!="function")throw Error(t(280));var o=s.stateNode;o&&(o=Oh(o),es(s.stateNode,s.type,o))}}function Os(s){ts?gt?gt.push(s):gt=[s]:ts=s}function Ms(){if(ts){var s=ts,o=gt;if(gt=ts=null,Gl(s),o)for(s=0;s<o.length;s++)Gl(o[s])}}function hh(s,o){return s(o)}function dh(){}var vr=!1;function fh(s,o,c){if(vr)return s(o,c);vr=!0;try{return hh(s,o,c)}finally{vr=!1,(ts!==null||gt!==null)&&(dh(),Ms())}}function Bi(s,o){var c=s.stateNode;if(c===null)return null;var f=Oh(c);if(f===null)return null;c=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(t(231,o,typeof c));return c}var Fs=!1;if(d)try{var Us={};Object.defineProperty(Us,"passive",{get:function(){Fs=!0}}),window.addEventListener("test",Us,Us),window.removeEventListener("test",Us,Us)}catch{Fs=!1}function mh(s,o,c,f,p,y,T,C,D){var H=Array.prototype.slice.call(arguments,3);try{o.apply(c,H)}catch(ne){this.onError(ne)}}var ns=!1,wr=null,ra=!1,qn=null,ph={onError:function(s){ns=!0,wr=s}};function gh(s,o,c,f,p,y,T,C,D){ns=!1,wr=null,mh.apply(ph,arguments)}function Kl(s,o,c,f,p,y,T,C,D){if(gh.apply(this,arguments),ns){if(ns){var H=wr;ns=!1,wr=null}else throw Error(t(198));ra||(ra=!0,qn=H)}}function rr(s){var o=s,c=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(c=o.return),s=o.return;while(s)}return o.tag===3?c:null}function Ql(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function yh(s){if(rr(s)!==s)throw Error(t(188))}function _h(s){var o=s.alternate;if(!o){if(o=rr(s),o===null)throw Error(t(188));return o!==s?null:s}for(var c=s,f=o;;){var p=c.return;if(p===null)break;var y=p.alternate;if(y===null){if(f=p.return,f!==null){c=f;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===c)return yh(p),s;if(y===f)return yh(p),o;y=y.sibling}throw Error(t(188))}if(c.return!==f.return)c=p,f=y;else{for(var T=!1,C=p.child;C;){if(C===c){T=!0,c=p,f=y;break}if(C===f){T=!0,f=p,c=y;break}C=C.sibling}if(!T){for(C=y.child;C;){if(C===c){T=!0,c=y,f=p;break}if(C===f){T=!0,f=y,c=p;break}C=C.sibling}if(!T)throw Error(t(189))}}if(c.alternate!==f)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?s:o}function vh(s){return s=_h(s),s!==null?zi(s):null}function zi(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=zi(s);if(o!==null)return o;s=s.sibling}return null}var Jl=e.unstable_scheduleCallback,sa=e.unstable_cancelCallback,Wi=e.unstable_shouldYield,rs=e.unstable_requestPaint,nt=e.unstable_now,im=e.unstable_getCurrentPriorityLevel,ia=e.unstable_ImmediatePriority,Yl=e.unstable_UserBlockingPriority,qi=e.unstable_NormalPriority,Xl=e.unstable_LowPriority,oa=e.unstable_IdlePriority,$i=null,Nn=null;function wh(s){if(Nn&&typeof Nn.onCommitFiberRoot=="function")try{Nn.onCommitFiberRoot($i,s,void 0,(s.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:Hi,Ir=Math.log,$n=Math.LN2;function Hi(s){return s>>>=0,s===0?32:31-(Ir(s)/$n|0)|0}var Er=64,Bs=4194304;function qe(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function ss(s,o){var c=s.pendingLanes;if(c===0)return 0;var f=0,p=s.suspendedLanes,y=s.pingedLanes,T=c&268435455;if(T!==0){var C=T&~p;C!==0?f=qe(C):(y&=T,y!==0&&(f=qe(y)))}else T=c&~p,T!==0?f=qe(T):y!==0&&(f=qe(y));if(f===0)return 0;if(o!==0&&o!==f&&(o&p)===0&&(p=f&-f,y=o&-o,p>=y||p===16&&(y&4194240)!==0))return o;if((f&4)!==0&&(f|=c&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=f;0<o;)c=31-Pn(o),p=1<<c,f|=s[c],o&=~p;return f}function Gi(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ki(s,o){for(var c=s.suspendedLanes,f=s.pingedLanes,p=s.expirationTimes,y=s.pendingLanes;0<y;){var T=31-Pn(y),C=1<<T,D=p[T];D===-1?((C&c)===0||(C&f)!==0)&&(p[T]=Gi(C,o)):D<=o&&(s.expiredLanes|=C),y&=~C}}function Zl(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function ec(){var s=Er;return Er<<=1,(Er&4194240)===0&&(Er=64),s}function tc(s){for(var o=[],c=0;31>c;c++)o.push(s);return o}function Qi(s,o,c){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-Pn(o),s[o]=c}function om(s,o){var c=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<c;){var p=31-Pn(c),y=1<<p;o[p]=0,f[p]=-1,s[p]=-1,c&=~y}}function nc(s,o){var c=s.entangledLanes|=o;for(s=s.entanglements;c;){var f=31-Pn(c),p=1<<f;p&o|s[f]&o&&(s[f]|=o),c&=~p}}var Me=0;function Tr(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var rc,aa,sc,ic,oc,xr=!1,la=[],Sr=null,Ar=null,Ht=null,Ji=new Map,is=new Map,Rn=[],Ih="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zs(s,o){switch(s){case"focusin":case"focusout":Sr=null;break;case"dragenter":case"dragleave":Ar=null;break;case"mouseover":case"mouseout":Ht=null;break;case"pointerover":case"pointerout":Ji.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":is.delete(o.pointerId)}}function sr(s,o,c,f,p,y){return s===null||s.nativeEvent!==y?(s={blockedOn:o,domEventName:c,eventSystemFlags:f,nativeEvent:y,targetContainers:[p]},o!==null&&(o=wc(o),o!==null&&aa(o)),s):(s.eventSystemFlags|=f,o=s.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),s)}function Eh(s,o,c,f,p){switch(o){case"focusin":return Sr=sr(Sr,s,o,c,f,p),!0;case"dragenter":return Ar=sr(Ar,s,o,c,f,p),!0;case"mouseover":return Ht=sr(Ht,s,o,c,f,p),!0;case"pointerover":var y=p.pointerId;return Ji.set(y,sr(Ji.get(y)||null,s,o,c,f,p)),!0;case"gotpointercapture":return y=p.pointerId,is.set(y,sr(is.get(y)||null,s,o,c,f,p)),!0}return!1}function ca(s){var o=eo(s.target);if(o!==null){var c=rr(o);if(c!==null){if(o=c.tag,o===13){if(o=Ql(c),o!==null){s.blockedOn=o,oc(s.priority,function(){sc(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ye(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var c=ua(s.domEventName,s.eventSystemFlags,o[0],s.nativeEvent);if(c===null){c=s.nativeEvent;var f=new c.constructor(c.type,c);Ls=f,c.target.dispatchEvent(f),Ls=null}else return o=wc(c),o!==null&&aa(o),s.blockedOn=c,!1;o.shift()}return!0}function Th(s,o,c){Ye(s)&&c.delete(o)}function am(){xr=!1,Sr!==null&&Ye(Sr)&&(Sr=null),Ar!==null&&Ye(Ar)&&(Ar=null),Ht!==null&&Ye(Ht)&&(Ht=null),Ji.forEach(Th),is.forEach(Th)}function Ws(s,o){s.blockedOn===o&&(s.blockedOn=null,xr||(xr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,am)))}function qs(s){function o(p){return Ws(p,s)}if(0<la.length){Ws(la[0],s);for(var c=1;c<la.length;c++){var f=la[c];f.blockedOn===s&&(f.blockedOn=null)}}for(Sr!==null&&Ws(Sr,s),Ar!==null&&Ws(Ar,s),Ht!==null&&Ws(Ht,s),Ji.forEach(o),is.forEach(o),c=0;c<Rn.length;c++)f=Rn[c],f.blockedOn===s&&(f.blockedOn=null);for(;0<Rn.length&&(c=Rn[0],c.blockedOn===null);)ca(c),c.blockedOn===null&&Rn.shift()}var os=Y.ReactCurrentBatchConfig,as=!0;function Cr(s,o,c,f){var p=Me,y=os.transition;os.transition=null;try{Me=1,ac(s,o,c,f)}finally{Me=p,os.transition=y}}function xh(s,o,c,f){var p=Me,y=os.transition;os.transition=null;try{Me=4,ac(s,o,c,f)}finally{Me=p,os.transition=y}}function ac(s,o,c,f){if(as){var p=ua(s,o,c,f);if(p===null)_m(s,o,f,kr,c),zs(s,f);else if(Eh(p,s,o,c,f))f.stopPropagation();else if(zs(s,f),o&4&&-1<Ih.indexOf(s)){for(;p!==null;){var y=wc(p);if(y!==null&&rc(y),y=ua(s,o,c,f),y===null&&_m(s,o,f,kr,c),y===p)break;p=y}p!==null&&f.stopPropagation()}else _m(s,o,f,null,c)}}var kr=null;function ua(s,o,c,f){if(kr=null,s=na(f),s=eo(s),s!==null)if(o=rr(s),o===null)s=null;else if(c=o.tag,c===13){if(s=Ql(o),s!==null)return s;s=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null);return kr=s,null}function ha(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(im()){case ia:return 1;case Yl:return 4;case qi:case Xl:return 16;case oa:return 536870912;default:return 16}default:return 16}}var bn=null,da=null,ls=null;function Sh(){if(ls)return ls;var s,o=da,c=o.length,f,p="value"in bn?bn.value:bn.textContent,y=p.length;for(s=0;s<c&&o[s]===p[s];s++);var T=c-s;for(f=1;f<=T&&o[c-f]===p[y-f];f++);return ls=p.slice(s,1<f?1-f:void 0)}function Yi(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Nr(){return!0}function lc(){return!1}function en(s){function o(c,f,p,y,T){this._reactName=c,this._targetInst=p,this.type=f,this.nativeEvent=y,this.target=T,this.currentTarget=null;for(var C in s)s.hasOwnProperty(C)&&(c=s[C],this[C]=c?c(y):y[C]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Nr:lc,this.isPropagationStopped=lc,this}return me(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Nr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Nr)},persist:function(){},isPersistent:Nr}),o}var Pr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xi=en(Pr),$s=me({},Pr,{view:0,detail:0}),fa=en($s),ma,pa,Dn,Zi=me({},$s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ne,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Dn&&(Dn&&s.type==="mousemove"?(ma=s.screenX-Dn.screenX,pa=s.screenY-Dn.screenY):pa=ma=0,Dn=s),ma)},movementY:function(s){return"movementY"in s?s.movementY:pa}}),cc=en(Zi),Ah=me({},Zi,{dataTransfer:0}),Ch=en(Ah),ga=me({},$s,{relatedTarget:0}),Gt=en(ga),kh=me({},Pr,{animationName:0,elapsedTime:0,pseudoElement:0}),Nh=en(kh),Hs=me({},Pr,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),h=en(Hs),_=me({},Pr,{data:0}),w=en(_),x={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},K={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ae(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=K[s])?!!o[s]:!1}function Ne(){return ae}var Et=me({},$s,{key:function(s){if(s.key){var o=x[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Yi(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?z[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ne,charCode:function(s){return s.type==="keypress"?Yi(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Yi(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ge=en(Et),Nt=me({},Zi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jn=en(Nt),cs=me({},$s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ne}),Rr=en(cs),br=me({},Pr,{propertyName:0,elapsedTime:0,pseudoElement:0}),ya=en(br),uc=me({},Zi,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),gS=en(uc),yS=[9,13,27,32],lm=d&&"CompositionEvent"in window,hc=null;d&&"documentMode"in document&&(hc=document.documentMode);var _S=d&&"TextEvent"in window&&!hc,A_=d&&(!lm||hc&&8<hc&&11>=hc),C_=" ",k_=!1;function N_(s,o){switch(s){case"keyup":return yS.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function P_(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var _a=!1;function vS(s,o){switch(s){case"compositionend":return P_(o);case"keypress":return o.which!==32?null:(k_=!0,C_);case"textInput":return s=o.data,s===C_&&k_?null:s;default:return null}}function wS(s,o){if(_a)return s==="compositionend"||!lm&&N_(s,o)?(s=Sh(),ls=da=bn=null,_a=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return A_&&o.locale!=="ko"?null:o.data;default:return null}}var IS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function R_(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!IS[s.type]:o==="textarea"}function b_(s,o,c,f){Os(f),o=jh(o,"onChange"),0<o.length&&(c=new Xi("onChange","change",null,c,f),s.push({event:c,listeners:o}))}var dc=null,fc=null;function ES(s){J_(s,0)}function Ph(s){var o=Ta(s);if(Bl(o))return s}function TS(s,o){if(s==="change")return o}var D_=!1;if(d){var cm;if(d){var um="oninput"in document;if(!um){var j_=document.createElement("div");j_.setAttribute("oninput","return;"),um=typeof j_.oninput=="function"}cm=um}else cm=!1;D_=cm&&(!document.documentMode||9<document.documentMode)}function V_(){dc&&(dc.detachEvent("onpropertychange",L_),fc=dc=null)}function L_(s){if(s.propertyName==="value"&&Ph(fc)){var o=[];b_(o,fc,s,na(s)),fh(ES,o)}}function xS(s,o,c){s==="focusin"?(V_(),dc=o,fc=c,dc.attachEvent("onpropertychange",L_)):s==="focusout"&&V_()}function SS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ph(fc)}function AS(s,o){if(s==="click")return Ph(o)}function CS(s,o){if(s==="input"||s==="change")return Ph(o)}function kS(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var ir=typeof Object.is=="function"?Object.is:kS;function mc(s,o){if(ir(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var c=Object.keys(s),f=Object.keys(o);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var p=c[f];if(!m.call(o,p)||!ir(s[p],o[p]))return!1}return!0}function O_(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function M_(s,o){var c=O_(s);s=0;for(var f;c;){if(c.nodeType===3){if(f=s+c.textContent.length,s<=o&&f>=o)return{node:c,offset:o-s};s=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=O_(c)}}function F_(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?F_(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function U_(){for(var s=window,o=Rs();o instanceof s.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)s=o.contentWindow;else break;o=Rs(s.document)}return o}function hm(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}function NS(s){var o=U_(),c=s.focusedElem,f=s.selectionRange;if(o!==c&&c&&c.ownerDocument&&F_(c.ownerDocument.documentElement,c)){if(f!==null&&hm(c)){if(o=f.start,s=f.end,s===void 0&&(s=o),"selectionStart"in c)c.selectionStart=o,c.selectionEnd=Math.min(s,c.value.length);else if(s=(o=c.ownerDocument||document)&&o.defaultView||window,s.getSelection){s=s.getSelection();var p=c.textContent.length,y=Math.min(f.start,p);f=f.end===void 0?y:Math.min(f.end,p),!s.extend&&y>f&&(p=f,f=y,y=p),p=M_(c,y);var T=M_(c,f);p&&T&&(s.rangeCount!==1||s.anchorNode!==p.node||s.anchorOffset!==p.offset||s.focusNode!==T.node||s.focusOffset!==T.offset)&&(o=o.createRange(),o.setStart(p.node,p.offset),s.removeAllRanges(),y>f?(s.addRange(o),s.extend(T.node,T.offset)):(o.setEnd(T.node,T.offset),s.addRange(o)))}}for(o=[],s=c;s=s.parentNode;)s.nodeType===1&&o.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<o.length;c++)s=o[c],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var PS=d&&"documentMode"in document&&11>=document.documentMode,va=null,dm=null,pc=null,fm=!1;function B_(s,o,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;fm||va==null||va!==Rs(f)||(f=va,"selectionStart"in f&&hm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),pc&&mc(pc,f)||(pc=f,f=jh(dm,"onSelect"),0<f.length&&(o=new Xi("onSelect","select",null,o,c),s.push({event:o,listeners:f}),o.target=va)))}function Rh(s,o){var c={};return c[s.toLowerCase()]=o.toLowerCase(),c["Webkit"+s]="webkit"+o,c["Moz"+s]="moz"+o,c}var wa={animationend:Rh("Animation","AnimationEnd"),animationiteration:Rh("Animation","AnimationIteration"),animationstart:Rh("Animation","AnimationStart"),transitionend:Rh("Transition","TransitionEnd")},mm={},z_={};d&&(z_=document.createElement("div").style,"AnimationEvent"in window||(delete wa.animationend.animation,delete wa.animationiteration.animation,delete wa.animationstart.animation),"TransitionEvent"in window||delete wa.transitionend.transition);function bh(s){if(mm[s])return mm[s];if(!wa[s])return s;var o=wa[s],c;for(c in o)if(o.hasOwnProperty(c)&&c in z_)return mm[s]=o[c];return s}var W_=bh("animationend"),q_=bh("animationiteration"),$_=bh("animationstart"),H_=bh("transitionend"),G_=new Map,K_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gs(s,o){G_.set(s,o),a(o,[s])}for(var pm=0;pm<K_.length;pm++){var gm=K_[pm],RS=gm.toLowerCase(),bS=gm[0].toUpperCase()+gm.slice(1);Gs(RS,"on"+bS)}Gs(W_,"onAnimationEnd"),Gs(q_,"onAnimationIteration"),Gs($_,"onAnimationStart"),Gs("dblclick","onDoubleClick"),Gs("focusin","onFocus"),Gs("focusout","onBlur"),Gs(H_,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DS=new Set("cancel close invalid load scroll toggle".split(" ").concat(gc));function Q_(s,o,c){var f=s.type||"unknown-event";s.currentTarget=c,Kl(f,o,void 0,s),s.currentTarget=null}function J_(s,o){o=(o&4)!==0;for(var c=0;c<s.length;c++){var f=s[c],p=f.event;f=f.listeners;e:{var y=void 0;if(o)for(var T=f.length-1;0<=T;T--){var C=f[T],D=C.instance,H=C.currentTarget;if(C=C.listener,D!==y&&p.isPropagationStopped())break e;Q_(p,C,H),y=D}else for(T=0;T<f.length;T++){if(C=f[T],D=C.instance,H=C.currentTarget,C=C.listener,D!==y&&p.isPropagationStopped())break e;Q_(p,C,H),y=D}}}if(ra)throw s=qn,ra=!1,qn=null,s}function rt(s,o){var c=o[xm];c===void 0&&(c=o[xm]=new Set);var f=s+"__bubble";c.has(f)||(Y_(o,s,2,!1),c.add(f))}function ym(s,o,c){var f=0;o&&(f|=4),Y_(c,s,f,o)}var Dh="_reactListening"+Math.random().toString(36).slice(2);function yc(s){if(!s[Dh]){s[Dh]=!0,r.forEach(function(c){c!=="selectionchange"&&(DS.has(c)||ym(c,!1,s),ym(c,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Dh]||(o[Dh]=!0,ym("selectionchange",!1,o))}}function Y_(s,o,c,f){switch(ha(o)){case 1:var p=Cr;break;case 4:p=xh;break;default:p=ac}c=p.bind(null,o,c,s),p=void 0,!Fs||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),f?p!==void 0?s.addEventListener(o,c,{capture:!0,passive:p}):s.addEventListener(o,c,!0):p!==void 0?s.addEventListener(o,c,{passive:p}):s.addEventListener(o,c,!1)}function _m(s,o,c,f,p){var y=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var C=f.stateNode.containerInfo;if(C===p||C.nodeType===8&&C.parentNode===p)break;if(T===4)for(T=f.return;T!==null;){var D=T.tag;if((D===3||D===4)&&(D=T.stateNode.containerInfo,D===p||D.nodeType===8&&D.parentNode===p))return;T=T.return}for(;C!==null;){if(T=eo(C),T===null)return;if(D=T.tag,D===5||D===6){f=y=T;continue e}C=C.parentNode}}f=f.return}fh(function(){var H=y,ne=na(c),se=[];e:{var ee=G_.get(s);if(ee!==void 0){var fe=Xi,ge=s;switch(s){case"keypress":if(Yi(c)===0)break e;case"keydown":case"keyup":fe=Ge;break;case"focusin":ge="focus",fe=Gt;break;case"focusout":ge="blur",fe=Gt;break;case"beforeblur":case"afterblur":fe=Gt;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=cc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Ch;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=Rr;break;case W_:case q_:case $_:fe=Nh;break;case H_:fe=ya;break;case"scroll":fe=fa;break;case"wheel":fe=gS;break;case"copy":case"cut":case"paste":fe=h;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=jn}var _e=(o&4)!==0,Tt=!_e&&s==="scroll",B=_e?ee!==null?ee+"Capture":null:ee;_e=[];for(var V=H,q;V!==null;){q=V;var ie=q.stateNode;if(q.tag===5&&ie!==null&&(q=ie,B!==null&&(ie=Bi(V,B),ie!=null&&_e.push(_c(V,ie,q)))),Tt)break;V=V.return}0<_e.length&&(ee=new fe(ee,ge,null,c,ne),se.push({event:ee,listeners:_e}))}}if((o&7)===0){e:{if(ee=s==="mouseover"||s==="pointerover",fe=s==="mouseout"||s==="pointerout",ee&&c!==Ls&&(ge=c.relatedTarget||c.fromElement)&&(eo(ge)||ge[us]))break e;if((fe||ee)&&(ee=ne.window===ne?ne:(ee=ne.ownerDocument)?ee.defaultView||ee.parentWindow:window,fe?(ge=c.relatedTarget||c.toElement,fe=H,ge=ge?eo(ge):null,ge!==null&&(Tt=rr(ge),ge!==Tt||ge.tag!==5&&ge.tag!==6)&&(ge=null)):(fe=null,ge=H),fe!==ge)){if(_e=cc,ie="onMouseLeave",B="onMouseEnter",V="mouse",(s==="pointerout"||s==="pointerover")&&(_e=jn,ie="onPointerLeave",B="onPointerEnter",V="pointer"),Tt=fe==null?ee:Ta(fe),q=ge==null?ee:Ta(ge),ee=new _e(ie,V+"leave",fe,c,ne),ee.target=Tt,ee.relatedTarget=q,ie=null,eo(ne)===H&&(_e=new _e(B,V+"enter",ge,c,ne),_e.target=q,_e.relatedTarget=Tt,ie=_e),Tt=ie,fe&&ge)t:{for(_e=fe,B=ge,V=0,q=_e;q;q=Ia(q))V++;for(q=0,ie=B;ie;ie=Ia(ie))q++;for(;0<V-q;)_e=Ia(_e),V--;for(;0<q-V;)B=Ia(B),q--;for(;V--;){if(_e===B||B!==null&&_e===B.alternate)break t;_e=Ia(_e),B=Ia(B)}_e=null}else _e=null;fe!==null&&X_(se,ee,fe,_e,!1),ge!==null&&Tt!==null&&X_(se,Tt,ge,_e,!0)}}e:{if(ee=H?Ta(H):window,fe=ee.nodeName&&ee.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ee.type==="file")var ve=TS;else if(R_(ee))if(D_)ve=CS;else{ve=SS;var Ee=xS}else(fe=ee.nodeName)&&fe.toLowerCase()==="input"&&(ee.type==="checkbox"||ee.type==="radio")&&(ve=AS);if(ve&&(ve=ve(s,H))){b_(se,ve,c,ne);break e}Ee&&Ee(s,ee,H),s==="focusout"&&(Ee=ee._wrapperState)&&Ee.controlled&&ee.type==="number"&&kt(ee,"number",ee.value)}switch(Ee=H?Ta(H):window,s){case"focusin":(R_(Ee)||Ee.contentEditable==="true")&&(va=Ee,dm=H,pc=null);break;case"focusout":pc=dm=va=null;break;case"mousedown":fm=!0;break;case"contextmenu":case"mouseup":case"dragend":fm=!1,B_(se,c,ne);break;case"selectionchange":if(PS)break;case"keydown":case"keyup":B_(se,c,ne)}var Te;if(lm)e:{switch(s){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else _a?N_(s,c)&&(Ae="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Ae="onCompositionStart");Ae&&(A_&&c.locale!=="ko"&&(_a||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&_a&&(Te=Sh()):(bn=ne,da="value"in bn?bn.value:bn.textContent,_a=!0)),Ee=jh(H,Ae),0<Ee.length&&(Ae=new w(Ae,s,null,c,ne),se.push({event:Ae,listeners:Ee}),Te?Ae.data=Te:(Te=P_(c),Te!==null&&(Ae.data=Te)))),(Te=_S?vS(s,c):wS(s,c))&&(H=jh(H,"onBeforeInput"),0<H.length&&(ne=new w("onBeforeInput","beforeinput",null,c,ne),se.push({event:ne,listeners:H}),ne.data=Te))}J_(se,o)})}function _c(s,o,c){return{instance:s,listener:o,currentTarget:c}}function jh(s,o){for(var c=o+"Capture",f=[];s!==null;){var p=s,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=Bi(s,c),y!=null&&f.unshift(_c(s,y,p)),y=Bi(s,o),y!=null&&f.push(_c(s,y,p))),s=s.return}return f}function Ia(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function X_(s,o,c,f,p){for(var y=o._reactName,T=[];c!==null&&c!==f;){var C=c,D=C.alternate,H=C.stateNode;if(D!==null&&D===f)break;C.tag===5&&H!==null&&(C=H,p?(D=Bi(c,y),D!=null&&T.unshift(_c(c,D,C))):p||(D=Bi(c,y),D!=null&&T.push(_c(c,D,C)))),c=c.return}T.length!==0&&s.push({event:o,listeners:T})}var jS=/\r\n?/g,VS=/\u0000|\uFFFD/g;function Z_(s){return(typeof s=="string"?s:""+s).replace(jS,`
`).replace(VS,"")}function Vh(s,o,c){if(o=Z_(o),Z_(s)!==o&&c)throw Error(t(425))}function Lh(){}var vm=null,wm=null;function Im(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Em=typeof setTimeout=="function"?setTimeout:void 0,LS=typeof clearTimeout=="function"?clearTimeout:void 0,ev=typeof Promise=="function"?Promise:void 0,OS=typeof queueMicrotask=="function"?queueMicrotask:typeof ev<"u"?function(s){return ev.resolve(null).then(s).catch(MS)}:Em;function MS(s){setTimeout(function(){throw s})}function Tm(s,o){var c=o,f=0;do{var p=c.nextSibling;if(s.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"){if(f===0){s.removeChild(p),qs(o);return}f--}else c!=="$"&&c!=="$?"&&c!=="$!"||f++;c=p}while(c);qs(o)}function Ks(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return s}function tv(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return s;o--}else c==="/$"&&o++}s=s.previousSibling}return null}var Ea=Math.random().toString(36).slice(2),Dr="__reactFiber$"+Ea,vc="__reactProps$"+Ea,us="__reactContainer$"+Ea,xm="__reactEvents$"+Ea,FS="__reactListeners$"+Ea,US="__reactHandles$"+Ea;function eo(s){var o=s[Dr];if(o)return o;for(var c=s.parentNode;c;){if(o=c[us]||c[Dr]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(s=tv(s);s!==null;){if(c=s[Dr])return c;s=tv(s)}return o}s=c,c=s.parentNode}return null}function wc(s){return s=s[Dr]||s[us],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Ta(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Oh(s){return s[vc]||null}var Sm=[],xa=-1;function Qs(s){return{current:s}}function st(s){0>xa||(s.current=Sm[xa],Sm[xa]=null,xa--)}function Ze(s,o){xa++,Sm[xa]=s.current,s.current=o}var Js={},tn=Qs(Js),vn=Qs(!1),to=Js;function Sa(s,o){var c=s.type.contextTypes;if(!c)return Js;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===o)return f.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in c)p[y]=o[y];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=p),p}function wn(s){return s=s.childContextTypes,s!=null}function Mh(){st(vn),st(tn)}function nv(s,o,c){if(tn.current!==Js)throw Error(t(168));Ze(tn,o),Ze(vn,c)}function rv(s,o,c){var f=s.stateNode;if(o=o.childContextTypes,typeof f.getChildContext!="function")return c;f=f.getChildContext();for(var p in f)if(!(p in o))throw Error(t(108,$e(s)||"Unknown",p));return me({},c,f)}function Fh(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Js,to=tn.current,Ze(tn,s),Ze(vn,vn.current),!0}function sv(s,o,c){var f=s.stateNode;if(!f)throw Error(t(169));c?(s=rv(s,o,to),f.__reactInternalMemoizedMergedChildContext=s,st(vn),st(tn),Ze(tn,s)):st(vn),Ze(vn,c)}var hs=null,Uh=!1,Am=!1;function iv(s){hs===null?hs=[s]:hs.push(s)}function BS(s){Uh=!0,iv(s)}function Ys(){if(!Am&&hs!==null){Am=!0;var s=0,o=Me;try{var c=hs;for(Me=1;s<c.length;s++){var f=c[s];do f=f(!0);while(f!==null)}hs=null,Uh=!1}catch(p){throw hs!==null&&(hs=hs.slice(s+1)),Jl(ia,Ys),p}finally{Me=o,Am=!1}}return null}var Aa=[],Ca=0,Bh=null,zh=0,Hn=[],Gn=0,no=null,ds=1,fs="";function ro(s,o){Aa[Ca++]=zh,Aa[Ca++]=Bh,Bh=s,zh=o}function ov(s,o,c){Hn[Gn++]=ds,Hn[Gn++]=fs,Hn[Gn++]=no,no=s;var f=ds;s=fs;var p=32-Pn(f)-1;f&=~(1<<p),c+=1;var y=32-Pn(o)+p;if(30<y){var T=p-p%5;y=(f&(1<<T)-1).toString(32),f>>=T,p-=T,ds=1<<32-Pn(o)+p|c<<p|f,fs=y+s}else ds=1<<y|c<<p|f,fs=s}function Cm(s){s.return!==null&&(ro(s,1),ov(s,1,0))}function km(s){for(;s===Bh;)Bh=Aa[--Ca],Aa[Ca]=null,zh=Aa[--Ca],Aa[Ca]=null;for(;s===no;)no=Hn[--Gn],Hn[Gn]=null,fs=Hn[--Gn],Hn[Gn]=null,ds=Hn[--Gn],Hn[Gn]=null}var Vn=null,Ln=null,ot=!1,or=null;function av(s,o){var c=Yn(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=s,o=s.deletions,o===null?(s.deletions=[c],s.flags|=16):o.push(c)}function lv(s,o){switch(s.tag){case 5:var c=s.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(s.stateNode=o,Vn=s,Ln=Ks(o.firstChild),!0):!1;case 6:return o=s.pendingProps===""||o.nodeType!==3?null:o,o!==null?(s.stateNode=o,Vn=s,Ln=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(c=no!==null?{id:ds,overflow:fs}:null,s.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},c=Yn(18,null,null,0),c.stateNode=o,c.return=s,s.child=c,Vn=s,Ln=null,!0):!1;default:return!1}}function Nm(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Pm(s){if(ot){var o=Ln;if(o){var c=o;if(!lv(s,o)){if(Nm(s))throw Error(t(418));o=Ks(c.nextSibling);var f=Vn;o&&lv(s,o)?av(f,c):(s.flags=s.flags&-4097|2,ot=!1,Vn=s)}}else{if(Nm(s))throw Error(t(418));s.flags=s.flags&-4097|2,ot=!1,Vn=s}}}function cv(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Vn=s}function Wh(s){if(s!==Vn)return!1;if(!ot)return cv(s),ot=!0,!1;var o;if((o=s.tag!==3)&&!(o=s.tag!==5)&&(o=s.type,o=o!=="head"&&o!=="body"&&!Im(s.type,s.memoizedProps)),o&&(o=Ln)){if(Nm(s))throw uv(),Error(t(418));for(;o;)av(s,o),o=Ks(o.nextSibling)}if(cv(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"){if(o===0){Ln=Ks(s.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}s=s.nextSibling}Ln=null}}else Ln=Vn?Ks(s.stateNode.nextSibling):null;return!0}function uv(){for(var s=Ln;s;)s=Ks(s.nextSibling)}function ka(){Ln=Vn=null,ot=!1}function Rm(s){or===null?or=[s]:or.push(s)}var zS=Y.ReactCurrentBatchConfig;function Ic(s,o,c){if(s=c.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var f=c.stateNode}if(!f)throw Error(t(147,s));var p=f,y=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===y?o.ref:(o=function(T){var C=p.refs;T===null?delete C[y]:C[y]=T},o._stringRef=y,o)}if(typeof s!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,s))}return s}function qh(s,o){throw s=Object.prototype.toString.call(o),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function hv(s){var o=s._init;return o(s._payload)}function dv(s){function o(B,V){if(s){var q=B.deletions;q===null?(B.deletions=[V],B.flags|=16):q.push(V)}}function c(B,V){if(!s)return null;for(;V!==null;)o(B,V),V=V.sibling;return null}function f(B,V){for(B=new Map;V!==null;)V.key!==null?B.set(V.key,V):B.set(V.index,V),V=V.sibling;return B}function p(B,V){return B=ii(B,V),B.index=0,B.sibling=null,B}function y(B,V,q){return B.index=q,s?(q=B.alternate,q!==null?(q=q.index,q<V?(B.flags|=2,V):q):(B.flags|=2,V)):(B.flags|=1048576,V)}function T(B){return s&&B.alternate===null&&(B.flags|=2),B}function C(B,V,q,ie){return V===null||V.tag!==6?(V=Ep(q,B.mode,ie),V.return=B,V):(V=p(V,q),V.return=B,V)}function D(B,V,q,ie){var ve=q.type;return ve===P?ne(B,V,q.props.children,ie,q.key):V!==null&&(V.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===Ft&&hv(ve)===V.type)?(ie=p(V,q.props),ie.ref=Ic(B,V,q),ie.return=B,ie):(ie=md(q.type,q.key,q.props,null,B.mode,ie),ie.ref=Ic(B,V,q),ie.return=B,ie)}function H(B,V,q,ie){return V===null||V.tag!==4||V.stateNode.containerInfo!==q.containerInfo||V.stateNode.implementation!==q.implementation?(V=Tp(q,B.mode,ie),V.return=B,V):(V=p(V,q.children||[]),V.return=B,V)}function ne(B,V,q,ie,ve){return V===null||V.tag!==7?(V=ho(q,B.mode,ie,ve),V.return=B,V):(V=p(V,q),V.return=B,V)}function se(B,V,q){if(typeof V=="string"&&V!==""||typeof V=="number")return V=Ep(""+V,B.mode,q),V.return=B,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case he:return q=md(V.type,V.key,V.props,null,B.mode,q),q.ref=Ic(B,null,V),q.return=B,q;case Q:return V=Tp(V,B.mode,q),V.return=B,V;case Ft:var ie=V._init;return se(B,ie(V._payload),q)}if(It(V)||we(V))return V=ho(V,B.mode,q,null),V.return=B,V;qh(B,V)}return null}function ee(B,V,q,ie){var ve=V!==null?V.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return ve!==null?null:C(B,V,""+q,ie);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case he:return q.key===ve?D(B,V,q,ie):null;case Q:return q.key===ve?H(B,V,q,ie):null;case Ft:return ve=q._init,ee(B,V,ve(q._payload),ie)}if(It(q)||we(q))return ve!==null?null:ne(B,V,q,ie,null);qh(B,q)}return null}function fe(B,V,q,ie,ve){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return B=B.get(q)||null,C(V,B,""+ie,ve);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case he:return B=B.get(ie.key===null?q:ie.key)||null,D(V,B,ie,ve);case Q:return B=B.get(ie.key===null?q:ie.key)||null,H(V,B,ie,ve);case Ft:var Ee=ie._init;return fe(B,V,q,Ee(ie._payload),ve)}if(It(ie)||we(ie))return B=B.get(q)||null,ne(V,B,ie,ve,null);qh(V,ie)}return null}function ge(B,V,q,ie){for(var ve=null,Ee=null,Te=V,Ae=V=0,zt=null;Te!==null&&Ae<q.length;Ae++){Te.index>Ae?(zt=Te,Te=null):zt=Te.sibling;var ze=ee(B,Te,q[Ae],ie);if(ze===null){Te===null&&(Te=zt);break}s&&Te&&ze.alternate===null&&o(B,Te),V=y(ze,V,Ae),Ee===null?ve=ze:Ee.sibling=ze,Ee=ze,Te=zt}if(Ae===q.length)return c(B,Te),ot&&ro(B,Ae),ve;if(Te===null){for(;Ae<q.length;Ae++)Te=se(B,q[Ae],ie),Te!==null&&(V=y(Te,V,Ae),Ee===null?ve=Te:Ee.sibling=Te,Ee=Te);return ot&&ro(B,Ae),ve}for(Te=f(B,Te);Ae<q.length;Ae++)zt=fe(Te,B,Ae,q[Ae],ie),zt!==null&&(s&&zt.alternate!==null&&Te.delete(zt.key===null?Ae:zt.key),V=y(zt,V,Ae),Ee===null?ve=zt:Ee.sibling=zt,Ee=zt);return s&&Te.forEach(function(oi){return o(B,oi)}),ot&&ro(B,Ae),ve}function _e(B,V,q,ie){var ve=we(q);if(typeof ve!="function")throw Error(t(150));if(q=ve.call(q),q==null)throw Error(t(151));for(var Ee=ve=null,Te=V,Ae=V=0,zt=null,ze=q.next();Te!==null&&!ze.done;Ae++,ze=q.next()){Te.index>Ae?(zt=Te,Te=null):zt=Te.sibling;var oi=ee(B,Te,ze.value,ie);if(oi===null){Te===null&&(Te=zt);break}s&&Te&&oi.alternate===null&&o(B,Te),V=y(oi,V,Ae),Ee===null?ve=oi:Ee.sibling=oi,Ee=oi,Te=zt}if(ze.done)return c(B,Te),ot&&ro(B,Ae),ve;if(Te===null){for(;!ze.done;Ae++,ze=q.next())ze=se(B,ze.value,ie),ze!==null&&(V=y(ze,V,Ae),Ee===null?ve=ze:Ee.sibling=ze,Ee=ze);return ot&&ro(B,Ae),ve}for(Te=f(B,Te);!ze.done;Ae++,ze=q.next())ze=fe(Te,B,Ae,ze.value,ie),ze!==null&&(s&&ze.alternate!==null&&Te.delete(ze.key===null?Ae:ze.key),V=y(ze,V,Ae),Ee===null?ve=ze:Ee.sibling=ze,Ee=ze);return s&&Te.forEach(function(IA){return o(B,IA)}),ot&&ro(B,Ae),ve}function Tt(B,V,q,ie){if(typeof q=="object"&&q!==null&&q.type===P&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case he:e:{for(var ve=q.key,Ee=V;Ee!==null;){if(Ee.key===ve){if(ve=q.type,ve===P){if(Ee.tag===7){c(B,Ee.sibling),V=p(Ee,q.props.children),V.return=B,B=V;break e}}else if(Ee.elementType===ve||typeof ve=="object"&&ve!==null&&ve.$$typeof===Ft&&hv(ve)===Ee.type){c(B,Ee.sibling),V=p(Ee,q.props),V.ref=Ic(B,Ee,q),V.return=B,B=V;break e}c(B,Ee);break}else o(B,Ee);Ee=Ee.sibling}q.type===P?(V=ho(q.props.children,B.mode,ie,q.key),V.return=B,B=V):(ie=md(q.type,q.key,q.props,null,B.mode,ie),ie.ref=Ic(B,V,q),ie.return=B,B=ie)}return T(B);case Q:e:{for(Ee=q.key;V!==null;){if(V.key===Ee)if(V.tag===4&&V.stateNode.containerInfo===q.containerInfo&&V.stateNode.implementation===q.implementation){c(B,V.sibling),V=p(V,q.children||[]),V.return=B,B=V;break e}else{c(B,V);break}else o(B,V);V=V.sibling}V=Tp(q,B.mode,ie),V.return=B,B=V}return T(B);case Ft:return Ee=q._init,Tt(B,V,Ee(q._payload),ie)}if(It(q))return ge(B,V,q,ie);if(we(q))return _e(B,V,q,ie);qh(B,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,V!==null&&V.tag===6?(c(B,V.sibling),V=p(V,q),V.return=B,B=V):(c(B,V),V=Ep(q,B.mode,ie),V.return=B,B=V),T(B)):c(B,V)}return Tt}var Na=dv(!0),fv=dv(!1),$h=Qs(null),Hh=null,Pa=null,bm=null;function Dm(){bm=Pa=Hh=null}function jm(s){var o=$h.current;st($h),s._currentValue=o}function Vm(s,o,c){for(;s!==null;){var f=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),s===c)break;s=s.return}}function Ra(s,o){Hh=s,bm=Pa=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&o)!==0&&(In=!0),s.firstContext=null)}function Kn(s){var o=s._currentValue;if(bm!==s)if(s={context:s,memoizedValue:o,next:null},Pa===null){if(Hh===null)throw Error(t(308));Pa=s,Hh.dependencies={lanes:0,firstContext:s}}else Pa=Pa.next=s;return o}var so=null;function Lm(s){so===null?so=[s]:so.push(s)}function mv(s,o,c,f){var p=o.interleaved;return p===null?(c.next=c,Lm(o)):(c.next=p.next,p.next=c),o.interleaved=c,ms(s,f)}function ms(s,o){s.lanes|=o;var c=s.alternate;for(c!==null&&(c.lanes|=o),c=s,s=s.return;s!==null;)s.childLanes|=o,c=s.alternate,c!==null&&(c.childLanes|=o),c=s,s=s.return;return c.tag===3?c.stateNode:null}var Xs=!1;function Om(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pv(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function ps(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function Zs(s,o,c){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(Be&2)!==0){var p=f.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),f.pending=o,ms(s,c)}return p=f.interleaved,p===null?(o.next=o,Lm(f)):(o.next=p.next,p.next=o),f.interleaved=o,ms(s,c)}function Gh(s,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194240)!==0)){var f=o.lanes;f&=s.pendingLanes,c|=f,o.lanes=c,nc(s,c)}}function gv(s,o){var c=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var p=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var T={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};y===null?p=y=T:y=y.next=T,c=c.next}while(c!==null);y===null?p=y=o:y=y.next=o}else p=y=o;c={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:f.shared,effects:f.effects},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=o:s.next=o,c.lastBaseUpdate=o}function Kh(s,o,c,f){var p=s.updateQueue;Xs=!1;var y=p.firstBaseUpdate,T=p.lastBaseUpdate,C=p.shared.pending;if(C!==null){p.shared.pending=null;var D=C,H=D.next;D.next=null,T===null?y=H:T.next=H,T=D;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,C=ne.lastBaseUpdate,C!==T&&(C===null?ne.firstBaseUpdate=H:C.next=H,ne.lastBaseUpdate=D))}if(y!==null){var se=p.baseState;T=0,ne=H=D=null,C=y;do{var ee=C.lane,fe=C.eventTime;if((f&ee)===ee){ne!==null&&(ne=ne.next={eventTime:fe,lane:0,tag:C.tag,payload:C.payload,callback:C.callback,next:null});e:{var ge=s,_e=C;switch(ee=o,fe=c,_e.tag){case 1:if(ge=_e.payload,typeof ge=="function"){se=ge.call(fe,se,ee);break e}se=ge;break e;case 3:ge.flags=ge.flags&-65537|128;case 0:if(ge=_e.payload,ee=typeof ge=="function"?ge.call(fe,se,ee):ge,ee==null)break e;se=me({},se,ee);break e;case 2:Xs=!0}}C.callback!==null&&C.lane!==0&&(s.flags|=64,ee=p.effects,ee===null?p.effects=[C]:ee.push(C))}else fe={eventTime:fe,lane:ee,tag:C.tag,payload:C.payload,callback:C.callback,next:null},ne===null?(H=ne=fe,D=se):ne=ne.next=fe,T|=ee;if(C=C.next,C===null){if(C=p.shared.pending,C===null)break;ee=C,C=ee.next,ee.next=null,p.lastBaseUpdate=ee,p.shared.pending=null}}while(!0);if(ne===null&&(D=se),p.baseState=D,p.firstBaseUpdate=H,p.lastBaseUpdate=ne,o=p.shared.interleaved,o!==null){p=o;do T|=p.lane,p=p.next;while(p!==o)}else y===null&&(p.shared.lanes=0);ao|=T,s.lanes=T,s.memoizedState=se}}function yv(s,o,c){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var f=s[o],p=f.callback;if(p!==null){if(f.callback=null,f=c,typeof p!="function")throw Error(t(191,p));p.call(f)}}}var Ec={},jr=Qs(Ec),Tc=Qs(Ec),xc=Qs(Ec);function io(s){if(s===Ec)throw Error(t(174));return s}function Mm(s,o){switch(Ze(xc,o),Ze(Tc,s),Ze(jr,Ec),s=o.nodeType,s){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Zo(null,"");break;default:s=s===8?o.parentNode:o,o=s.namespaceURI||null,s=s.tagName,o=Zo(o,s)}st(jr),Ze(jr,o)}function ba(){st(jr),st(Tc),st(xc)}function _v(s){io(xc.current);var o=io(jr.current),c=Zo(o,s.type);o!==c&&(Ze(Tc,s),Ze(jr,c))}function Fm(s){Tc.current===s&&(st(jr),st(Tc))}var dt=Qs(0);function Qh(s){for(var o=s;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Um=[];function Bm(){for(var s=0;s<Um.length;s++)Um[s]._workInProgressVersionPrimary=null;Um.length=0}var Jh=Y.ReactCurrentDispatcher,zm=Y.ReactCurrentBatchConfig,oo=0,ft=null,jt=null,Ut=null,Yh=!1,Sc=!1,Ac=0,WS=0;function nn(){throw Error(t(321))}function Wm(s,o){if(o===null)return!1;for(var c=0;c<o.length&&c<s.length;c++)if(!ir(s[c],o[c]))return!1;return!0}function qm(s,o,c,f,p,y){if(oo=y,ft=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Jh.current=s===null||s.memoizedState===null?GS:KS,s=c(f,p),Sc){y=0;do{if(Sc=!1,Ac=0,25<=y)throw Error(t(301));y+=1,Ut=jt=null,o.updateQueue=null,Jh.current=QS,s=c(f,p)}while(Sc)}if(Jh.current=ed,o=jt!==null&&jt.next!==null,oo=0,Ut=jt=ft=null,Yh=!1,o)throw Error(t(300));return s}function $m(){var s=Ac!==0;return Ac=0,s}function Vr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?ft.memoizedState=Ut=s:Ut=Ut.next=s,Ut}function Qn(){if(jt===null){var s=ft.alternate;s=s!==null?s.memoizedState:null}else s=jt.next;var o=Ut===null?ft.memoizedState:Ut.next;if(o!==null)Ut=o,jt=s;else{if(s===null)throw Error(t(310));jt=s,s={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Ut===null?ft.memoizedState=Ut=s:Ut=Ut.next=s}return Ut}function Cc(s,o){return typeof o=="function"?o(s):o}function Hm(s){var o=Qn(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=s;var f=jt,p=f.baseQueue,y=c.pending;if(y!==null){if(p!==null){var T=p.next;p.next=y.next,y.next=T}f.baseQueue=p=y,c.pending=null}if(p!==null){y=p.next,f=f.baseState;var C=T=null,D=null,H=y;do{var ne=H.lane;if((oo&ne)===ne)D!==null&&(D=D.next={lane:0,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null}),f=H.hasEagerState?H.eagerState:s(f,H.action);else{var se={lane:ne,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null};D===null?(C=D=se,T=f):D=D.next=se,ft.lanes|=ne,ao|=ne}H=H.next}while(H!==null&&H!==y);D===null?T=f:D.next=C,ir(f,o.memoizedState)||(In=!0),o.memoizedState=f,o.baseState=T,o.baseQueue=D,c.lastRenderedState=f}if(s=c.interleaved,s!==null){p=s;do y=p.lane,ft.lanes|=y,ao|=y,p=p.next;while(p!==s)}else p===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function Gm(s){var o=Qn(),c=o.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=s;var f=c.dispatch,p=c.pending,y=o.memoizedState;if(p!==null){c.pending=null;var T=p=p.next;do y=s(y,T.action),T=T.next;while(T!==p);ir(y,o.memoizedState)||(In=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),c.lastRenderedState=y}return[y,f]}function vv(){}function wv(s,o){var c=ft,f=Qn(),p=o(),y=!ir(f.memoizedState,p);if(y&&(f.memoizedState=p,In=!0),f=f.queue,Km(Tv.bind(null,c,f,s),[s]),f.getSnapshot!==o||y||Ut!==null&&Ut.memoizedState.tag&1){if(c.flags|=2048,kc(9,Ev.bind(null,c,f,p,o),void 0,null),Bt===null)throw Error(t(349));(oo&30)!==0||Iv(c,o,p)}return p}function Iv(s,o,c){s.flags|=16384,s={getSnapshot:o,value:c},o=ft.updateQueue,o===null?(o={lastEffect:null,stores:null},ft.updateQueue=o,o.stores=[s]):(c=o.stores,c===null?o.stores=[s]:c.push(s))}function Ev(s,o,c,f){o.value=c,o.getSnapshot=f,xv(o)&&Sv(s)}function Tv(s,o,c){return c(function(){xv(o)&&Sv(s)})}function xv(s){var o=s.getSnapshot;s=s.value;try{var c=o();return!ir(s,c)}catch{return!0}}function Sv(s){var o=ms(s,1);o!==null&&ur(o,s,1,-1)}function Av(s){var o=Vr();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cc,lastRenderedState:s},o.queue=s,s=s.dispatch=HS.bind(null,ft,s),[o.memoizedState,s]}function kc(s,o,c,f){return s={tag:s,create:o,destroy:c,deps:f,next:null},o=ft.updateQueue,o===null?(o={lastEffect:null,stores:null},ft.updateQueue=o,o.lastEffect=s.next=s):(c=o.lastEffect,c===null?o.lastEffect=s.next=s:(f=c.next,c.next=s,s.next=f,o.lastEffect=s)),s}function Cv(){return Qn().memoizedState}function Xh(s,o,c,f){var p=Vr();ft.flags|=s,p.memoizedState=kc(1|o,c,void 0,f===void 0?null:f)}function Zh(s,o,c,f){var p=Qn();f=f===void 0?null:f;var y=void 0;if(jt!==null){var T=jt.memoizedState;if(y=T.destroy,f!==null&&Wm(f,T.deps)){p.memoizedState=kc(o,c,y,f);return}}ft.flags|=s,p.memoizedState=kc(1|o,c,y,f)}function kv(s,o){return Xh(8390656,8,s,o)}function Km(s,o){return Zh(2048,8,s,o)}function Nv(s,o){return Zh(4,2,s,o)}function Pv(s,o){return Zh(4,4,s,o)}function Rv(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function bv(s,o,c){return c=c!=null?c.concat([s]):null,Zh(4,4,Rv.bind(null,o,s),c)}function Qm(){}function Dv(s,o){var c=Qn();o=o===void 0?null:o;var f=c.memoizedState;return f!==null&&o!==null&&Wm(o,f[1])?f[0]:(c.memoizedState=[s,o],s)}function jv(s,o){var c=Qn();o=o===void 0?null:o;var f=c.memoizedState;return f!==null&&o!==null&&Wm(o,f[1])?f[0]:(s=s(),c.memoizedState=[s,o],s)}function Vv(s,o,c){return(oo&21)===0?(s.baseState&&(s.baseState=!1,In=!0),s.memoizedState=c):(ir(c,o)||(c=ec(),ft.lanes|=c,ao|=c,s.baseState=!0),o)}function qS(s,o){var c=Me;Me=c!==0&&4>c?c:4,s(!0);var f=zm.transition;zm.transition={};try{s(!1),o()}finally{Me=c,zm.transition=f}}function Lv(){return Qn().memoizedState}function $S(s,o,c){var f=ri(s);if(c={lane:f,action:c,hasEagerState:!1,eagerState:null,next:null},Ov(s))Mv(o,c);else if(c=mv(s,o,c,f),c!==null){var p=fn();ur(c,s,f,p),Fv(c,o,f)}}function HS(s,o,c){var f=ri(s),p={lane:f,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ov(s))Mv(o,p);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var T=o.lastRenderedState,C=y(T,c);if(p.hasEagerState=!0,p.eagerState=C,ir(C,T)){var D=o.interleaved;D===null?(p.next=p,Lm(o)):(p.next=D.next,D.next=p),o.interleaved=p;return}}catch{}finally{}c=mv(s,o,p,f),c!==null&&(p=fn(),ur(c,s,f,p),Fv(c,o,f))}}function Ov(s){var o=s.alternate;return s===ft||o!==null&&o===ft}function Mv(s,o){Sc=Yh=!0;var c=s.pending;c===null?o.next=o:(o.next=c.next,c.next=o),s.pending=o}function Fv(s,o,c){if((c&4194240)!==0){var f=o.lanes;f&=s.pendingLanes,c|=f,o.lanes=c,nc(s,c)}}var ed={readContext:Kn,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useInsertionEffect:nn,useLayoutEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useMutableSource:nn,useSyncExternalStore:nn,useId:nn,unstable_isNewReconciler:!1},GS={readContext:Kn,useCallback:function(s,o){return Vr().memoizedState=[s,o===void 0?null:o],s},useContext:Kn,useEffect:kv,useImperativeHandle:function(s,o,c){return c=c!=null?c.concat([s]):null,Xh(4194308,4,Rv.bind(null,o,s),c)},useLayoutEffect:function(s,o){return Xh(4194308,4,s,o)},useInsertionEffect:function(s,o){return Xh(4,2,s,o)},useMemo:function(s,o){var c=Vr();return o=o===void 0?null:o,s=s(),c.memoizedState=[s,o],s},useReducer:function(s,o,c){var f=Vr();return o=c!==void 0?c(o):o,f.memoizedState=f.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},f.queue=s,s=s.dispatch=$S.bind(null,ft,s),[f.memoizedState,s]},useRef:function(s){var o=Vr();return s={current:s},o.memoizedState=s},useState:Av,useDebugValue:Qm,useDeferredValue:function(s){return Vr().memoizedState=s},useTransition:function(){var s=Av(!1),o=s[0];return s=qS.bind(null,s[1]),Vr().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,c){var f=ft,p=Vr();if(ot){if(c===void 0)throw Error(t(407));c=c()}else{if(c=o(),Bt===null)throw Error(t(349));(oo&30)!==0||Iv(f,o,c)}p.memoizedState=c;var y={value:c,getSnapshot:o};return p.queue=y,kv(Tv.bind(null,f,y,s),[s]),f.flags|=2048,kc(9,Ev.bind(null,f,y,c,o),void 0,null),c},useId:function(){var s=Vr(),o=Bt.identifierPrefix;if(ot){var c=fs,f=ds;c=(f&~(1<<32-Pn(f)-1)).toString(32)+c,o=":"+o+"R"+c,c=Ac++,0<c&&(o+="H"+c.toString(32)),o+=":"}else c=WS++,o=":"+o+"r"+c.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},KS={readContext:Kn,useCallback:Dv,useContext:Kn,useEffect:Km,useImperativeHandle:bv,useInsertionEffect:Nv,useLayoutEffect:Pv,useMemo:jv,useReducer:Hm,useRef:Cv,useState:function(){return Hm(Cc)},useDebugValue:Qm,useDeferredValue:function(s){var o=Qn();return Vv(o,jt.memoizedState,s)},useTransition:function(){var s=Hm(Cc)[0],o=Qn().memoizedState;return[s,o]},useMutableSource:vv,useSyncExternalStore:wv,useId:Lv,unstable_isNewReconciler:!1},QS={readContext:Kn,useCallback:Dv,useContext:Kn,useEffect:Km,useImperativeHandle:bv,useInsertionEffect:Nv,useLayoutEffect:Pv,useMemo:jv,useReducer:Gm,useRef:Cv,useState:function(){return Gm(Cc)},useDebugValue:Qm,useDeferredValue:function(s){var o=Qn();return jt===null?o.memoizedState=s:Vv(o,jt.memoizedState,s)},useTransition:function(){var s=Gm(Cc)[0],o=Qn().memoizedState;return[s,o]},useMutableSource:vv,useSyncExternalStore:wv,useId:Lv,unstable_isNewReconciler:!1};function ar(s,o){if(s&&s.defaultProps){o=me({},o),s=s.defaultProps;for(var c in s)o[c]===void 0&&(o[c]=s[c]);return o}return o}function Jm(s,o,c,f){o=s.memoizedState,c=c(f,o),c=c==null?o:me({},o,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var td={isMounted:function(s){return(s=s._reactInternals)?rr(s)===s:!1},enqueueSetState:function(s,o,c){s=s._reactInternals;var f=fn(),p=ri(s),y=ps(f,p);y.payload=o,c!=null&&(y.callback=c),o=Zs(s,y,p),o!==null&&(ur(o,s,p,f),Gh(o,s,p))},enqueueReplaceState:function(s,o,c){s=s._reactInternals;var f=fn(),p=ri(s),y=ps(f,p);y.tag=1,y.payload=o,c!=null&&(y.callback=c),o=Zs(s,y,p),o!==null&&(ur(o,s,p,f),Gh(o,s,p))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var c=fn(),f=ri(s),p=ps(c,f);p.tag=2,o!=null&&(p.callback=o),o=Zs(s,p,f),o!==null&&(ur(o,s,f,c),Gh(o,s,f))}};function Uv(s,o,c,f,p,y,T){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,y,T):o.prototype&&o.prototype.isPureReactComponent?!mc(c,f)||!mc(p,y):!0}function Bv(s,o,c){var f=!1,p=Js,y=o.contextType;return typeof y=="object"&&y!==null?y=Kn(y):(p=wn(o)?to:tn.current,f=o.contextTypes,y=(f=f!=null)?Sa(s,p):Js),o=new o(c,y),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=td,s.stateNode=o,o._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=p,s.__reactInternalMemoizedMaskedChildContext=y),o}function zv(s,o,c,f){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,f),o.state!==s&&td.enqueueReplaceState(o,o.state,null)}function Ym(s,o,c,f){var p=s.stateNode;p.props=c,p.state=s.memoizedState,p.refs={},Om(s);var y=o.contextType;typeof y=="object"&&y!==null?p.context=Kn(y):(y=wn(o)?to:tn.current,p.context=Sa(s,y)),p.state=s.memoizedState,y=o.getDerivedStateFromProps,typeof y=="function"&&(Jm(s,o,y,c),p.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(o=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),o!==p.state&&td.enqueueReplaceState(p,p.state,null),Kh(s,c,p,f),p.state=s.memoizedState),typeof p.componentDidMount=="function"&&(s.flags|=4194308)}function Da(s,o){try{var c="",f=o;do c+=Ve(f),f=f.return;while(f);var p=c}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:s,source:o,stack:p,digest:null}}function Xm(s,o,c){return{value:s,source:null,stack:c??null,digest:o??null}}function Zm(s,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var JS=typeof WeakMap=="function"?WeakMap:Map;function Wv(s,o,c){c=ps(-1,c),c.tag=3,c.payload={element:null};var f=o.value;return c.callback=function(){ld||(ld=!0,mp=f),Zm(s,o)},c}function qv(s,o,c){c=ps(-1,c),c.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var p=o.value;c.payload=function(){return f(p)},c.callback=function(){Zm(s,o)}}var y=s.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(c.callback=function(){Zm(s,o),typeof f!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var T=o.stack;this.componentDidCatch(o.value,{componentStack:T!==null?T:""})}),c}function $v(s,o,c){var f=s.pingCache;if(f===null){f=s.pingCache=new JS;var p=new Set;f.set(o,p)}else p=f.get(o),p===void 0&&(p=new Set,f.set(o,p));p.has(c)||(p.add(c),s=uA.bind(null,s,o,c),o.then(s,s))}function Hv(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function Gv(s,o,c,f,p){return(s.mode&1)===0?(s===o?s.flags|=65536:(s.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(o=ps(-1,1),o.tag=2,Zs(c,o,1))),c.lanes|=1),s):(s.flags|=65536,s.lanes=p,s)}var YS=Y.ReactCurrentOwner,In=!1;function dn(s,o,c,f){o.child=s===null?fv(o,null,c,f):Na(o,s.child,c,f)}function Kv(s,o,c,f,p){c=c.render;var y=o.ref;return Ra(o,p),f=qm(s,o,c,f,y,p),c=$m(),s!==null&&!In?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~p,gs(s,o,p)):(ot&&c&&Cm(o),o.flags|=1,dn(s,o,f,p),o.child)}function Qv(s,o,c,f,p){if(s===null){var y=c.type;return typeof y=="function"&&!Ip(y)&&y.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=y,Jv(s,o,y,f,p)):(s=md(c.type,null,f,o,o.mode,p),s.ref=o.ref,s.return=o,o.child=s)}if(y=s.child,(s.lanes&p)===0){var T=y.memoizedProps;if(c=c.compare,c=c!==null?c:mc,c(T,f)&&s.ref===o.ref)return gs(s,o,p)}return o.flags|=1,s=ii(y,f),s.ref=o.ref,s.return=o,o.child=s}function Jv(s,o,c,f,p){if(s!==null){var y=s.memoizedProps;if(mc(y,f)&&s.ref===o.ref)if(In=!1,o.pendingProps=f=y,(s.lanes&p)!==0)(s.flags&131072)!==0&&(In=!0);else return o.lanes=s.lanes,gs(s,o,p)}return ep(s,o,c,f,p)}function Yv(s,o,c){var f=o.pendingProps,p=f.children,y=s!==null?s.memoizedState:null;if(f.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Va,On),On|=c;else{if((c&1073741824)===0)return s=y!==null?y.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,Ze(Va,On),On|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=y!==null?y.baseLanes:c,Ze(Va,On),On|=f}else y!==null?(f=y.baseLanes|c,o.memoizedState=null):f=c,Ze(Va,On),On|=f;return dn(s,o,p,c),o.child}function Xv(s,o){var c=o.ref;(s===null&&c!==null||s!==null&&s.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function ep(s,o,c,f,p){var y=wn(c)?to:tn.current;return y=Sa(o,y),Ra(o,p),c=qm(s,o,c,f,y,p),f=$m(),s!==null&&!In?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~p,gs(s,o,p)):(ot&&f&&Cm(o),o.flags|=1,dn(s,o,c,p),o.child)}function Zv(s,o,c,f,p){if(wn(c)){var y=!0;Fh(o)}else y=!1;if(Ra(o,p),o.stateNode===null)rd(s,o),Bv(o,c,f),Ym(o,c,f,p),f=!0;else if(s===null){var T=o.stateNode,C=o.memoizedProps;T.props=C;var D=T.context,H=c.contextType;typeof H=="object"&&H!==null?H=Kn(H):(H=wn(c)?to:tn.current,H=Sa(o,H));var ne=c.getDerivedStateFromProps,se=typeof ne=="function"||typeof T.getSnapshotBeforeUpdate=="function";se||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(C!==f||D!==H)&&zv(o,T,f,H),Xs=!1;var ee=o.memoizedState;T.state=ee,Kh(o,f,T,p),D=o.memoizedState,C!==f||ee!==D||vn.current||Xs?(typeof ne=="function"&&(Jm(o,c,ne,f),D=o.memoizedState),(C=Xs||Uv(o,c,C,f,ee,D,H))?(se||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(o.flags|=4194308)):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=D),T.props=f,T.state=D,T.context=H,f=C):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{T=o.stateNode,pv(s,o),C=o.memoizedProps,H=o.type===o.elementType?C:ar(o.type,C),T.props=H,se=o.pendingProps,ee=T.context,D=c.contextType,typeof D=="object"&&D!==null?D=Kn(D):(D=wn(c)?to:tn.current,D=Sa(o,D));var fe=c.getDerivedStateFromProps;(ne=typeof fe=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(C!==se||ee!==D)&&zv(o,T,f,D),Xs=!1,ee=o.memoizedState,T.state=ee,Kh(o,f,T,p);var ge=o.memoizedState;C!==se||ee!==ge||vn.current||Xs?(typeof fe=="function"&&(Jm(o,c,fe,f),ge=o.memoizedState),(H=Xs||Uv(o,c,H,f,ee,ge,D)||!1)?(ne||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(f,ge,D),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(f,ge,D)),typeof T.componentDidUpdate=="function"&&(o.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof T.componentDidUpdate!="function"||C===s.memoizedProps&&ee===s.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&ee===s.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=ge),T.props=f,T.state=ge,T.context=D,f=H):(typeof T.componentDidUpdate!="function"||C===s.memoizedProps&&ee===s.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&ee===s.memoizedState||(o.flags|=1024),f=!1)}return tp(s,o,c,f,y,p)}function tp(s,o,c,f,p,y){Xv(s,o);var T=(o.flags&128)!==0;if(!f&&!T)return p&&sv(o,c,!1),gs(s,o,y);f=o.stateNode,YS.current=o;var C=T&&typeof c.getDerivedStateFromError!="function"?null:f.render();return o.flags|=1,s!==null&&T?(o.child=Na(o,s.child,null,y),o.child=Na(o,null,C,y)):dn(s,o,C,y),o.memoizedState=f.state,p&&sv(o,c,!0),o.child}function ew(s){var o=s.stateNode;o.pendingContext?nv(s,o.pendingContext,o.pendingContext!==o.context):o.context&&nv(s,o.context,!1),Mm(s,o.containerInfo)}function tw(s,o,c,f,p){return ka(),Rm(p),o.flags|=256,dn(s,o,c,f),o.child}var np={dehydrated:null,treeContext:null,retryLane:0};function rp(s){return{baseLanes:s,cachePool:null,transitions:null}}function nw(s,o,c){var f=o.pendingProps,p=dt.current,y=!1,T=(o.flags&128)!==0,C;if((C=T)||(C=s!==null&&s.memoizedState===null?!1:(p&2)!==0),C?(y=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(p|=1),Ze(dt,p&1),s===null)return Pm(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((o.mode&1)===0?o.lanes=1:s.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(T=f.children,s=f.fallback,y?(f=o.mode,y=o.child,T={mode:"hidden",children:T},(f&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=T):y=pd(T,f,0,null),s=ho(s,f,c,null),y.return=o,s.return=o,y.sibling=s,o.child=y,o.child.memoizedState=rp(c),o.memoizedState=np,s):sp(o,T));if(p=s.memoizedState,p!==null&&(C=p.dehydrated,C!==null))return XS(s,o,T,f,C,p,c);if(y){y=f.fallback,T=o.mode,p=s.child,C=p.sibling;var D={mode:"hidden",children:f.children};return(T&1)===0&&o.child!==p?(f=o.child,f.childLanes=0,f.pendingProps=D,o.deletions=null):(f=ii(p,D),f.subtreeFlags=p.subtreeFlags&14680064),C!==null?y=ii(C,y):(y=ho(y,T,c,null),y.flags|=2),y.return=o,f.return=o,f.sibling=y,o.child=f,f=y,y=o.child,T=s.child.memoizedState,T=T===null?rp(c):{baseLanes:T.baseLanes|c,cachePool:null,transitions:T.transitions},y.memoizedState=T,y.childLanes=s.childLanes&~c,o.memoizedState=np,f}return y=s.child,s=y.sibling,f=ii(y,{mode:"visible",children:f.children}),(o.mode&1)===0&&(f.lanes=c),f.return=o,f.sibling=null,s!==null&&(c=o.deletions,c===null?(o.deletions=[s],o.flags|=16):c.push(s)),o.child=f,o.memoizedState=null,f}function sp(s,o){return o=pd({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function nd(s,o,c,f){return f!==null&&Rm(f),Na(o,s.child,null,c),s=sp(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function XS(s,o,c,f,p,y,T){if(c)return o.flags&256?(o.flags&=-257,f=Xm(Error(t(422))),nd(s,o,T,f)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(y=f.fallback,p=o.mode,f=pd({mode:"visible",children:f.children},p,0,null),y=ho(y,p,T,null),y.flags|=2,f.return=o,y.return=o,f.sibling=y,o.child=f,(o.mode&1)!==0&&Na(o,s.child,null,T),o.child.memoizedState=rp(T),o.memoizedState=np,y);if((o.mode&1)===0)return nd(s,o,T,null);if(p.data==="$!"){if(f=p.nextSibling&&p.nextSibling.dataset,f)var C=f.dgst;return f=C,y=Error(t(419)),f=Xm(y,f,void 0),nd(s,o,T,f)}if(C=(T&s.childLanes)!==0,In||C){if(f=Bt,f!==null){switch(T&-T){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(f.suspendedLanes|T))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,ms(s,p),ur(f,s,p,-1))}return wp(),f=Xm(Error(t(421))),nd(s,o,T,f)}return p.data==="$?"?(o.flags|=128,o.child=s.child,o=hA.bind(null,s),p._reactRetry=o,null):(s=y.treeContext,Ln=Ks(p.nextSibling),Vn=o,ot=!0,or=null,s!==null&&(Hn[Gn++]=ds,Hn[Gn++]=fs,Hn[Gn++]=no,ds=s.id,fs=s.overflow,no=o),o=sp(o,f.children),o.flags|=4096,o)}function rw(s,o,c){s.lanes|=o;var f=s.alternate;f!==null&&(f.lanes|=o),Vm(s.return,o,c)}function ip(s,o,c,f,p){var y=s.memoizedState;y===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:p}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=f,y.tail=c,y.tailMode=p)}function sw(s,o,c){var f=o.pendingProps,p=f.revealOrder,y=f.tail;if(dn(s,o,f.children,c),f=dt.current,(f&2)!==0)f=f&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&rw(s,c,o);else if(s.tag===19)rw(s,c,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(Ze(dt,f),(o.mode&1)===0)o.memoizedState=null;else switch(p){case"forwards":for(c=o.child,p=null;c!==null;)s=c.alternate,s!==null&&Qh(s)===null&&(p=c),c=c.sibling;c=p,c===null?(p=o.child,o.child=null):(p=c.sibling,c.sibling=null),ip(o,!1,p,c,y);break;case"backwards":for(c=null,p=o.child,o.child=null;p!==null;){if(s=p.alternate,s!==null&&Qh(s)===null){o.child=p;break}s=p.sibling,p.sibling=c,c=p,p=s}ip(o,!0,c,null,y);break;case"together":ip(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function rd(s,o){(o.mode&1)===0&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function gs(s,o,c){if(s!==null&&(o.dependencies=s.dependencies),ao|=o.lanes,(c&o.childLanes)===0)return null;if(s!==null&&o.child!==s.child)throw Error(t(153));if(o.child!==null){for(s=o.child,c=ii(s,s.pendingProps),o.child=c,c.return=o;s.sibling!==null;)s=s.sibling,c=c.sibling=ii(s,s.pendingProps),c.return=o;c.sibling=null}return o.child}function ZS(s,o,c){switch(o.tag){case 3:ew(o),ka();break;case 5:_v(o);break;case 1:wn(o.type)&&Fh(o);break;case 4:Mm(o,o.stateNode.containerInfo);break;case 10:var f=o.type._context,p=o.memoizedProps.value;Ze($h,f._currentValue),f._currentValue=p;break;case 13:if(f=o.memoizedState,f!==null)return f.dehydrated!==null?(Ze(dt,dt.current&1),o.flags|=128,null):(c&o.child.childLanes)!==0?nw(s,o,c):(Ze(dt,dt.current&1),s=gs(s,o,c),s!==null?s.sibling:null);Ze(dt,dt.current&1);break;case 19:if(f=(c&o.childLanes)!==0,(s.flags&128)!==0){if(f)return sw(s,o,c);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Ze(dt,dt.current),f)break;return null;case 22:case 23:return o.lanes=0,Yv(s,o,c)}return gs(s,o,c)}var iw,op,ow,aw;iw=function(s,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)s.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},op=function(){},ow=function(s,o,c,f){var p=s.memoizedProps;if(p!==f){s=o.stateNode,io(jr.current);var y=null;switch(c){case"input":p=Yo(s,p),f=Yo(s,f),y=[];break;case"select":p=me({},p,{value:void 0}),f=me({},f,{value:void 0}),y=[];break;case"textarea":p=Wl(s,p),f=Wl(s,f),y=[];break;default:typeof p.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=Lh)}nr(c,f);var T;c=null;for(H in p)if(!f.hasOwnProperty(H)&&p.hasOwnProperty(H)&&p[H]!=null)if(H==="style"){var C=p[H];for(T in C)C.hasOwnProperty(T)&&(c||(c={}),c[T]="")}else H!=="dangerouslySetInnerHTML"&&H!=="children"&&H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(i.hasOwnProperty(H)?y||(y=[]):(y=y||[]).push(H,null));for(H in f){var D=f[H];if(C=p!=null?p[H]:void 0,f.hasOwnProperty(H)&&D!==C&&(D!=null||C!=null))if(H==="style")if(C){for(T in C)!C.hasOwnProperty(T)||D&&D.hasOwnProperty(T)||(c||(c={}),c[T]="");for(T in D)D.hasOwnProperty(T)&&C[T]!==D[T]&&(c||(c={}),c[T]=D[T])}else c||(y||(y=[]),y.push(H,c)),c=D;else H==="dangerouslySetInnerHTML"?(D=D?D.__html:void 0,C=C?C.__html:void 0,D!=null&&C!==D&&(y=y||[]).push(H,D)):H==="children"?typeof D!="string"&&typeof D!="number"||(y=y||[]).push(H,""+D):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&(i.hasOwnProperty(H)?(D!=null&&H==="onScroll"&&rt("scroll",s),y||C===D||(y=[])):(y=y||[]).push(H,D))}c&&(y=y||[]).push("style",c);var H=y;(o.updateQueue=H)&&(o.flags|=4)}},aw=function(s,o,c,f){c!==f&&(o.flags|=4)};function Nc(s,o){if(!ot)switch(s.tailMode){case"hidden":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function rn(s){var o=s.alternate!==null&&s.alternate.child===s.child,c=0,f=0;if(o)for(var p=s.child;p!==null;)c|=p.lanes|p.childLanes,f|=p.subtreeFlags&14680064,f|=p.flags&14680064,p.return=s,p=p.sibling;else for(p=s.child;p!==null;)c|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=s,p=p.sibling;return s.subtreeFlags|=f,s.childLanes=c,o}function eA(s,o,c){var f=o.pendingProps;switch(km(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(o),null;case 1:return wn(o.type)&&Mh(),rn(o),null;case 3:return f=o.stateNode,ba(),st(vn),st(tn),Bm(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(Wh(o)?o.flags|=4:s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,or!==null&&(yp(or),or=null))),op(s,o),rn(o),null;case 5:Fm(o);var p=io(xc.current);if(c=o.type,s!==null&&o.stateNode!=null)ow(s,o,c,f,p),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!f){if(o.stateNode===null)throw Error(t(166));return rn(o),null}if(s=io(jr.current),Wh(o)){f=o.stateNode,c=o.type;var y=o.memoizedProps;switch(f[Dr]=o,f[vc]=y,s=(o.mode&1)!==0,c){case"dialog":rt("cancel",f),rt("close",f);break;case"iframe":case"object":case"embed":rt("load",f);break;case"video":case"audio":for(p=0;p<gc.length;p++)rt(gc[p],f);break;case"source":rt("error",f);break;case"img":case"image":case"link":rt("error",f),rt("load",f);break;case"details":rt("toggle",f);break;case"input":ah(f,y),rt("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!y.multiple},rt("invalid",f);break;case"textarea":ql(f,y),rt("invalid",f)}nr(c,y),p=null;for(var T in y)if(y.hasOwnProperty(T)){var C=y[T];T==="children"?typeof C=="string"?f.textContent!==C&&(y.suppressHydrationWarning!==!0&&Vh(f.textContent,C,s),p=["children",C]):typeof C=="number"&&f.textContent!==""+C&&(y.suppressHydrationWarning!==!0&&Vh(f.textContent,C,s),p=["children",""+C]):i.hasOwnProperty(T)&&C!=null&&T==="onScroll"&&rt("scroll",f)}switch(c){case"input":Jo(f),zl(f,y,!0);break;case"textarea":Jo(f),bs(f);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(f.onclick=Lh)}f=p,o.updateQueue=f,f!==null&&(o.flags|=4)}else{T=p.nodeType===9?p:p.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=$l(c)),s==="http://www.w3.org/1999/xhtml"?c==="script"?(s=T.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=T.createElement(c,{is:f.is}):(s=T.createElement(c),c==="select"&&(T=s,f.multiple?T.multiple=!0:f.size&&(T.size=f.size))):s=T.createElementNS(s,c),s[Dr]=o,s[vc]=f,iw(s,o,!1,!1),o.stateNode=s;e:{switch(T=ta(c,f),c){case"dialog":rt("cancel",s),rt("close",s),p=f;break;case"iframe":case"object":case"embed":rt("load",s),p=f;break;case"video":case"audio":for(p=0;p<gc.length;p++)rt(gc[p],s);p=f;break;case"source":rt("error",s),p=f;break;case"img":case"image":case"link":rt("error",s),rt("load",s),p=f;break;case"details":rt("toggle",s),p=f;break;case"input":ah(s,f),p=Yo(s,f),rt("invalid",s);break;case"option":p=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},p=me({},f,{value:void 0}),rt("invalid",s);break;case"textarea":ql(s,f),p=Wl(s,f),rt("invalid",s);break;default:p=f}nr(c,p),C=p;for(y in C)if(C.hasOwnProperty(y)){var D=C[y];y==="style"?ea(s,D):y==="dangerouslySetInnerHTML"?(D=D?D.__html:void 0,D!=null&&ch(s,D)):y==="children"?typeof D=="string"?(c!=="textarea"||D!=="")&&Ui(s,D):typeof D=="number"&&Ui(s,""+D):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(i.hasOwnProperty(y)?D!=null&&y==="onScroll"&&rt("scroll",s):D!=null&&W(s,y,D,T))}switch(c){case"input":Jo(s),zl(s,f,!1);break;case"textarea":Jo(s),bs(s);break;case"option":f.value!=null&&s.setAttribute("value",""+Ue(f.value));break;case"select":s.multiple=!!f.multiple,y=f.value,y!=null?tr(s,!!f.multiple,y,!1):f.defaultValue!=null&&tr(s,!!f.multiple,f.defaultValue,!0);break;default:typeof p.onClick=="function"&&(s.onclick=Lh)}switch(c){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return rn(o),null;case 6:if(s&&o.stateNode!=null)aw(s,o,s.memoizedProps,f);else{if(typeof f!="string"&&o.stateNode===null)throw Error(t(166));if(c=io(xc.current),io(jr.current),Wh(o)){if(f=o.stateNode,c=o.memoizedProps,f[Dr]=o,(y=f.nodeValue!==c)&&(s=Vn,s!==null))switch(s.tag){case 3:Vh(f.nodeValue,c,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Vh(f.nodeValue,c,(s.mode&1)!==0)}y&&(o.flags|=4)}else f=(c.nodeType===9?c:c.ownerDocument).createTextNode(f),f[Dr]=o,o.stateNode=f}return rn(o),null;case 13:if(st(dt),f=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(ot&&Ln!==null&&(o.mode&1)!==0&&(o.flags&128)===0)uv(),ka(),o.flags|=98560,y=!1;else if(y=Wh(o),f!==null&&f.dehydrated!==null){if(s===null){if(!y)throw Error(t(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[Dr]=o}else ka(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;rn(o),y=!1}else or!==null&&(yp(or),or=null),y=!0;if(!y)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=c,o):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(o.child.flags|=8192,(o.mode&1)!==0&&(s===null||(dt.current&1)!==0?Vt===0&&(Vt=3):wp())),o.updateQueue!==null&&(o.flags|=4),rn(o),null);case 4:return ba(),op(s,o),s===null&&yc(o.stateNode.containerInfo),rn(o),null;case 10:return jm(o.type._context),rn(o),null;case 17:return wn(o.type)&&Mh(),rn(o),null;case 19:if(st(dt),y=o.memoizedState,y===null)return rn(o),null;if(f=(o.flags&128)!==0,T=y.rendering,T===null)if(f)Nc(y,!1);else{if(Vt!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(T=Qh(s),T!==null){for(o.flags|=128,Nc(y,!1),f=T.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),o.subtreeFlags=0,f=c,c=o.child;c!==null;)y=c,s=f,y.flags&=14680066,T=y.alternate,T===null?(y.childLanes=0,y.lanes=s,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=T.childLanes,y.lanes=T.lanes,y.child=T.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=T.memoizedProps,y.memoizedState=T.memoizedState,y.updateQueue=T.updateQueue,y.type=T.type,s=T.dependencies,y.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),c=c.sibling;return Ze(dt,dt.current&1|2),o.child}s=s.sibling}y.tail!==null&&nt()>La&&(o.flags|=128,f=!0,Nc(y,!1),o.lanes=4194304)}else{if(!f)if(s=Qh(T),s!==null){if(o.flags|=128,f=!0,c=s.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),Nc(y,!0),y.tail===null&&y.tailMode==="hidden"&&!T.alternate&&!ot)return rn(o),null}else 2*nt()-y.renderingStartTime>La&&c!==1073741824&&(o.flags|=128,f=!0,Nc(y,!1),o.lanes=4194304);y.isBackwards?(T.sibling=o.child,o.child=T):(c=y.last,c!==null?c.sibling=T:o.child=T,y.last=T)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=nt(),o.sibling=null,c=dt.current,Ze(dt,f?c&1|2:c&1),o):(rn(o),null);case 22:case 23:return vp(),f=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(o.flags|=8192),f&&(o.mode&1)!==0?(On&1073741824)!==0&&(rn(o),o.subtreeFlags&6&&(o.flags|=8192)):rn(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function tA(s,o){switch(km(o),o.tag){case 1:return wn(o.type)&&Mh(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return ba(),st(vn),st(tn),Bm(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 5:return Fm(o),null;case 13:if(st(dt),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(t(340));ka()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return st(dt),null;case 4:return ba(),null;case 10:return jm(o.type._context),null;case 22:case 23:return vp(),null;case 24:return null;default:return null}}var sd=!1,sn=!1,nA=typeof WeakSet=="function"?WeakSet:Set,pe=null;function ja(s,o){var c=s.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(f){yt(s,o,f)}else c.current=null}function ap(s,o,c){try{c()}catch(f){yt(s,o,f)}}var lw=!1;function rA(s,o){if(vm=as,s=U_(),hm(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var p=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var T=0,C=-1,D=-1,H=0,ne=0,se=s,ee=null;t:for(;;){for(var fe;se!==c||p!==0&&se.nodeType!==3||(C=T+p),se!==y||f!==0&&se.nodeType!==3||(D=T+f),se.nodeType===3&&(T+=se.nodeValue.length),(fe=se.firstChild)!==null;)ee=se,se=fe;for(;;){if(se===s)break t;if(ee===c&&++H===p&&(C=T),ee===y&&++ne===f&&(D=T),(fe=se.nextSibling)!==null)break;se=ee,ee=se.parentNode}se=fe}c=C===-1||D===-1?null:{start:C,end:D}}else c=null}c=c||{start:0,end:0}}else c=null;for(wm={focusedElem:s,selectionRange:c},as=!1,pe=o;pe!==null;)if(o=pe,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,pe=s;else for(;pe!==null;){o=pe;try{var ge=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ge!==null){var _e=ge.memoizedProps,Tt=ge.memoizedState,B=o.stateNode,V=B.getSnapshotBeforeUpdate(o.elementType===o.type?_e:ar(o.type,_e),Tt);B.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var q=o.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ie){yt(o,o.return,ie)}if(s=o.sibling,s!==null){s.return=o.return,pe=s;break}pe=o.return}return ge=lw,lw=!1,ge}function Pc(s,o,c){var f=o.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var p=f=f.next;do{if((p.tag&s)===s){var y=p.destroy;p.destroy=void 0,y!==void 0&&ap(o,c,y)}p=p.next}while(p!==f)}}function id(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&s)===s){var f=c.create;c.destroy=f()}c=c.next}while(c!==o)}}function lp(s){var o=s.ref;if(o!==null){var c=s.stateNode;switch(s.tag){case 5:s=c;break;default:s=c}typeof o=="function"?o(s):o.current=s}}function cw(s){var o=s.alternate;o!==null&&(s.alternate=null,cw(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&(delete o[Dr],delete o[vc],delete o[xm],delete o[FS],delete o[US])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function uw(s){return s.tag===5||s.tag===3||s.tag===4}function hw(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||uw(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function cp(s,o,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?c.nodeType===8?c.parentNode.insertBefore(s,o):c.insertBefore(s,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(s,c)):(o=c,o.appendChild(s)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Lh));else if(f!==4&&(s=s.child,s!==null))for(cp(s,o,c),s=s.sibling;s!==null;)cp(s,o,c),s=s.sibling}function up(s,o,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?c.insertBefore(s,o):c.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(up(s,o,c),s=s.sibling;s!==null;)up(s,o,c),s=s.sibling}var Kt=null,lr=!1;function ei(s,o,c){for(c=c.child;c!==null;)dw(s,o,c),c=c.sibling}function dw(s,o,c){if(Nn&&typeof Nn.onCommitFiberUnmount=="function")try{Nn.onCommitFiberUnmount($i,c)}catch{}switch(c.tag){case 5:sn||ja(c,o);case 6:var f=Kt,p=lr;Kt=null,ei(s,o,c),Kt=f,lr=p,Kt!==null&&(lr?(s=Kt,c=c.stateNode,s.nodeType===8?s.parentNode.removeChild(c):s.removeChild(c)):Kt.removeChild(c.stateNode));break;case 18:Kt!==null&&(lr?(s=Kt,c=c.stateNode,s.nodeType===8?Tm(s.parentNode,c):s.nodeType===1&&Tm(s,c),qs(s)):Tm(Kt,c.stateNode));break;case 4:f=Kt,p=lr,Kt=c.stateNode.containerInfo,lr=!0,ei(s,o,c),Kt=f,lr=p;break;case 0:case 11:case 14:case 15:if(!sn&&(f=c.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){p=f=f.next;do{var y=p,T=y.destroy;y=y.tag,T!==void 0&&((y&2)!==0||(y&4)!==0)&&ap(c,o,T),p=p.next}while(p!==f)}ei(s,o,c);break;case 1:if(!sn&&(ja(c,o),f=c.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=c.memoizedProps,f.state=c.memoizedState,f.componentWillUnmount()}catch(C){yt(c,o,C)}ei(s,o,c);break;case 21:ei(s,o,c);break;case 22:c.mode&1?(sn=(f=sn)||c.memoizedState!==null,ei(s,o,c),sn=f):ei(s,o,c);break;default:ei(s,o,c)}}function fw(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var c=s.stateNode;c===null&&(c=s.stateNode=new nA),o.forEach(function(f){var p=dA.bind(null,s,f);c.has(f)||(c.add(f),f.then(p,p))})}}function cr(s,o){var c=o.deletions;if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];try{var y=s,T=o,C=T;e:for(;C!==null;){switch(C.tag){case 5:Kt=C.stateNode,lr=!1;break e;case 3:Kt=C.stateNode.containerInfo,lr=!0;break e;case 4:Kt=C.stateNode.containerInfo,lr=!0;break e}C=C.return}if(Kt===null)throw Error(t(160));dw(y,T,p),Kt=null,lr=!1;var D=p.alternate;D!==null&&(D.return=null),p.return=null}catch(H){yt(p,o,H)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)mw(o,s),o=o.sibling}function mw(s,o){var c=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(cr(o,s),Lr(s),f&4){try{Pc(3,s,s.return),id(3,s)}catch(_e){yt(s,s.return,_e)}try{Pc(5,s,s.return)}catch(_e){yt(s,s.return,_e)}}break;case 1:cr(o,s),Lr(s),f&512&&c!==null&&ja(c,c.return);break;case 5:if(cr(o,s),Lr(s),f&512&&c!==null&&ja(c,c.return),s.flags&32){var p=s.stateNode;try{Ui(p,"")}catch(_e){yt(s,s.return,_e)}}if(f&4&&(p=s.stateNode,p!=null)){var y=s.memoizedProps,T=c!==null?c.memoizedProps:y,C=s.type,D=s.updateQueue;if(s.updateQueue=null,D!==null)try{C==="input"&&y.type==="radio"&&y.name!=null&&Xo(p,y),ta(C,T);var H=ta(C,y);for(T=0;T<D.length;T+=2){var ne=D[T],se=D[T+1];ne==="style"?ea(p,se):ne==="dangerouslySetInnerHTML"?ch(p,se):ne==="children"?Ui(p,se):W(p,ne,se,H)}switch(C){case"input":Fi(p,y);break;case"textarea":lh(p,y);break;case"select":var ee=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var fe=y.value;fe!=null?tr(p,!!y.multiple,fe,!1):ee!==!!y.multiple&&(y.defaultValue!=null?tr(p,!!y.multiple,y.defaultValue,!0):tr(p,!!y.multiple,y.multiple?[]:"",!1))}p[vc]=y}catch(_e){yt(s,s.return,_e)}}break;case 6:if(cr(o,s),Lr(s),f&4){if(s.stateNode===null)throw Error(t(162));p=s.stateNode,y=s.memoizedProps;try{p.nodeValue=y}catch(_e){yt(s,s.return,_e)}}break;case 3:if(cr(o,s),Lr(s),f&4&&c!==null&&c.memoizedState.isDehydrated)try{qs(o.containerInfo)}catch(_e){yt(s,s.return,_e)}break;case 4:cr(o,s),Lr(s);break;case 13:cr(o,s),Lr(s),p=s.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(fp=nt())),f&4&&fw(s);break;case 22:if(ne=c!==null&&c.memoizedState!==null,s.mode&1?(sn=(H=sn)||ne,cr(o,s),sn=H):cr(o,s),Lr(s),f&8192){if(H=s.memoizedState!==null,(s.stateNode.isHidden=H)&&!ne&&(s.mode&1)!==0)for(pe=s,ne=s.child;ne!==null;){for(se=pe=ne;pe!==null;){switch(ee=pe,fe=ee.child,ee.tag){case 0:case 11:case 14:case 15:Pc(4,ee,ee.return);break;case 1:ja(ee,ee.return);var ge=ee.stateNode;if(typeof ge.componentWillUnmount=="function"){f=ee,c=ee.return;try{o=f,ge.props=o.memoizedProps,ge.state=o.memoizedState,ge.componentWillUnmount()}catch(_e){yt(f,c,_e)}}break;case 5:ja(ee,ee.return);break;case 22:if(ee.memoizedState!==null){yw(se);continue}}fe!==null?(fe.return=ee,pe=fe):yw(se)}ne=ne.sibling}e:for(ne=null,se=s;;){if(se.tag===5){if(ne===null){ne=se;try{p=se.stateNode,H?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(C=se.stateNode,D=se.memoizedProps.style,T=D!=null&&D.hasOwnProperty("display")?D.display:null,C.style.display=Vs("display",T))}catch(_e){yt(s,s.return,_e)}}}else if(se.tag===6){if(ne===null)try{se.stateNode.nodeValue=H?"":se.memoizedProps}catch(_e){yt(s,s.return,_e)}}else if((se.tag!==22&&se.tag!==23||se.memoizedState===null||se===s)&&se.child!==null){se.child.return=se,se=se.child;continue}if(se===s)break e;for(;se.sibling===null;){if(se.return===null||se.return===s)break e;ne===se&&(ne=null),se=se.return}ne===se&&(ne=null),se.sibling.return=se.return,se=se.sibling}}break;case 19:cr(o,s),Lr(s),f&4&&fw(s);break;case 21:break;default:cr(o,s),Lr(s)}}function Lr(s){var o=s.flags;if(o&2){try{e:{for(var c=s.return;c!==null;){if(uw(c)){var f=c;break e}c=c.return}throw Error(t(160))}switch(f.tag){case 5:var p=f.stateNode;f.flags&32&&(Ui(p,""),f.flags&=-33);var y=hw(s);up(s,y,p);break;case 3:case 4:var T=f.stateNode.containerInfo,C=hw(s);cp(s,C,T);break;default:throw Error(t(161))}}catch(D){yt(s,s.return,D)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function sA(s,o,c){pe=s,pw(s)}function pw(s,o,c){for(var f=(s.mode&1)!==0;pe!==null;){var p=pe,y=p.child;if(p.tag===22&&f){var T=p.memoizedState!==null||sd;if(!T){var C=p.alternate,D=C!==null&&C.memoizedState!==null||sn;C=sd;var H=sn;if(sd=T,(sn=D)&&!H)for(pe=p;pe!==null;)T=pe,D=T.child,T.tag===22&&T.memoizedState!==null?_w(p):D!==null?(D.return=T,pe=D):_w(p);for(;y!==null;)pe=y,pw(y),y=y.sibling;pe=p,sd=C,sn=H}gw(s)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,pe=y):gw(s)}}function gw(s){for(;pe!==null;){var o=pe;if((o.flags&8772)!==0){var c=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:sn||id(5,o);break;case 1:var f=o.stateNode;if(o.flags&4&&!sn)if(c===null)f.componentDidMount();else{var p=o.elementType===o.type?c.memoizedProps:ar(o.type,c.memoizedProps);f.componentDidUpdate(p,c.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var y=o.updateQueue;y!==null&&yv(o,y,f);break;case 3:var T=o.updateQueue;if(T!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=o.child.stateNode;break;case 1:c=o.child.stateNode}yv(o,T,c)}break;case 5:var C=o.stateNode;if(c===null&&o.flags&4){c=C;var D=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":D.autoFocus&&c.focus();break;case"img":D.src&&(c.src=D.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var H=o.alternate;if(H!==null){var ne=H.memoizedState;if(ne!==null){var se=ne.dehydrated;se!==null&&qs(se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}sn||o.flags&512&&lp(o)}catch(ee){yt(o,o.return,ee)}}if(o===s){pe=null;break}if(c=o.sibling,c!==null){c.return=o.return,pe=c;break}pe=o.return}}function yw(s){for(;pe!==null;){var o=pe;if(o===s){pe=null;break}var c=o.sibling;if(c!==null){c.return=o.return,pe=c;break}pe=o.return}}function _w(s){for(;pe!==null;){var o=pe;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{id(4,o)}catch(D){yt(o,c,D)}break;case 1:var f=o.stateNode;if(typeof f.componentDidMount=="function"){var p=o.return;try{f.componentDidMount()}catch(D){yt(o,p,D)}}var y=o.return;try{lp(o)}catch(D){yt(o,y,D)}break;case 5:var T=o.return;try{lp(o)}catch(D){yt(o,T,D)}}}catch(D){yt(o,o.return,D)}if(o===s){pe=null;break}var C=o.sibling;if(C!==null){C.return=o.return,pe=C;break}pe=o.return}}var iA=Math.ceil,od=Y.ReactCurrentDispatcher,hp=Y.ReactCurrentOwner,Jn=Y.ReactCurrentBatchConfig,Be=0,Bt=null,Pt=null,Qt=0,On=0,Va=Qs(0),Vt=0,Rc=null,ao=0,ad=0,dp=0,bc=null,En=null,fp=0,La=1/0,ys=null,ld=!1,mp=null,ti=null,cd=!1,ni=null,ud=0,Dc=0,pp=null,hd=-1,dd=0;function fn(){return(Be&6)!==0?nt():hd!==-1?hd:hd=nt()}function ri(s){return(s.mode&1)===0?1:(Be&2)!==0&&Qt!==0?Qt&-Qt:zS.transition!==null?(dd===0&&(dd=ec()),dd):(s=Me,s!==0||(s=window.event,s=s===void 0?16:ha(s.type)),s)}function ur(s,o,c,f){if(50<Dc)throw Dc=0,pp=null,Error(t(185));Qi(s,c,f),((Be&2)===0||s!==Bt)&&(s===Bt&&((Be&2)===0&&(ad|=c),Vt===4&&si(s,Qt)),Tn(s,f),c===1&&Be===0&&(o.mode&1)===0&&(La=nt()+500,Uh&&Ys()))}function Tn(s,o){var c=s.callbackNode;Ki(s,o);var f=ss(s,s===Bt?Qt:0);if(f===0)c!==null&&sa(c),s.callbackNode=null,s.callbackPriority=0;else if(o=f&-f,s.callbackPriority!==o){if(c!=null&&sa(c),o===1)s.tag===0?BS(ww.bind(null,s)):iv(ww.bind(null,s)),OS(function(){(Be&6)===0&&Ys()}),c=null;else{switch(Tr(f)){case 1:c=ia;break;case 4:c=Yl;break;case 16:c=qi;break;case 536870912:c=oa;break;default:c=qi}c=kw(c,vw.bind(null,s))}s.callbackPriority=o,s.callbackNode=c}}function vw(s,o){if(hd=-1,dd=0,(Be&6)!==0)throw Error(t(327));var c=s.callbackNode;if(Oa()&&s.callbackNode!==c)return null;var f=ss(s,s===Bt?Qt:0);if(f===0)return null;if((f&30)!==0||(f&s.expiredLanes)!==0||o)o=fd(s,f);else{o=f;var p=Be;Be|=2;var y=Ew();(Bt!==s||Qt!==o)&&(ys=null,La=nt()+500,co(s,o));do try{lA();break}catch(C){Iw(s,C)}while(!0);Dm(),od.current=y,Be=p,Pt!==null?o=0:(Bt=null,Qt=0,o=Vt)}if(o!==0){if(o===2&&(p=Zl(s),p!==0&&(f=p,o=gp(s,p))),o===1)throw c=Rc,co(s,0),si(s,f),Tn(s,nt()),c;if(o===6)si(s,f);else{if(p=s.current.alternate,(f&30)===0&&!oA(p)&&(o=fd(s,f),o===2&&(y=Zl(s),y!==0&&(f=y,o=gp(s,y))),o===1))throw c=Rc,co(s,0),si(s,f),Tn(s,nt()),c;switch(s.finishedWork=p,s.finishedLanes=f,o){case 0:case 1:throw Error(t(345));case 2:uo(s,En,ys);break;case 3:if(si(s,f),(f&130023424)===f&&(o=fp+500-nt(),10<o)){if(ss(s,0)!==0)break;if(p=s.suspendedLanes,(p&f)!==f){fn(),s.pingedLanes|=s.suspendedLanes&p;break}s.timeoutHandle=Em(uo.bind(null,s,En,ys),o);break}uo(s,En,ys);break;case 4:if(si(s,f),(f&4194240)===f)break;for(o=s.eventTimes,p=-1;0<f;){var T=31-Pn(f);y=1<<T,T=o[T],T>p&&(p=T),f&=~y}if(f=p,f=nt()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*iA(f/1960))-f,10<f){s.timeoutHandle=Em(uo.bind(null,s,En,ys),f);break}uo(s,En,ys);break;case 5:uo(s,En,ys);break;default:throw Error(t(329))}}}return Tn(s,nt()),s.callbackNode===c?vw.bind(null,s):null}function gp(s,o){var c=bc;return s.current.memoizedState.isDehydrated&&(co(s,o).flags|=256),s=fd(s,o),s!==2&&(o=En,En=c,o!==null&&yp(o)),s}function yp(s){En===null?En=s:En.push.apply(En,s)}function oA(s){for(var o=s;;){if(o.flags&16384){var c=o.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var f=0;f<c.length;f++){var p=c[f],y=p.getSnapshot;p=p.value;try{if(!ir(y(),p))return!1}catch{return!1}}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function si(s,o){for(o&=~dp,o&=~ad,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var c=31-Pn(o),f=1<<c;s[c]=-1,o&=~f}}function ww(s){if((Be&6)!==0)throw Error(t(327));Oa();var o=ss(s,0);if((o&1)===0)return Tn(s,nt()),null;var c=fd(s,o);if(s.tag!==0&&c===2){var f=Zl(s);f!==0&&(o=f,c=gp(s,f))}if(c===1)throw c=Rc,co(s,0),si(s,o),Tn(s,nt()),c;if(c===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,uo(s,En,ys),Tn(s,nt()),null}function _p(s,o){var c=Be;Be|=1;try{return s(o)}finally{Be=c,Be===0&&(La=nt()+500,Uh&&Ys())}}function lo(s){ni!==null&&ni.tag===0&&(Be&6)===0&&Oa();var o=Be;Be|=1;var c=Jn.transition,f=Me;try{if(Jn.transition=null,Me=1,s)return s()}finally{Me=f,Jn.transition=c,Be=o,(Be&6)===0&&Ys()}}function vp(){On=Va.current,st(Va)}function co(s,o){s.finishedWork=null,s.finishedLanes=0;var c=s.timeoutHandle;if(c!==-1&&(s.timeoutHandle=-1,LS(c)),Pt!==null)for(c=Pt.return;c!==null;){var f=c;switch(km(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&Mh();break;case 3:ba(),st(vn),st(tn),Bm();break;case 5:Fm(f);break;case 4:ba();break;case 13:st(dt);break;case 19:st(dt);break;case 10:jm(f.type._context);break;case 22:case 23:vp()}c=c.return}if(Bt=s,Pt=s=ii(s.current,null),Qt=On=o,Vt=0,Rc=null,dp=ad=ao=0,En=bc=null,so!==null){for(o=0;o<so.length;o++)if(c=so[o],f=c.interleaved,f!==null){c.interleaved=null;var p=f.next,y=c.pending;if(y!==null){var T=y.next;y.next=p,f.next=T}c.pending=f}so=null}return s}function Iw(s,o){do{var c=Pt;try{if(Dm(),Jh.current=ed,Yh){for(var f=ft.memoizedState;f!==null;){var p=f.queue;p!==null&&(p.pending=null),f=f.next}Yh=!1}if(oo=0,Ut=jt=ft=null,Sc=!1,Ac=0,hp.current=null,c===null||c.return===null){Vt=1,Rc=o,Pt=null;break}e:{var y=s,T=c.return,C=c,D=o;if(o=Qt,C.flags|=32768,D!==null&&typeof D=="object"&&typeof D.then=="function"){var H=D,ne=C,se=ne.tag;if((ne.mode&1)===0&&(se===0||se===11||se===15)){var ee=ne.alternate;ee?(ne.updateQueue=ee.updateQueue,ne.memoizedState=ee.memoizedState,ne.lanes=ee.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var fe=Hv(T);if(fe!==null){fe.flags&=-257,Gv(fe,T,C,y,o),fe.mode&1&&$v(y,H,o),o=fe,D=H;var ge=o.updateQueue;if(ge===null){var _e=new Set;_e.add(D),o.updateQueue=_e}else ge.add(D);break e}else{if((o&1)===0){$v(y,H,o),wp();break e}D=Error(t(426))}}else if(ot&&C.mode&1){var Tt=Hv(T);if(Tt!==null){(Tt.flags&65536)===0&&(Tt.flags|=256),Gv(Tt,T,C,y,o),Rm(Da(D,C));break e}}y=D=Da(D,C),Vt!==4&&(Vt=2),bc===null?bc=[y]:bc.push(y),y=T;do{switch(y.tag){case 3:y.flags|=65536,o&=-o,y.lanes|=o;var B=Wv(y,D,o);gv(y,B);break e;case 1:C=D;var V=y.type,q=y.stateNode;if((y.flags&128)===0&&(typeof V.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(ti===null||!ti.has(q)))){y.flags|=65536,o&=-o,y.lanes|=o;var ie=qv(y,C,o);gv(y,ie);break e}}y=y.return}while(y!==null)}xw(c)}catch(ve){o=ve,Pt===c&&c!==null&&(Pt=c=c.return);continue}break}while(!0)}function Ew(){var s=od.current;return od.current=ed,s===null?ed:s}function wp(){(Vt===0||Vt===3||Vt===2)&&(Vt=4),Bt===null||(ao&268435455)===0&&(ad&268435455)===0||si(Bt,Qt)}function fd(s,o){var c=Be;Be|=2;var f=Ew();(Bt!==s||Qt!==o)&&(ys=null,co(s,o));do try{aA();break}catch(p){Iw(s,p)}while(!0);if(Dm(),Be=c,od.current=f,Pt!==null)throw Error(t(261));return Bt=null,Qt=0,Vt}function aA(){for(;Pt!==null;)Tw(Pt)}function lA(){for(;Pt!==null&&!Wi();)Tw(Pt)}function Tw(s){var o=Cw(s.alternate,s,On);s.memoizedProps=s.pendingProps,o===null?xw(s):Pt=o,hp.current=null}function xw(s){var o=s;do{var c=o.alternate;if(s=o.return,(o.flags&32768)===0){if(c=eA(c,o,On),c!==null){Pt=c;return}}else{if(c=tA(c,o),c!==null){c.flags&=32767,Pt=c;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Vt=6,Pt=null;return}}if(o=o.sibling,o!==null){Pt=o;return}Pt=o=s}while(o!==null);Vt===0&&(Vt=5)}function uo(s,o,c){var f=Me,p=Jn.transition;try{Jn.transition=null,Me=1,cA(s,o,c,f)}finally{Jn.transition=p,Me=f}return null}function cA(s,o,c,f){do Oa();while(ni!==null);if((Be&6)!==0)throw Error(t(327));c=s.finishedWork;var p=s.finishedLanes;if(c===null)return null;if(s.finishedWork=null,s.finishedLanes=0,c===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var y=c.lanes|c.childLanes;if(om(s,y),s===Bt&&(Pt=Bt=null,Qt=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||cd||(cd=!0,kw(qi,function(){return Oa(),null})),y=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||y){y=Jn.transition,Jn.transition=null;var T=Me;Me=1;var C=Be;Be|=4,hp.current=null,rA(s,c),mw(c,s),NS(wm),as=!!vm,wm=vm=null,s.current=c,sA(c),rs(),Be=C,Me=T,Jn.transition=y}else s.current=c;if(cd&&(cd=!1,ni=s,ud=p),y=s.pendingLanes,y===0&&(ti=null),wh(c.stateNode),Tn(s,nt()),o!==null)for(f=s.onRecoverableError,c=0;c<o.length;c++)p=o[c],f(p.value,{componentStack:p.stack,digest:p.digest});if(ld)throw ld=!1,s=mp,mp=null,s;return(ud&1)!==0&&s.tag!==0&&Oa(),y=s.pendingLanes,(y&1)!==0?s===pp?Dc++:(Dc=0,pp=s):Dc=0,Ys(),null}function Oa(){if(ni!==null){var s=Tr(ud),o=Jn.transition,c=Me;try{if(Jn.transition=null,Me=16>s?16:s,ni===null)var f=!1;else{if(s=ni,ni=null,ud=0,(Be&6)!==0)throw Error(t(331));var p=Be;for(Be|=4,pe=s.current;pe!==null;){var y=pe,T=y.child;if((pe.flags&16)!==0){var C=y.deletions;if(C!==null){for(var D=0;D<C.length;D++){var H=C[D];for(pe=H;pe!==null;){var ne=pe;switch(ne.tag){case 0:case 11:case 15:Pc(8,ne,y)}var se=ne.child;if(se!==null)se.return=ne,pe=se;else for(;pe!==null;){ne=pe;var ee=ne.sibling,fe=ne.return;if(cw(ne),ne===H){pe=null;break}if(ee!==null){ee.return=fe,pe=ee;break}pe=fe}}}var ge=y.alternate;if(ge!==null){var _e=ge.child;if(_e!==null){ge.child=null;do{var Tt=_e.sibling;_e.sibling=null,_e=Tt}while(_e!==null)}}pe=y}}if((y.subtreeFlags&2064)!==0&&T!==null)T.return=y,pe=T;else e:for(;pe!==null;){if(y=pe,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:Pc(9,y,y.return)}var B=y.sibling;if(B!==null){B.return=y.return,pe=B;break e}pe=y.return}}var V=s.current;for(pe=V;pe!==null;){T=pe;var q=T.child;if((T.subtreeFlags&2064)!==0&&q!==null)q.return=T,pe=q;else e:for(T=V;pe!==null;){if(C=pe,(C.flags&2048)!==0)try{switch(C.tag){case 0:case 11:case 15:id(9,C)}}catch(ve){yt(C,C.return,ve)}if(C===T){pe=null;break e}var ie=C.sibling;if(ie!==null){ie.return=C.return,pe=ie;break e}pe=C.return}}if(Be=p,Ys(),Nn&&typeof Nn.onPostCommitFiberRoot=="function")try{Nn.onPostCommitFiberRoot($i,s)}catch{}f=!0}return f}finally{Me=c,Jn.transition=o}}return!1}function Sw(s,o,c){o=Da(c,o),o=Wv(s,o,1),s=Zs(s,o,1),o=fn(),s!==null&&(Qi(s,1,o),Tn(s,o))}function yt(s,o,c){if(s.tag===3)Sw(s,s,c);else for(;o!==null;){if(o.tag===3){Sw(o,s,c);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ti===null||!ti.has(f))){s=Da(c,s),s=qv(o,s,1),o=Zs(o,s,1),s=fn(),o!==null&&(Qi(o,1,s),Tn(o,s));break}}o=o.return}}function uA(s,o,c){var f=s.pingCache;f!==null&&f.delete(o),o=fn(),s.pingedLanes|=s.suspendedLanes&c,Bt===s&&(Qt&c)===c&&(Vt===4||Vt===3&&(Qt&130023424)===Qt&&500>nt()-fp?co(s,0):dp|=c),Tn(s,o)}function Aw(s,o){o===0&&((s.mode&1)===0?o=1:(o=Bs,Bs<<=1,(Bs&130023424)===0&&(Bs=4194304)));var c=fn();s=ms(s,o),s!==null&&(Qi(s,o,c),Tn(s,c))}function hA(s){var o=s.memoizedState,c=0;o!==null&&(c=o.retryLane),Aw(s,c)}function dA(s,o){var c=0;switch(s.tag){case 13:var f=s.stateNode,p=s.memoizedState;p!==null&&(c=p.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(o),Aw(s,c)}var Cw;Cw=function(s,o,c){if(s!==null)if(s.memoizedProps!==o.pendingProps||vn.current)In=!0;else{if((s.lanes&c)===0&&(o.flags&128)===0)return In=!1,ZS(s,o,c);In=(s.flags&131072)!==0}else In=!1,ot&&(o.flags&1048576)!==0&&ov(o,zh,o.index);switch(o.lanes=0,o.tag){case 2:var f=o.type;rd(s,o),s=o.pendingProps;var p=Sa(o,tn.current);Ra(o,c),p=qm(null,o,f,s,p,c);var y=$m();return o.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,wn(f)?(y=!0,Fh(o)):y=!1,o.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Om(o),p.updater=td,o.stateNode=p,p._reactInternals=o,Ym(o,f,s,c),o=tp(null,o,f,!0,y,c)):(o.tag=0,ot&&y&&Cm(o),dn(null,o,p,c),o=o.child),o;case 16:f=o.elementType;e:{switch(rd(s,o),s=o.pendingProps,p=f._init,f=p(f._payload),o.type=f,p=o.tag=mA(f),s=ar(f,s),p){case 0:o=ep(null,o,f,s,c);break e;case 1:o=Zv(null,o,f,s,c);break e;case 11:o=Kv(null,o,f,s,c);break e;case 14:o=Qv(null,o,f,ar(f.type,s),c);break e}throw Error(t(306,f,""))}return o;case 0:return f=o.type,p=o.pendingProps,p=o.elementType===f?p:ar(f,p),ep(s,o,f,p,c);case 1:return f=o.type,p=o.pendingProps,p=o.elementType===f?p:ar(f,p),Zv(s,o,f,p,c);case 3:e:{if(ew(o),s===null)throw Error(t(387));f=o.pendingProps,y=o.memoizedState,p=y.element,pv(s,o),Kh(o,f,null,c);var T=o.memoizedState;if(f=T.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){p=Da(Error(t(423)),o),o=tw(s,o,f,c,p);break e}else if(f!==p){p=Da(Error(t(424)),o),o=tw(s,o,f,c,p);break e}else for(Ln=Ks(o.stateNode.containerInfo.firstChild),Vn=o,ot=!0,or=null,c=fv(o,null,f,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(ka(),f===p){o=gs(s,o,c);break e}dn(s,o,f,c)}o=o.child}return o;case 5:return _v(o),s===null&&Pm(o),f=o.type,p=o.pendingProps,y=s!==null?s.memoizedProps:null,T=p.children,Im(f,p)?T=null:y!==null&&Im(f,y)&&(o.flags|=32),Xv(s,o),dn(s,o,T,c),o.child;case 6:return s===null&&Pm(o),null;case 13:return nw(s,o,c);case 4:return Mm(o,o.stateNode.containerInfo),f=o.pendingProps,s===null?o.child=Na(o,null,f,c):dn(s,o,f,c),o.child;case 11:return f=o.type,p=o.pendingProps,p=o.elementType===f?p:ar(f,p),Kv(s,o,f,p,c);case 7:return dn(s,o,o.pendingProps,c),o.child;case 8:return dn(s,o,o.pendingProps.children,c),o.child;case 12:return dn(s,o,o.pendingProps.children,c),o.child;case 10:e:{if(f=o.type._context,p=o.pendingProps,y=o.memoizedProps,T=p.value,Ze($h,f._currentValue),f._currentValue=T,y!==null)if(ir(y.value,T)){if(y.children===p.children&&!vn.current){o=gs(s,o,c);break e}}else for(y=o.child,y!==null&&(y.return=o);y!==null;){var C=y.dependencies;if(C!==null){T=y.child;for(var D=C.firstContext;D!==null;){if(D.context===f){if(y.tag===1){D=ps(-1,c&-c),D.tag=2;var H=y.updateQueue;if(H!==null){H=H.shared;var ne=H.pending;ne===null?D.next=D:(D.next=ne.next,ne.next=D),H.pending=D}}y.lanes|=c,D=y.alternate,D!==null&&(D.lanes|=c),Vm(y.return,c,o),C.lanes|=c;break}D=D.next}}else if(y.tag===10)T=y.type===o.type?null:y.child;else if(y.tag===18){if(T=y.return,T===null)throw Error(t(341));T.lanes|=c,C=T.alternate,C!==null&&(C.lanes|=c),Vm(T,c,o),T=y.sibling}else T=y.child;if(T!==null)T.return=y;else for(T=y;T!==null;){if(T===o){T=null;break}if(y=T.sibling,y!==null){y.return=T.return,T=y;break}T=T.return}y=T}dn(s,o,p.children,c),o=o.child}return o;case 9:return p=o.type,f=o.pendingProps.children,Ra(o,c),p=Kn(p),f=f(p),o.flags|=1,dn(s,o,f,c),o.child;case 14:return f=o.type,p=ar(f,o.pendingProps),p=ar(f.type,p),Qv(s,o,f,p,c);case 15:return Jv(s,o,o.type,o.pendingProps,c);case 17:return f=o.type,p=o.pendingProps,p=o.elementType===f?p:ar(f,p),rd(s,o),o.tag=1,wn(f)?(s=!0,Fh(o)):s=!1,Ra(o,c),Bv(o,f,p),Ym(o,f,p,c),tp(null,o,f,!0,s,c);case 19:return sw(s,o,c);case 22:return Yv(s,o,c)}throw Error(t(156,o.tag))};function kw(s,o){return Jl(s,o)}function fA(s,o,c,f){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(s,o,c,f){return new fA(s,o,c,f)}function Ip(s){return s=s.prototype,!(!s||!s.isReactComponent)}function mA(s){if(typeof s=="function")return Ip(s)?1:0;if(s!=null){if(s=s.$$typeof,s===M)return 11;if(s===Ct)return 14}return 2}function ii(s,o){var c=s.alternate;return c===null?(c=Yn(s.tag,o,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=o,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&14680064,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,o=s.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c}function md(s,o,c,f,p,y){var T=2;if(f=s,typeof s=="function")Ip(s)&&(T=1);else if(typeof s=="string")T=5;else e:switch(s){case P:return ho(c.children,p,y,o);case S:T=8,p|=8;break;case R:return s=Yn(12,c,o,p|2),s.elementType=R,s.lanes=y,s;case k:return s=Yn(13,c,o,p),s.elementType=k,s.lanes=y,s;case be:return s=Yn(19,c,o,p),s.elementType=be,s.lanes=y,s;case Xe:return pd(c,p,y,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case j:T=10;break e;case N:T=9;break e;case M:T=11;break e;case Ct:T=14;break e;case Ft:T=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return o=Yn(T,c,o,p),o.elementType=s,o.type=f,o.lanes=y,o}function ho(s,o,c,f){return s=Yn(7,s,f,o),s.lanes=c,s}function pd(s,o,c,f){return s=Yn(22,s,f,o),s.elementType=Xe,s.lanes=c,s.stateNode={isHidden:!1},s}function Ep(s,o,c){return s=Yn(6,s,null,o),s.lanes=c,s}function Tp(s,o,c){return o=Yn(4,s.children!==null?s.children:[],s.key,o),o.lanes=c,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function pA(s,o,c,f,p){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tc(0),this.expirationTimes=tc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tc(0),this.identifierPrefix=f,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function xp(s,o,c,f,p,y,T,C,D){return s=new pA(s,o,c,C,D),o===1?(o=1,y===!0&&(o|=8)):o=0,y=Yn(3,null,null,o),s.current=y,y.stateNode=s,y.memoizedState={element:f,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},Om(y),s}function gA(s,o,c){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Q,key:f==null?null:""+f,children:s,containerInfo:o,implementation:c}}function Nw(s){if(!s)return Js;s=s._reactInternals;e:{if(rr(s)!==s||s.tag!==1)throw Error(t(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(wn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(s.tag===1){var c=s.type;if(wn(c))return rv(s,c,o)}return o}function Pw(s,o,c,f,p,y,T,C,D){return s=xp(c,f,!0,s,p,y,T,C,D),s.context=Nw(null),c=s.current,f=fn(),p=ri(c),y=ps(f,p),y.callback=o??null,Zs(c,y,p),s.current.lanes=p,Qi(s,p,f),Tn(s,f),s}function gd(s,o,c,f){var p=o.current,y=fn(),T=ri(p);return c=Nw(c),o.context===null?o.context=c:o.pendingContext=c,o=ps(y,T),o.payload={element:s},f=f===void 0?null:f,f!==null&&(o.callback=f),s=Zs(p,o,T),s!==null&&(ur(s,p,T,y),Gh(s,p,T)),T}function yd(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Rw(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<o?c:o}}function Sp(s,o){Rw(s,o),(s=s.alternate)&&Rw(s,o)}function yA(){return null}var bw=typeof reportError=="function"?reportError:function(s){console.error(s)};function Ap(s){this._internalRoot=s}_d.prototype.render=Ap.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(t(409));gd(s,o,null,null)},_d.prototype.unmount=Ap.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;lo(function(){gd(null,s,null,null)}),o[us]=null}};function _d(s){this._internalRoot=s}_d.prototype.unstable_scheduleHydration=function(s){if(s){var o=ic();s={blockedOn:null,target:s,priority:o};for(var c=0;c<Rn.length&&o!==0&&o<Rn[c].priority;c++);Rn.splice(c,0,s),c===0&&ca(s)}};function Cp(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function vd(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Dw(){}function _A(s,o,c,f,p){if(p){if(typeof f=="function"){var y=f;f=function(){var H=yd(T);y.call(H)}}var T=Pw(o,f,s,0,null,!1,!1,"",Dw);return s._reactRootContainer=T,s[us]=T.current,yc(s.nodeType===8?s.parentNode:s),lo(),T}for(;p=s.lastChild;)s.removeChild(p);if(typeof f=="function"){var C=f;f=function(){var H=yd(D);C.call(H)}}var D=xp(s,0,!1,null,null,!1,!1,"",Dw);return s._reactRootContainer=D,s[us]=D.current,yc(s.nodeType===8?s.parentNode:s),lo(function(){gd(o,D,c,f)}),D}function wd(s,o,c,f,p){var y=c._reactRootContainer;if(y){var T=y;if(typeof p=="function"){var C=p;p=function(){var D=yd(T);C.call(D)}}gd(o,T,s,p)}else T=_A(c,o,s,p,f);return yd(T)}rc=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var c=qe(o.pendingLanes);c!==0&&(nc(o,c|1),Tn(o,nt()),(Be&6)===0&&(La=nt()+500,Ys()))}break;case 13:lo(function(){var f=ms(s,1);if(f!==null){var p=fn();ur(f,s,1,p)}}),Sp(s,1)}},aa=function(s){if(s.tag===13){var o=ms(s,134217728);if(o!==null){var c=fn();ur(o,s,134217728,c)}Sp(s,134217728)}},sc=function(s){if(s.tag===13){var o=ri(s),c=ms(s,o);if(c!==null){var f=fn();ur(c,s,o,f)}Sp(s,o)}},ic=function(){return Me},oc=function(s,o){var c=Me;try{return Me=s,o()}finally{Me=c}},es=function(s,o,c){switch(o){case"input":if(Fi(s,c),o=c.name,c.type==="radio"&&o!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var f=c[o];if(f!==s&&f.form===s.form){var p=Oh(f);if(!p)throw Error(t(90));Bl(f),Fi(f,p)}}}break;case"textarea":lh(s,c);break;case"select":o=c.value,o!=null&&tr(s,!!c.multiple,o,!1)}},hh=_p,dh=lo;var vA={usingClientEntryPoint:!1,Events:[wc,Ta,Oh,Os,Ms,_p]},jc={findFiberByHostInstance:eo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wA={bundleType:jc.bundleType,version:jc.version,rendererPackageName:jc.rendererPackageName,rendererConfig:jc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Y.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=vh(s),s===null?null:s.stateNode},findFiberByHostInstance:jc.findFiberByHostInstance||yA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Id.isDisabled&&Id.supportsFiber)try{$i=Id.inject(wA),Nn=Id}catch{}}return xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vA,xn.createPortal=function(s,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cp(o))throw Error(t(200));return gA(s,o,null,c)},xn.createRoot=function(s,o){if(!Cp(s))throw Error(t(299));var c=!1,f="",p=bw;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onRecoverableError!==void 0&&(p=o.onRecoverableError)),o=xp(s,1,!1,null,null,c,!1,f,p),s[us]=o.current,yc(s.nodeType===8?s.parentNode:s),new Ap(o)},xn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=vh(o),s=s===null?null:s.stateNode,s},xn.flushSync=function(s){return lo(s)},xn.hydrate=function(s,o,c){if(!vd(o))throw Error(t(200));return wd(null,s,o,!0,c)},xn.hydrateRoot=function(s,o,c){if(!Cp(s))throw Error(t(405));var f=c!=null&&c.hydratedSources||null,p=!1,y="",T=bw;if(c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(T=c.onRecoverableError)),o=Pw(o,null,s,1,c??null,p,!1,y,T),s[us]=o.current,yc(s),f)for(s=0;s<f.length;s++)c=f[s],p=c._getVersion,p=p(c._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[c,p]:o.mutableSourceEagerHydrationData.push(c,p);return new _d(o)},xn.render=function(s,o,c){if(!vd(o))throw Error(t(200));return wd(null,s,o,!1,c)},xn.unmountComponentAtNode=function(s){if(!vd(s))throw Error(t(40));return s._reactRootContainer?(lo(function(){wd(null,null,s,!1,function(){s._reactRootContainer=null,s[us]=null})}),!0):!1},xn.unstable_batchedUpdates=_p,xn.unstable_renderSubtreeIntoContainer=function(s,o,c,f){if(!vd(c))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return wd(s,o,c,!1,f)},xn.version="18.3.1-next-f1338f8080-20240426",xn}var Bw;function ZI(){if(Bw)return Pp.exports;Bw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Pp.exports=CA(),Pp.exports}var zw;function kA(){if(zw)return Ed;zw=1;var n=ZI();return Ed.createRoot=n.createRoot,Ed.hydrateRoot=n.hydrateRoot,Ed}var NA=kA();const PA=XI(NA),RA=()=>{};var Ww={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},bA=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=n[t++];e[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=n[t++],l=n[t++],d=n[t++],m=((i&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(m>>10)),e[r++]=String.fromCharCode(56320+(m&1023))}else{const a=n[t++],l=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|l&63)}}return e.join("")},tE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const a=n[i],l=i+1<n.length,d=l?n[i+1]:0,m=i+2<n.length,g=m?n[i+2]:0,v=a>>2,I=(a&3)<<4|d>>4;let E=(d&15)<<2|g>>6,A=g&63;m||(A=64,l||(E=64)),r.push(t[v],t[I],t[E],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(eE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):bA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const a=t[n.charAt(i++)],d=i<n.length?t[n.charAt(i)]:0;++i;const g=i<n.length?t[n.charAt(i)]:64;++i;const I=i<n.length?t[n.charAt(i)]:64;if(++i,a==null||d==null||g==null||I==null)throw new DA;const E=a<<2|d>>4;if(r.push(E),g!==64){const A=d<<4&240|g>>2;if(r.push(A),I!==64){const O=g<<6&192|I;r.push(O)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class DA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jA=function(n){const e=eE(n);return tE.encodeByteArray(e,!0)},Hd=function(n){return jA(n).replace(/\./g,"")},Bg=function(n){try{return tE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Gd(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!VA(t)||(n[t]=Gd(n[t],e[t]));return n}function VA(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA=()=>zg().__FIREBASE_DEFAULTS__,OA=()=>{if(typeof process>"u"||typeof Ww>"u")return;const n=Ww.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},MA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Bg(n[1]);return e&&JSON.parse(e)},Wg=()=>{try{return RA()||LA()||OA()||MA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},qg=()=>{var n;return(n=Wg())==null?void 0:n.config},FA=n=>{var e;return(e=Wg())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function nE(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BA(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Hd(JSON.stringify(t)),Hd(JSON.stringify(l)),""].join(".")}const eu={};function zA(){const n={prod:[],emulator:[]};for(const e of Object.keys(eu))eu[e]?n.emulator.push(e):n.prod.push(e);return n}function WA(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let qw=!1;function rE(n,e){if(typeof window>"u"||typeof document>"u"||!Cl(window.location.host)||eu[n]===e||eu[n]||qw)return;eu[n]=e;function t(E){return`__firebase__banner__${E}`}const r="__firebase__banner",a=zA().prod.length>0;function l(){const E=document.getElementById(r);E&&E.remove()}function d(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function m(E,A){E.setAttribute("width","24"),E.setAttribute("id",A),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function g(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{qw=!0,l()},E}function v(E,A){E.setAttribute("id",A),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function I(){const E=WA(r),A=t("text"),O=document.getElementById(A)||document.createElement("span"),U=t("learnmore"),L=document.getElementById(U)||document.createElement("a"),oe=t("preprendIcon"),J=document.getElementById(oe)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const W=E.element;d(W),v(L,U);const Y=g();m(J,oe),W.append(J,O,L,Y),document.body.appendChild(W)}a?(O.innerText="Preview backend disconnected.",J.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(J.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,O.innerText="Preview backend running in this workspace."),O.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",I):I()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mt())}function wf(){var e;const n=(e=Wg())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $A(){return typeof window<"u"||sE()}function sE(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function HA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function iE(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function $g(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oE(){const n=mt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function aE(){return!wf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function lE(){return!wf()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function pu(){try{return typeof indexedDB=="object"}catch{return!1}}function GA(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var a;e(((a=i.error)==null?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA="FirebaseError";class gn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=KA,Object.setPrototypeOf(this,gn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qo.prototype.create)}}class qo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],l=a?QA(a,r):"Error",d=`${this.serviceName}: ${l} (${i}).`;return new gn(i,d,r)}}function QA(n,e){return n.replace(JA,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const JA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function YA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ii(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const a=n[i],l=e[i];if(Hw(a)&&Hw(l)){if(!Ii(a,l))return!1}else if(a!==l)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function Hw(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ja(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,a]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Hc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function cE(n,e){const t=new XA(n,e);return t.subscribe.bind(t)}class XA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");ZA(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Dp),i.error===void 0&&(i.error=Dp),i.complete===void 0&&(i.complete=Dp);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Dp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(n){return n&&n._delegate?n._delegate:n}class Kr{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new UA;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(nC(e))try{this.getOrInitializeService({instanceIdentifier:mo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});r.resolve(a)}catch{}}}}clearInstance(e=mo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mo){return this.instances.has(e)}getOptions(e=mo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&l.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:tC(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=mo){return this.component?this.component.multipleInstances?e:mo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tC(n){return n===mo?void 0:n}function nC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new eC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg=[];var De;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(De||(De={}));const hE={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},rC=De.INFO,sC={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},iC=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=sC[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class If{constructor(e){this.name=e,this._logLevel=rC,this._logHandler=iC,this._userLogHandler=null,Hg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}function oC(n){Hg.forEach(e=>{e.setLogLevel(n)})}function aC(n,e){for(const t of Hg){let r=null;e&&e.level&&(r=hE[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,a,...l)=>{const d=l.map(m=>{if(m==null)return null;if(typeof m=="string")return m;if(typeof m=="number"||typeof m=="boolean")return m.toString();if(m instanceof Error)return m.message;try{return JSON.stringify(m)}catch{return null}}).filter(m=>m).join(" ");a>=(r??i.logLevel)&&n({level:De[a].toLowerCase(),message:d,args:l,type:i.name})}}}const lC=(n,e)=>e.some(t=>n instanceof t);let Gw,Kw;function cC(){return Gw||(Gw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uC(){return Kw||(Kw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dE=new WeakMap,Zp=new WeakMap,fE=new WeakMap,jp=new WeakMap,Gg=new WeakMap;function hC(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(gi(n.result)),i()},l=()=>{r(n.error),i()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&dE.set(t,n)}).catch(()=>{}),Gg.set(e,n),e}function dC(n){if(Zp.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),i()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Zp.set(n,e)}let eg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Zp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return gi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function fC(n){eg=n(eg)}function mC(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Vp(this),e,...t);return fE.set(r,e.sort?e.sort():[e]),gi(r)}:uC().includes(n)?function(...e){return n.apply(Vp(this),e),gi(dE.get(this))}:function(...e){return gi(n.apply(Vp(this),e))}}function pC(n){return typeof n=="function"?mC(n):(n instanceof IDBTransaction&&dC(n),lC(n,cC())?new Proxy(n,eg):n)}function gi(n){if(n instanceof IDBRequest)return hC(n);if(jp.has(n))return jp.get(n);const e=pC(n);return e!==n&&(jp.set(n,e),Gg.set(e,n)),e}const Vp=n=>Gg.get(n);function gC(n,e,{blocked:t,upgrade:r,blocking:i,terminated:a}={}){const l=indexedDB.open(n,e),d=gi(l);return r&&l.addEventListener("upgradeneeded",m=>{r(gi(l.result),m.oldVersion,m.newVersion,gi(l.transaction),m)}),t&&l.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),d.then(m=>{a&&m.addEventListener("close",()=>a()),i&&m.addEventListener("versionchange",g=>i(g.oldVersion,g.newVersion,g))}).catch(()=>{}),d}const yC=["get","getKey","getAll","getAllKeys","count"],_C=["put","add","delete","clear"],Lp=new Map;function Qw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Lp.get(e))return Lp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=_C.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||yC.includes(t)))return;const a=async function(l,...d){const m=this.transaction(l,i?"readwrite":"readonly");let g=m.store;return r&&(g=g.index(d.shift())),(await Promise.all([g[t](...d),i&&m.done]))[0]};return Lp.set(e,a),a}fC(n=>({...n,get:(e,t,r)=>Qw(e,t)||n.get(e,t,r),has:(e,t)=>!!Qw(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wC(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function wC(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Kd="@firebase/app",tg="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=new If("@firebase/app"),IC="@firebase/app-compat",EC="@firebase/analytics-compat",TC="@firebase/analytics",xC="@firebase/app-check-compat",SC="@firebase/app-check",AC="@firebase/auth",CC="@firebase/auth-compat",kC="@firebase/database",NC="@firebase/data-connect",PC="@firebase/database-compat",RC="@firebase/functions",bC="@firebase/functions-compat",DC="@firebase/installations",jC="@firebase/installations-compat",VC="@firebase/messaging",LC="@firebase/messaging-compat",OC="@firebase/performance",MC="@firebase/performance-compat",FC="@firebase/remote-config",UC="@firebase/remote-config-compat",BC="@firebase/storage",zC="@firebase/storage-compat",WC="@firebase/firestore",qC="@firebase/ai",$C="@firebase/firestore-compat",HC="firebase",GC="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei="[DEFAULT]",KC={[Kd]:"fire-core",[IC]:"fire-core-compat",[TC]:"fire-analytics",[EC]:"fire-analytics-compat",[SC]:"fire-app-check",[xC]:"fire-app-check-compat",[AC]:"fire-auth",[CC]:"fire-auth-compat",[kC]:"fire-rtdb",[NC]:"fire-data-connect",[PC]:"fire-rtdb-compat",[RC]:"fire-fn",[bC]:"fire-fn-compat",[DC]:"fire-iid",[jC]:"fire-iid-compat",[VC]:"fire-fcm",[LC]:"fire-fcm-compat",[OC]:"fire-perf",[MC]:"fire-perf-compat",[FC]:"fire-rc",[UC]:"fire-rc-compat",[BC]:"fire-gcs",[zC]:"fire-gcs-compat",[WC]:"fire-fst",[$C]:"fire-fst-compat",[qC]:"fire-vertex","fire-js":"fire-js",[HC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti=new Map,sl=new Map,il=new Map;function gu(n,e){try{n.container.addComponent(e)}catch(t){Is.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function mE(n,e){n.container.addOrOverwriteComponent(e)}function xi(n){const e=n.name;if(il.has(e))return Is.debug(`There were multiple attempts to register component ${e}.`),!1;il.set(e,n);for(const t of Ti.values())gu(t,n);for(const t of sl.values())gu(t,n);return!0}function pE(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function QC(n,e,t=Ei){pE(n,e).clearInstance(t)}function Kg(n){return n.options!==void 0}function gE(n){return Kg(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function lt(n){return n==null?!1:n.settings!==void 0}function JC(){il.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zn=new qo("app","Firebase",YC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yE=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Kr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jw(n,e){const t=Bg(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,a=new Date().getTime();i-a<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class XC extends yE{constructor(e,t,r,i){const a=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,l={name:r,automaticDataCollectionEnabled:a};if(e.apiKey!==void 0)super(e,l,i);else{const d=e;super(d.options,l,i)}this._serverConfig={automaticDataCollectionEnabled:a,...t},this._serverConfig.authIdToken&&Jw(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&Jw(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,fr(Kd,tg,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Jg(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw zn.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi=GC;function Qg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ei,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw zn.create("bad-app-name",{appName:String(i)});if(t||(t=qg()),!t)throw zn.create("no-options");const a=Ti.get(i);if(a){if(Ii(t,a.options)&&Ii(r,a.config))return a;throw zn.create("duplicate-app",{appName:i})}const l=new uE(i);for(const m of il.values())l.addComponent(m);const d=new yE(t,r,l);return Ti.set(i,d),d}function ZC(n,e={}){if($A()&&!sE())throw zn.create("invalid-server-app-environment");let t,r=e||{};if(n&&(Kg(n)?t=n.options:gE(n)?r=n:t=n),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=qg()),!t)throw zn.create("no-options");const i={...r,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const a=v=>[...v].reduce((I,E)=>Math.imul(31,I)+E.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw zn.create("finalization-registry-not-supported",{});const l=""+a(JSON.stringify(i)),d=sl.get(l);if(d)return d.incRefCount(r.releaseOnDeref),d;const m=new uE(l);for(const v of il.values())m.addComponent(v);const g=new XC(t,r,l,m);return sl.set(l,g),g}function ek(n=Ei){const e=Ti.get(n);if(!e&&n===Ei&&qg())return Qg();if(!e)throw zn.create("no-app",{appName:n});return e}function tk(){return Array.from(Ti.values())}async function Jg(n){let e=!1;const t=n.name;Ti.has(t)?(e=!0,Ti.delete(t)):sl.has(t)&&n.decRefCount()<=0&&(sl.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function fr(n,e,t){let r=KC[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${r}" with version "${e}":`];i&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Is.warn(l.join(" "));return}xi(new Kr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function _E(n,e){if(n!==null&&typeof n!="function")throw zn.create("invalid-log-argument");aC(n,e)}function vE(n){oC(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nk="firebase-heartbeat-database",rk=1,yu="firebase-heartbeat-store";let Op=null;function wE(){return Op||(Op=gC(nk,rk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(yu)}catch(t){console.warn(t)}}}}).catch(n=>{throw zn.create("idb-open",{originalErrorMessage:n.message})})),Op}async function sk(n){try{const t=(await wE()).transaction(yu),r=await t.objectStore(yu).get(IE(n));return await t.done,r}catch(e){if(e instanceof gn)Is.warn(e.message);else{const t=zn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Is.warn(t.message)}}}async function Yw(n,e){try{const r=(await wE()).transaction(yu,"readwrite");await r.objectStore(yu).put(e,IE(n)),await r.done}catch(t){if(t instanceof gn)Is.warn(t.message);else{const r=zn.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Is.warn(r.message)}}}function IE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik=1024,ok=30;class ak{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ck(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Xw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>ok){const l=uk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Is.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Xw(),{heartbeatsToSend:r,unsentEntries:i}=lk(this._heartbeatsCache.heartbeats),a=Hd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Is.warn(t),""}}}function Xw(){return new Date().toISOString().substring(0,10)}function lk(n,e=ik){const t=[];let r=n.slice();for(const i of n){const a=t.find(l=>l.agent===i.agent);if(a){if(a.dates.push(i.date),Zw(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Zw(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class ck{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pu()?GA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await sk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Yw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Yw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Zw(n){return Hd(JSON.stringify({version:2,heartbeats:n})).length}function uk(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(n){xi(new Kr("platform-logger",e=>new vC(e),"PRIVATE")),xi(new Kr("heartbeat",e=>new ak(e),"PRIVATE")),fr(Kd,tg,n),fr(Kd,tg,"esm2020"),fr("fire-js","")}hk("");const dk=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:gn,SDK_VERSION:bi,_DEFAULT_ENTRY_NAME:Ei,_addComponent:gu,_addOrOverwriteComponent:mE,_apps:Ti,_clearComponents:JC,_components:il,_getProvider:pE,_isFirebaseApp:Kg,_isFirebaseServerApp:lt,_isFirebaseServerAppSettings:gE,_registerComponent:xi,_removeServiceInstance:QC,_serverApps:sl,deleteApp:Jg,getApp:ek,getApps:tk,initializeApp:Qg,initializeServerApp:ZC,onLog:_E,registerVersion:fr,setLogLevel:vE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,t){this._delegate=e,this.firebase=t,gu(e,new Kr("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Jg(this._delegate)))}_getService(e,t=Ei){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())==null?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Ei){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){gu(this._delegate,e)}_addOrOverwriteComponent(e){mE(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},e0=new qo("app-compat","Firebase",mk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(n){const e={},t={__esModule:!0,initializeApp:a,app:i,registerVersion:fr,setLogLevel:vE,onLog:_E,apps:null,SDK_VERSION:bi,INTERNAL:{registerComponent:d,removeApp:r,useAsService:m,modularAPIs:dk}};t.default=t,Object.defineProperty(t,"apps",{get:l});function r(g){delete e[g]}function i(g){if(g=g||Ei,!$w(e,g))throw e0.create("no-app",{appName:g});return e[g]}i.App=n;function a(g,v={}){const I=Qg(g,v);if($w(e,I.name))return e[I.name];const E=new n(I,t);return e[I.name]=E,E}function l(){return Object.keys(e).map(g=>e[g])}function d(g){const v=g.name,I=v.replace("-compat","");if(xi(g)&&g.type==="PUBLIC"){const E=(A=i())=>{if(typeof A[I]!="function")throw e0.create("invalid-app-argument",{appName:v});return A[I]()};g.serviceProps!==void 0&&Gd(E,g.serviceProps),t[I]=E,n.prototype[I]=function(...A){return this._getService.bind(this,v).apply(this,g.multipleInstances?A:[])}}return g.type==="PUBLIC"?t[I]:null}function m(g,v){return v==="serverAuth"?null:v}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(){const n=pk(fk);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:EE,extendNamespace:e,createSubscribe:cE,ErrorFactory:qo,deepExtend:Gd};function e(t){Gd(n,t)}return n}const gk=EE();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=new If("@firebase/app-compat"),yk="@firebase/app-compat",_k="0.5.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(n){fr(yk,_k,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=zg();if(n.firebase!==void 0){t0.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&t0.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Lt=gk;vk();var wk="firebase",Ik="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Lt.registerVersion(wk,Ik,"app-compat");const Lc={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Ma={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function TE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Tk=Ek,xk=TE,xE=new qo("auth","Firebase",TE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd=new If("@firebase/auth");function Sk(n,...e){Qd.logLevel<=De.WARN&&Qd.warn(`Auth (${bi}): ${n}`,...e)}function Rd(n,...e){Qd.logLevel<=De.ERROR&&Qd.error(`Auth (${bi}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(n,...e){throw Xg(n,...e)}function Ot(n,...e){return Xg(n,...e)}function Yg(n,e,t){const r={...xk(),[e]:t};return new qo("auth","Firebase",r).create(e,{appName:n.name})}function $t(n){return Yg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Nl(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Zt(n,"argument-error"),Yg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xg(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return xE.create(n,...e)}function re(n,e,...t){if(!n)throw Xg(e,...t)}function Wr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Rd(e),new Error(e)}function yr(n,e){n||Wr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Zg(){return n0()==="http:"||n0()==="https:"}function n0(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Zg()||iE()||"connection"in navigator)?navigator.onLine:!0}function Ck(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,t){this.shortDelay=e,this.longDelay=t,yr(t>e,"Short delay should be less than long delay!"),this.isMobile=qA()||$g()}get(){return Ak()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(n,e){yr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Pk=new Fu(3e4,6e4);function vt(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function wt(n,e,t,r,i={}){return AE(n,i,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const d=kl({key:n.config.apiKey,...l}).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const g={method:e,headers:m,...a};return HA()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Cl(n.emulatorConfig.host)&&(g.credentials="include"),SE.fetch()(await CE(n,n.config.apiHost,t,d),g)})}async function AE(n,e,t){n._canInitEmulator=!1;const r={...kk,...e};try{const i=new bk(n),a=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Gc(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[m,g]=d.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw Gc(n,"credential-already-in-use",l);if(m==="EMAIL_EXISTS")throw Gc(n,"email-already-in-use",l);if(m==="USER_DISABLED")throw Gc(n,"user-disabled",l);const v=r[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw Yg(n,v,g);Zt(n,v)}}catch(i){if(i instanceof gn)throw i;Zt(n,"network-request-failed",{message:String(i)})}}async function Ss(n,e,t,r,i={}){const a=await wt(n,e,t,r,i);return"mfaPendingCredential"in a&&Zt(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function CE(n,e,t,r){const i=`${e}${t}?${r}`,a=n,l=a.config.emulator?ey(n.config,i):`${n.config.apiScheme}://${i}`;return Nk.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function Rk(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class bk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ot(this.auth,"network-request-failed")),Pk.get())})}}function Gc(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Ot(n,e,r);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(n){return n!==void 0&&n.getResponse!==void 0}function s0(n){return n!==void 0&&n.enterprise!==void 0}class kE{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Rk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dk(n){return(await wt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function NE(n,e){return wt(n,"GET","/v2/recaptchaConfig",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jk(n,e){return wt(n,"POST","/v1/accounts:delete",e)}async function Vk(n,e){return wt(n,"POST","/v1/accounts:update",e)}async function Jd(n,e){return wt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Lk(n,e=!1){const t=xe(n),r=await t.getIdToken(e),i=Ef(r);re(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:i,token:r,authTime:tu(Mp(i.auth_time)),issuedAtTime:tu(Mp(i.iat)),expirationTime:tu(Mp(i.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Mp(n){return Number(n)*1e3}function Ef(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Rd("JWT malformed, contained fewer than 3 sections"),null;try{const i=Bg(t);return i?JSON.parse(i):(Rd("Failed to decode base64 JWT payload"),null)}catch(i){return Rd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function i0(n){const e=Ef(n);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Es(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof gn&&Ok(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Ok({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=tu(this.lastLoginAt),this.creationTime=tu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vu(n){var I;const e=n.auth,t=await n.getIdToken(),r=await Es(n,Jd(e,{idToken:t}));re(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const a=(I=i.providerUserInfo)!=null&&I.length?PE(i.providerUserInfo):[],l=Uk(n.providerData,a),d=n.isAnonymous,m=!(n.email&&i.passwordHash)&&!(l!=null&&l.length),g=d?m:!1,v={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new ng(i.createdAt,i.lastLoginAt),isAnonymous:g};Object.assign(n,v)}async function Fk(n){const e=xe(n);await vu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Uk(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function PE(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bk(n,e){const t=await AE(n,{},async()=>{const r=kl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=n.config,l=await CE(n,i,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:d,body:r};return n.emulatorConfig&&Cl(n.emulatorConfig.host)&&(m.credentials="include"),SE.fetch()(l,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function zk(n,e){return wt(n,"POST","/v2/accounts:revokeToken",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):i0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){re(e.length!==0,"internal-error");const t=i0(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:a}=await Bk(e,t);this.updateTokensAndExpiration(r,i,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:a}=t,l=new Ya;return r&&(re(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),i&&(re(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),a&&(re(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ya,this.toJSON())}_performRefresh(){return Wr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(n,e){re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class dr{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Mk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ng(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Es(this,this.stsTokenManager.getToken(this.auth,e));return re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Lk(this,e)}reload(){return Fk(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new dr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await vu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(lt(this.auth.app))return Promise.reject($t(this.auth));const e=await this.getIdToken();return await Es(this,jk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,d=t.tenantId??void 0,m=t._redirectEventId??void 0,g=t.createdAt??void 0,v=t.lastLoginAt??void 0,{uid:I,emailVerified:E,isAnonymous:A,providerData:O,stsTokenManager:U}=t;re(I&&U,e,"internal-error");const L=Ya.fromJSON(this.name,U);re(typeof I=="string",e,"internal-error"),ai(r,e.name),ai(i,e.name),re(typeof E=="boolean",e,"internal-error"),re(typeof A=="boolean",e,"internal-error"),ai(a,e.name),ai(l,e.name),ai(d,e.name),ai(m,e.name),ai(g,e.name),ai(v,e.name);const oe=new dr({uid:I,auth:e,email:i,emailVerified:E,displayName:r,isAnonymous:A,photoURL:l,phoneNumber:a,tenantId:d,stsTokenManager:L,createdAt:g,lastLoginAt:v});return O&&Array.isArray(O)&&(oe.providerData=O.map(J=>({...J}))),m&&(oe._redirectEventId=m),oe}static async _fromIdTokenResponse(e,t,r=!1){const i=new Ya;i.updateFromServerResponse(t);const a=new dr({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await vu(a),a}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];re(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?PE(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),d=new Ya;d.updateFromIdToken(r);const m=new dr({uid:i.localId,auth:e,stsTokenManager:d,isAnonymous:l}),g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new ng(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(m,g),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0=new Map;function Bn(n){yr(n instanceof Function,"Expected a class definition");let e=o0.get(n);return e?(yr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,o0.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}RE.type="NONE";const ol=RE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Co(n,e,t){return`firebase:${n}:${e}:${t}`}class Xa{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:a}=this.auth;this.fullUserKey=Co(this.userKey,i.apiKey,a),this.fullPersistenceKey=Co("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Jd(this.auth,{idToken:e}).catch(()=>{});return t?dr._fromGetAccountInfoResponse(this.auth,t,e):null}return dr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Xa(Bn(ol),e,r);const i=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let a=i[0]||Bn(ol);const l=Co(r,e.config.apiKey,e.name);let d=null;for(const g of t)try{const v=await g._get(l);if(v){let I;if(typeof v=="string"){const E=await Jd(e,{idToken:v}).catch(()=>{});if(!E)break;I=await dr._fromGetAccountInfoResponse(e,E,v)}else I=dr._fromJSON(e,v);g!==a&&(d=I),a=g;break}}catch{}const m=i.filter(g=>g._shouldAllowMigration);return!a._shouldAllowMigration||!m.length?new Xa(a,e,r):(a=m[0],d&&await a._set(l,d.toJSON()),await Promise.all(t.map(async g=>{if(g!==a)try{await g._remove(l)}catch{}})),new Xa(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(LE(e))return"Blackberry";if(OE(e))return"Webos";if(DE(e))return"Safari";if((e.includes("chrome/")||jE(e))&&!e.includes("edge/"))return"Chrome";if(Uu(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function bE(n=mt()){return/firefox\//i.test(n)}function DE(n=mt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function jE(n=mt()){return/crios\//i.test(n)}function VE(n=mt()){return/iemobile/i.test(n)}function Uu(n=mt()){return/android/i.test(n)}function LE(n=mt()){return/blackberry/i.test(n)}function OE(n=mt()){return/webos/i.test(n)}function Bu(n=mt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Wk(n=mt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function qk(n=mt()){var e;return Bu(n)&&!!((e=window.navigator)!=null&&e.standalone)}function $k(){return oE()&&document.documentMode===10}function ME(n=mt()){return Bu(n)||Uu(n)||OE(n)||LE(n)||/windows phone/i.test(n)||VE(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(n,e=[]){let t;switch(n){case"Browser":t=a0(mt());break;case"Worker":t=`${a0(mt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((l,d)=>{try{const m=e(a);l(m)}catch(m){d(m)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gk(n,e={}){return wt(n,"GET","/v2/passwordPolicy",vt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk=6;class Qk{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Kk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new l0(this),this.idTokenSubscription=new l0(this),this.beforeStateQueue=new Hk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Bn(t)),this._initializationPromise=this.queue(async()=>{var r,i,a;if(!this._deleted&&(this.persistenceManager=await Xa.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Jd(this,{idToken:e}),r=await dr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(lt(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(a=this.redirectUser)==null?void 0:a._redirectEventId,d=r==null?void 0:r._redirectEventId,m=await this.tryRedirectSignIn(e);(!l||l===d)&&(m!=null&&m.user)&&(r=m.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await vu(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Ck()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(lt(this.app))return Promise.reject($t(this));const t=e?xe(e):null;return t&&re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return lt(this.app)?Promise.reject($t(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return lt(this.app)?Promise.reject($t(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Bn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Gk(this),t=new Qk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await zk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Bn(e)||this._popupRedirectResolver;re(t,this,"argument-error"),this.redirectPersistenceManager=await Xa.create(this,[Bn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,r,i);return()=>{l=!0,m()}}else{const m=e.addObserver(t);return()=>{l=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=FE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(lt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&Sk(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function pt(n){return xe(n)}class l0{constructor(e){this.auth=e,this.observer=null,this.addObserver=cE(t=>this.observer=t)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Yk(n){zu=n}function ty(n){return zu.loadJS(n)}function Xk(){return zu.recaptchaV2Script}function Zk(){return zu.recaptchaEnterpriseScript}function e2(){return zu.gapiScript}function UE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2=500,n2=6e4,Td=1e12;class r2{constructor(e){this.auth=e,this.counter=Td,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new o2(e,this.auth.name,t||{})),this.counter++,r}reset(e){var r;const t=e||Td;(r=this._widgets.get(t))==null||r.delete(),this._widgets.delete(t)}getResponse(e){var r;const t=e||Td;return((r=this._widgets.get(t))==null?void 0:r.getResponse())||""}async execute(e){var r;const t=e||Td;return(r=this._widgets.get(t))==null||r.execute(),""}}class s2{constructor(){this.enterprise=new i2}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class i2{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class o2{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;re(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=a2(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},n2)},t2))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function a2(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const l2="recaptcha-enterprise",nu="NO_RECAPTCHA";class BE{constructor(e){this.type=l2,this.auth=pt(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,d)=>{NE(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const g=new kE(m);return a.tenantId==null?a._agentRecaptchaConfig=g:a._tenantRecaptchaConfigs[a.tenantId]=g,l(g.siteKey)}}).catch(m=>{d(m)})})}function i(a,l,d){const m=window.grecaptcha;s0(m)?m.enterprise.ready(()=>{m.enterprise.execute(a,{action:e}).then(g=>{l(g)}).catch(()=>{l(nu)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new s2().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{r(this.auth).then(d=>{if(!t&&s0(window.grecaptcha))i(d,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let m=Zk();m.length!==0&&(m+=d),ty(m).then(()=>{i(d,a,l)}).catch(g=>{l(g)})}}).catch(d=>{l(d)})})}}async function Oc(n,e,t,r=!1,i=!1){const a=new BE(n);let l;if(i)l=nu;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const m=d.phoneEnrollmentInfo.phoneNumber,g=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:g,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const m=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return r?Object.assign(d,{captchaResp:l}):Object.assign(d,{captchaResponse:l}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function yi(n,e,t,r,i){var a,l;if(i==="EMAIL_PASSWORD_PROVIDER")if((a=n._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Oc(n,e,t,t==="getOobCode");return r(n,d)}else return r(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const m=await Oc(n,e,t,t==="getOobCode");return r(n,m)}else return Promise.reject(d)});else if(i==="PHONE_PROVIDER")if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("PHONE_PROVIDER")){const d=await Oc(n,e,t);return r(n,d).catch(async m=>{var g;if(((g=n._getRecaptchaConfig())==null?void 0:g.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(m.code==="auth/missing-recaptcha-token"||m.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const v=await Oc(n,e,t,!1,!0);return r(n,v)}return Promise.reject(m)})}else{const d=await Oc(n,e,t,!1,!0);return r(n,d)}else return Promise.reject(i+" provider is not supported.")}async function c2(n){const e=pt(n),t=await NE(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new kE(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new BE(e).verify()}function u2(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Bn);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function h2(n,e,t){const r=pt(n);re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(t!=null&&t.disableWarnings),a=zE(e),{host:l,port:d}=d2(e),m=d===null?"":`:${d}`,g={url:`${a}//${l}${m}/`},v=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){re(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),re(Ii(g,r.config.emulator)&&Ii(v,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=g,r.emulatorConfig=v,r.settings.appVerificationDisabledForTesting=!0,Cl(l)?(nE(`${a}//${l}${m}`),rE("Auth",!0)):i||f2()}function zE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function d2(n){const e=zE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const a=i[1];return{host:a,port:c0(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:c0(l)}}}function c0(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function f2(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wr("not implemented")}_getIdTokenResponse(e){return Wr("not implemented")}_linkToIdToken(e,t){return Wr("not implemented")}_getReauthenticationResolver(e){return Wr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WE(n,e){return wt(n,"POST","/v1/accounts:resetPassword",vt(n,e))}async function m2(n,e){return wt(n,"POST","/v1/accounts:update",e)}async function p2(n,e){return wt(n,"POST","/v1/accounts:signUp",e)}async function g2(n,e){return wt(n,"POST","/v1/accounts:update",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y2(n,e){return Ss(n,"POST","/v1/accounts:signInWithPassword",vt(n,e))}async function Tf(n,e){return wt(n,"POST","/v1/accounts:sendOobCode",vt(n,e))}async function _2(n,e){return Tf(n,e)}async function v2(n,e){return Tf(n,e)}async function w2(n,e){return Tf(n,e)}async function I2(n,e){return Tf(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E2(n,e){return Ss(n,"POST","/v1/accounts:signInWithEmailLink",vt(n,e))}async function T2(n,e){return Ss(n,"POST","/v1/accounts:signInWithEmailLink",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends Pl{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new wu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new wu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return yi(e,t,"signInWithPassword",y2,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return E2(e,{email:this._email,oobCode:this._password});default:Zt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return yi(e,r,"signUpPassword",p2,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return T2(e,{idToken:t,email:this._email,oobCode:this._password});default:Zt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ws(n,e){return Ss(n,"POST","/v1/accounts:signInWithIdp",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2="http://localhost";class Qr extends Pl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Zt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...a}=t;if(!r||!i)return null;const l=new Qr(r,i);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return ws(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ws(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ws(e,t)}buildRequest(){const e={requestUri:x2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=kl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u0(n,e){return wt(n,"POST","/v1/accounts:sendVerificationCode",vt(n,e))}async function S2(n,e){return Ss(n,"POST","/v1/accounts:signInWithPhoneNumber",vt(n,e))}async function A2(n,e){const t=await Ss(n,"POST","/v1/accounts:signInWithPhoneNumber",vt(n,e));if(t.temporaryProof)throw Gc(n,"account-exists-with-different-credential",t);return t}const C2={USER_NOT_FOUND:"user-not-found"};async function k2(n,e){const t={...e,operation:"REAUTH"};return Ss(n,"POST","/v1/accounts:signInWithPhoneNumber",vt(n,t),C2)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko extends Pl{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ko({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ko({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return S2(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return A2(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return k2(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:a}=e;return!r&&!t&&!i&&!a?null:new ko({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N2(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function P2(n){const e=Ja(Hc(n)).link,t=e?Ja(Hc(e)).deep_link_id:null,r=Ja(Hc(n)).deep_link_id;return(r?Ja(Hc(r)).link:null)||r||t||e||n}class xf{constructor(e){const t=Ja(Hc(e)),r=t.apiKey??null,i=t.oobCode??null,a=N2(t.mode??null);re(r&&i&&a,"argument-error"),this.apiKey=r,this.operation=a,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=P2(e);try{return new xf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(){this.providerId=Di.PROVIDER_ID}static credential(e,t){return wu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=xf.parseLink(t);return re(r,"argument-error"),wu._fromEmailAndCode(e,r.code,r.tenantId)}}Di.PROVIDER_ID="password";Di.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Di.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl extends As{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Za extends Rl{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return re("providerId"in t&&"signInMethod"in t,"argument-error"),Qr._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return re(e.idToken||e.accessToken,"argument-error"),Qr._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Za.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Za.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:a,nonce:l,providerId:d}=e;if(!r&&!i&&!t&&!a||!d)return null;try{return new Za(d)._credential({idToken:t,accessToken:r,nonce:l,pendingToken:a})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr extends Rl{constructor(){super("facebook.com")}static credential(e){return Qr._fromParams({providerId:Fr.PROVIDER_ID,signInMethod:Fr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fr.credentialFromTaggedObject(e)}static credentialFromError(e){return Fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fr.credential(e.oauthAccessToken)}catch{return null}}}Fr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur extends Rl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qr._fromParams({providerId:Ur.PROVIDER_ID,signInMethod:Ur.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ur.credentialFromTaggedObject(e)}static credentialFromError(e){return Ur.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ur.credential(t,r)}catch{return null}}}Ur.GOOGLE_SIGN_IN_METHOD="google.com";Ur.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br extends Rl{constructor(){super("github.com")}static credential(e){return Qr._fromParams({providerId:Br.PROVIDER_ID,signInMethod:Br.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Br.credentialFromTaggedObject(e)}static credentialFromError(e){return Br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Br.credential(e.oauthAccessToken)}catch{return null}}}Br.GITHUB_SIGN_IN_METHOD="github.com";Br.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2="http://localhost";class al extends Pl{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return ws(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ws(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ws(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:a}=t;return!r||!i||!a||r!==i?null:new al(r,a)}static _create(e,t){return new al(e,t)}buildRequest(){return{requestUri:R2,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2="saml.";class Yd extends As{constructor(e){re(e.startsWith(b2),"argument-error"),super(e)}static credentialFromResult(e){return Yd.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Yd.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=al.fromJSON(e);return re(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return al._create(r,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr extends Rl{constructor(){super("twitter.com")}static credential(e,t){return Qr._fromParams({providerId:zr.PROVIDER_ID,signInMethod:zr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zr.credentialFromTaggedObject(e)}static credentialFromError(e){return zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return zr.credential(t,r)}catch{return null}}}zr.TWITTER_SIGN_IN_METHOD="twitter.com";zr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qE(n,e){return Ss(n,"POST","/v1/accounts:signUp",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const a=await dr._fromIdTokenResponse(e,r,i),l=h0(r);return new er({user:a,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=h0(r);return new er({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function h0(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D2(n){var i;if(lt(n.app))return Promise.reject($t(n));const e=pt(n);if(await e._initializationPromise,(i=e.currentUser)!=null&&i.isAnonymous)return new er({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await qE(e,{returnSecureToken:!0}),r=await er._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd extends gn{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Xd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new Xd(e,t,r,i)}}function $E(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Xd._fromErrorAndOperation(n,a,e,r):a})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j2(n,e){const t=xe(n);await Sf(!0,t,e);const{providerUserInfo:r}=await Vk(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=HE(r||[]);return t.providerData=t.providerData.filter(a=>i.has(a.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function ny(n,e,t=!1){const r=await Es(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return er._forOperation(n,"link",r)}async function Sf(n,e,t){await vu(e);const r=HE(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";re(r.has(t)===n,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GE(n,e,t=!1){const{auth:r}=n;if(lt(r.app))return Promise.reject($t(r));const i="reauthenticate";try{const a=await Es(n,$E(r,i,e,n),t);re(a.idToken,r,"internal-error");const l=Ef(a.idToken);re(l,r,"internal-error");const{sub:d}=l;return re(n.uid===d,r,"user-mismatch"),er._forOperation(n,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Zt(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KE(n,e,t=!1){if(lt(n.app))return Promise.reject($t(n));const r="signIn",i=await $E(n,r,e),a=await er._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(a.user),a}async function Af(n,e){return KE(pt(n),e)}async function QE(n,e){const t=xe(n);return await Sf(!1,t,e.providerId),ny(t,e)}async function JE(n,e){return GE(xe(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V2(n,e){return Ss(n,"POST","/v1/accounts:signInWithCustomToken",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L2(n,e){if(lt(n.app))return Promise.reject($t(n));const t=pt(n),r=await V2(t,{token:e,returnSecureToken:!0}),i=await er._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?ry._fromServerResponse(e,t):"totpInfo"in t?sy._fromServerResponse(e,t):Zt(e,"internal-error")}}class ry extends Wu{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new ry(t)}}class sy extends Wu{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new sy(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cf(n,e,t){var r;re(((r=t.url)==null?void 0:r.length)>0,n,"invalid-continue-uri"),re(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),re(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(re(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(re(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iy(n){const e=pt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function O2(n,e,t){const r=pt(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Cf(r,i,t),await yi(r,i,"getOobCode",v2,"EMAIL_PASSWORD_PROVIDER")}async function M2(n,e,t){await WE(xe(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&iy(n),r})}async function F2(n,e){await g2(xe(n),{oobCode:e})}async function YE(n,e){const t=xe(n),r=await WE(t,{oobCode:e}),i=r.requestType;switch(re(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":re(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":re(r.mfaInfo,t,"internal-error");default:re(r.email,t,"internal-error")}let a=null;return r.mfaInfo&&(a=Wu._fromServerResponse(pt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:a},operation:i}}async function U2(n,e){const{data:t}=await YE(xe(n),e);return t.email}async function B2(n,e,t){if(lt(n.app))return Promise.reject($t(n));const r=pt(n),l=await yi(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",qE,"EMAIL_PASSWORD_PROVIDER").catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&iy(n),m}),d=await er._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(d.user),d}function z2(n,e,t){return lt(n.app)?Promise.reject($t(n)):Af(xe(n),Di.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&iy(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W2(n,e,t){const r=pt(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function a(l,d){re(d.handleCodeInApp,r,"argument-error"),d&&Cf(r,l,d)}a(i,t),await yi(r,i,"getOobCode",w2,"EMAIL_PASSWORD_PROVIDER")}function q2(n,e){const t=xf.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function $2(n,e,t){if(lt(n.app))return Promise.reject($t(n));const r=xe(n),i=Di.credentialWithLink(e,t||_u());return re(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Af(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(n,e){return wt(n,"POST","/v1/accounts:createAuthUri",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G2(n,e){const t=Zg()?_u():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await H2(xe(n),r);return i||[]}async function K2(n,e){const t=xe(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Cf(t.auth,i,e);const{email:a}=await _2(t.auth,i);a!==n.email&&await n.reload()}async function Q2(n,e,t){const r=xe(n),a={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Cf(r.auth,a,t);const{email:l}=await I2(r.auth,a);l!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J2(n,e){return wt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y2(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=xe(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await Es(r,J2(r.auth,a));r.displayName=l.displayName||null,r.photoURL=l.photoUrl||null;const d=r.providerData.find(({providerId:m})=>m==="password");d&&(d.displayName=r.displayName,d.photoURL=r.photoURL),await r._updateTokensIfNecessary(l)}function X2(n,e){const t=xe(n);return lt(t.auth.app)?Promise.reject($t(t.auth)):XE(t,e,null)}function Z2(n,e){return XE(xe(n),null,e)}async function XE(n,e,t){const{auth:r}=n,a={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(a.email=e),t&&(a.password=t);const l=await Es(n,m2(r,a));await n._updateTokensIfNecessary(l,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(n){var i,a;if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(n!=null&&n.idToken)){const l=(a=(i=Ef(n.idToken))==null?void 0:i.firebase)==null?void 0:a.sign_in_provider;if(l){const d=l!=="anonymous"&&l!=="custom"?l:null;return new el(r,d)}}if(!e)return null;switch(e){case"facebook.com":return new tN(r,t);case"github.com":return new nN(r,t);case"google.com":return new rN(r,t);case"twitter.com":return new sN(r,t,n.screenName||null);case"custom":case"anonymous":return new el(r,null);default:return new el(r,e,t)}}class el{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class ZE extends el{constructor(e,t,r,i){super(e,t,r),this.username=i}}class tN extends el{constructor(e,t){super(e,"facebook.com",t)}}class nN extends ZE{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class rN extends el{constructor(e,t){super(e,"google.com",t)}}class sN extends ZE{constructor(e,t,r){super(e,"twitter.com",t,r)}}function iN(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:eN(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new To("enroll",e,t)}static _fromMfaPendingCredential(e){return new To("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e!=null&&e.multiFactorSession){if((t=e.multiFactorSession)!=null&&t.pendingCredential)return To._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return To._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=pt(e),i=t.customData._serverResponse,a=(i.mfaInfo||[]).map(d=>Wu._fromServerResponse(r,d));re(i.mfaPendingCredential,r,"internal-error");const l=To._fromMfaPendingCredential(i.mfaPendingCredential);return new oy(l,a,async d=>{const m=await d._process(r,l);delete i.mfaInfo,delete i.mfaPendingCredential;const g={...i,idToken:m.idToken,refreshToken:m.refreshToken};switch(t.operationType){case"signIn":const v=await er._fromIdTokenResponse(r,t.operationType,g);return await r._updateCurrentUser(v.user),v;case"reauthenticate":return re(t.user,r,"internal-error"),er._forOperation(t.user,t.operationType,g);default:Zt(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function oN(n,e){var i;const t=xe(n),r=e;return re(e.customData.operationType,t,"argument-error"),re((i=r.customData._serverResponse)==null?void 0:i.mfaPendingCredential,t,"argument-error"),oy._fromError(t,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(n,e){return wt(n,"POST","/v2/accounts/mfaEnrollment:start",vt(n,e))}function aN(n,e){return wt(n,"POST","/v2/accounts/mfaEnrollment:finalize",vt(n,e))}function lN(n,e){return wt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",vt(n,e))}class ay{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Wu._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new ay(e)}async getSession(){return To._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,i=await this.getSession(),a=await Es(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(a),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const i=await Es(this.user,lN(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const Fp=new WeakMap;function cN(n){const e=xe(n);return Fp.has(e)||Fp.set(e,ay._fromUser(e)),Fp.get(e)}const Zd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Zd,"1"),this.storage.removeItem(Zd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uN=1e3,hN=10;class t1 extends e1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ME(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,m)=>{this.notifyListeners(l,m)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);$k()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,hN):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},uN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}t1.type="LOCAL";const ly=t1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1 extends e1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}n1.type="SESSION";const Po=n1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new kf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:a}=t.data,l=this.handlersMap[i];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const d=Array.from(l).map(async g=>g(t.origin,a)),m=await dN(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}kf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,l;return new Promise((d,m)=>{const g=qu("",20);i.port1.start();const v=setTimeout(()=>{m(new Error("unsupported_event"))},r);l={messageChannel:i,onMessage(I){const E=I;if(E.data.eventId===g)switch(E.data.status){case"ack":clearTimeout(v),a=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(E.data.response);break;default:clearTimeout(v),clearTimeout(a),m(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(){return window}function mN(n){bt().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(){return typeof bt().WorkerGlobalScope<"u"&&typeof bt().importScripts=="function"}async function pN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gN(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function yN(){return cy()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r1="firebaseLocalStorageDb",_N=1,ef="firebaseLocalStorage",s1="fbase_key";class $u{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Nf(n,e){return n.transaction([ef],e?"readwrite":"readonly").objectStore(ef)}function vN(){const n=indexedDB.deleteDatabase(r1);return new $u(n).toPromise()}function rg(){const n=indexedDB.open(r1,_N);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ef,{keyPath:s1})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ef)?e(r):(r.close(),await vN(),e(await rg()))})})}async function f0(n,e,t){const r=Nf(n,!0).put({[s1]:e,value:t});return new $u(r).toPromise()}async function wN(n,e){const t=Nf(n,!1).get(e),r=await new $u(t).toPromise();return r===void 0?null:r.value}function m0(n,e){const t=Nf(n,!0).delete(e);return new $u(t).toPromise()}const IN=800,EN=3;class i1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>EN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return cy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=kf._getInstance(yN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await pN(),!this.activeServiceWorker)return;this.sender=new fN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||gN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rg();return await f0(e,Zd,"1"),await m0(e,Zd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>f0(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>wN(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>m0(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Nf(i,!1).getAll();return new $u(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),IN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}i1.type="LOCAL";const Iu=i1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(n,e){return wt(n,"POST","/v2/accounts/mfaSignIn:start",vt(n,e))}function TN(n,e){return wt(n,"POST","/v2/accounts/mfaSignIn:finalize",vt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up=UE("rcb"),xN=new Fu(3e4,6e4);class SN{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=bt().grecaptcha)!=null&&e.render)}load(e,t=""){return re(AN(t),e,"argument-error"),this.shouldResolveImmediately(t)&&r0(bt().grecaptcha)?Promise.resolve(bt().grecaptcha):new Promise((r,i)=>{const a=bt().setTimeout(()=>{i(Ot(e,"network-request-failed"))},xN.get());bt()[Up]=()=>{bt().clearTimeout(a),delete bt()[Up];const d=bt().grecaptcha;if(!d||!r0(d)){i(Ot(e,"internal-error"));return}const m=d.render;d.render=(g,v)=>{const I=m(g,v);return this.counter++,I},this.hostLanguage=t,r(d)};const l=`${Xk()}?${kl({onload:Up,render:"explicit",hl:t})}`;ty(l).catch(()=>{clearTimeout(a),i(Ot(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=bt().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function AN(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class CN{async load(e){return new r2(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ru="recaptcha",kN={theme:"light",type:"image"};let NN=class{constructor(e,t,r={...kN}){this.parameters=r,this.type=ru,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=pt(e),this.isInvisible=this.parameters.size==="invisible",re(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;re(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new CN:new SN,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{const a=l=>{l&&(this.tokenChangeListeners.delete(a),i(l))};this.tokenChangeListeners.add(a),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){re(!this.parameters.sitekey,this.auth,"argument-error"),re(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),re(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=bt()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){re(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){re(Zg()&&!cy(),this.auth,"internal-error"),await PN(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Dk(this.auth);re(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return re(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function PN(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ko._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function RN(n,e,t){if(lt(n.app))return Promise.reject($t(n));const r=pt(n),i=await Pf(r,e,xe(t));return new uy(i,a=>Af(r,a))}async function bN(n,e,t){const r=xe(n);await Sf(!1,r,"phone");const i=await Pf(r.auth,e,xe(t));return new uy(i,a=>QE(r,a))}async function DN(n,e,t){const r=xe(n);if(lt(r.auth.app))return Promise.reject($t(r.auth));const i=await Pf(r.auth,e,xe(t));return new uy(i,a=>JE(r,a))}async function Pf(n,e,t){var r;if(!n._getRecaptchaConfig())try{await c2(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const a=i.session;if("phoneNumber"in i){re(a.type==="enroll",n,"internal-error");const l={idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await yi(n,l,"mfaSmsEnrollment",async(v,I)=>{if(I.phoneEnrollmentInfo.captchaResponse===nu){re((t==null?void 0:t.type)===ru,v,"argument-error");const E=await Bp(v,I,t);return d0(v,E)}return d0(v,I)},"PHONE_PROVIDER").catch(v=>Promise.reject(v))).phoneSessionInfo.sessionInfo}else{re(a.type==="signin",n,"internal-error");const l=((r=i.multiFactorHint)==null?void 0:r.uid)||i.multiFactorUid;re(l,n,"missing-multi-factor-info");const d={mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await yi(n,d,"mfaSmsSignIn",async(I,E)=>{if(E.phoneSignInInfo.captchaResponse===nu){re((t==null?void 0:t.type)===ru,I,"argument-error");const A=await Bp(I,E,t);return p0(I,A)}return p0(I,E)},"PHONE_PROVIDER").catch(I=>Promise.reject(I))).phoneResponseInfo.sessionInfo}}else{const a={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await yi(n,a,"sendVerificationCode",async(g,v)=>{if(v.captchaResponse===nu){re((t==null?void 0:t.type)===ru,g,"argument-error");const I=await Bp(g,v,t);return u0(g,I)}return u0(g,v)},"PHONE_PROVIDER").catch(g=>Promise.reject(g))).sessionInfo}}finally{t==null||t._reset()}}async function jN(n,e){const t=xe(n);if(lt(t.auth.app))return Promise.reject($t(t.auth));await ny(t,e)}async function Bp(n,e,t){re(t.type===ru,n,"argument-error");const r=await t.verify();re(typeof r=="string",n,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const a=i.phoneEnrollmentInfo.phoneNumber,l=i.phoneEnrollmentInfo.captchaResponse,d=i.phoneEnrollmentInfo.clientType,m=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:r,captchaResponse:l,clientType:d,recaptchaVersion:m}}),i}else if("phoneSignInInfo"in i){const a=i.phoneSignInInfo.captchaResponse,l=i.phoneSignInInfo.clientType,d=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:a,clientType:l,recaptchaVersion:d}}),i}else return Object.assign(i,{recaptchaToken:r}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ro=class bd{constructor(e){this.providerId=bd.PROVIDER_ID,this.auth=pt(e)}verifyPhoneNumber(e,t){return Pf(this.auth,e,xe(t))}static credential(e,t){return ko._fromVerification(e,t)}static credentialFromResult(e){const t=e;return bd.credentialFromTaggedObject(t)}static credentialFromError(e){return bd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?ko._fromTokenResponse(t,r):null}};Ro.PROVIDER_ID="phone";Ro.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(n,e){return e?Bn(e):(re(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy extends Pl{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ws(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ws(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ws(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function VN(n){return KE(n.auth,new hy(n),n.bypassAuthState)}function LN(n){const{auth:e,user:t}=n;return re(t,e,"internal-error"),GE(t,new hy(n),n.bypassAuthState)}async function ON(n){const{auth:e,user:t}=n;return re(t,e,"internal-error"),ny(t,new hy(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e,t,r,i,a=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const m={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(m))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return VN;case"linkViaPopup":case"linkViaRedirect":return ON;case"reauthViaPopup":case"reauthViaRedirect":return LN;default:Zt(this.auth,"internal-error")}}resolve(e){yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN=new Fu(2e3,1e4);async function FN(n,e,t){if(lt(n.app))return Promise.reject(Ot(n,"operation-not-supported-in-this-environment"));const r=pt(n);Nl(n,e,As);const i=$o(r,t);return new _s(r,"signInViaPopup",e,i).executeNotNull()}async function UN(n,e,t){const r=xe(n);if(lt(r.auth.app))return Promise.reject(Ot(r.auth,"operation-not-supported-in-this-environment"));Nl(r.auth,e,As);const i=$o(r.auth,t);return new _s(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function BN(n,e,t){const r=xe(n);Nl(r.auth,e,As);const i=$o(r.auth,t);return new _s(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class _s extends o1{constructor(e,t,r,i,a){super(e,t,i,a),this.provider=r,this.authWindow=null,this.pollId=null,_s.currentPopupAction&&_s.currentPopupAction.cancel(),_s.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){yr(this.filter.length===1,"Popup operations only handle one event");const e=qu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ot(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Ot(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_s.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ot(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MN.get())};e()}}_s.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN="pendingRedirect",su=new Map;class WN extends o1{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=su.get(this.auth._key());if(!e){try{const r=await qN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}su.set(this.auth._key(),e)}return this.bypassAuthState||su.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qN(n,e){const t=l1(e),r=a1(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}async function dy(n,e){return a1(n)._set(l1(e),"true")}function $N(){su.clear()}function fy(n,e){su.set(n._key(),e)}function a1(n){return Bn(n._redirectPersistence)}function l1(n){return Co(zN,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(n,e,t){return GN(n,e,t)}async function GN(n,e,t){if(lt(n.app))return Promise.reject($t(n));const r=pt(n);Nl(n,e,As),await r._initializationPromise;const i=$o(r,t);return await dy(i,r),i._openRedirect(r,e,"signInViaRedirect")}function KN(n,e,t){return QN(n,e,t)}async function QN(n,e,t){const r=xe(n);if(Nl(r.auth,e,As),lt(r.auth.app))return Promise.reject($t(r.auth));await r.auth._initializationPromise;const i=$o(r.auth,t);await dy(i,r.auth);const a=await c1(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",a)}function JN(n,e,t){return YN(n,e,t)}async function YN(n,e,t){const r=xe(n);Nl(r.auth,e,As),await r.auth._initializationPromise;const i=$o(r.auth,t);await Sf(!1,r,e.providerId),await dy(i,r.auth);const a=await c1(r);return i._openRedirect(r.auth,e,"linkViaRedirect",a)}async function XN(n,e){return await pt(n)._initializationPromise,Rf(n,e,!1)}async function Rf(n,e,t=!1){if(lt(n.app))return Promise.reject($t(n));const r=pt(n),i=$o(r,e),l=await new WN(r,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}async function c1(n){const e=qu(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=600*1e3;class u1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eP(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!h1(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ot(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ZN&&this.cachedEventUids.clear(),this.cachedEventUids.has(g0(e))}saveEventToCache(e){this.cachedEventUids.add(g0(e)),this.lastProcessedEventTime=Date.now()}}function g0(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function h1({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function eP(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return h1(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d1(n,e={}){return wt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nP=/^https?/;async function rP(n){if(n.config.emulator)return;const{authorizedDomains:e}=await d1(n);for(const t of e)try{if(sP(t))return}catch{}Zt(n,"unauthorized-domain")}function sP(n){const e=_u(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!nP.test(t))return!1;if(tP.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=new Fu(3e4,6e4);function y0(){const n=bt().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function oP(n){return new Promise((e,t)=>{var i,a,l;function r(){y0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{y0(),t(Ot(n,"network-request-failed"))},timeout:iP.get()})}if((a=(i=bt().gapi)==null?void 0:i.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((l=bt().gapi)!=null&&l.load)r();else{const d=UE("iframefcb");return bt()[d]=()=>{gapi.load?r():t(Ot(n,"network-request-failed"))},ty(`${e2()}?onload=${d}`).catch(m=>t(m))}}).catch(e=>{throw Dd=null,e})}let Dd=null;function aP(n){return Dd=Dd||oP(n),Dd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP=new Fu(5e3,15e3),cP="__/auth/iframe",uP="emulator/auth/iframe",hP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fP(n){const e=n.config;re(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ey(e,uP):`https://${n.config.authDomain}/${cP}`,r={apiKey:e.apiKey,appName:n.name,v:bi},i=dP.get(n.config.apiHost);i&&(r.eid=i);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${kl(r).slice(1)}`}async function mP(n){const e=await aP(n),t=bt().gapi;return re(t,n,"internal-error"),e.open({where:document.body,url:fP(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hP,dontclear:!0},r=>new Promise(async(i,a)=>{await r.restyle({setHideOnLeave:!1});const l=Ot(n,"network-request-failed"),d=bt().setTimeout(()=>{a(l)},lP.get());function m(){bt().clearTimeout(d),i(r)}r.ping(m).then(m,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},gP=500,yP=600,_P="_blank",vP="http://localhost";class _0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wP(n,e,t,r=gP,i=yP){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const m={...pP,width:r.toString(),height:i.toString(),top:a,left:l},g=mt().toLowerCase();t&&(d=jE(g)?_P:t),bE(g)&&(e=e||vP,m.scrollbars="yes");const v=Object.entries(m).reduce((E,[A,O])=>`${E}${A}=${O},`,"");if(qk(g)&&d!=="_self")return IP(e||"",d),new _0(null);const I=window.open(e||"",d,v);re(I,n,"popup-blocked");try{I.focus()}catch{}return new _0(I)}function IP(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP="__/auth/handler",TP="emulator/auth/handler",xP=encodeURIComponent("fac");async function sg(n,e,t,r,i,a){re(n.config.authDomain,n,"auth-domain-config-required"),re(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:bi,eventId:i};if(e instanceof As){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",YA(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,I]of Object.entries(a||{}))l[v]=I}if(e instanceof Rl){const v=e.getScopes().filter(I=>I!=="");v.length>0&&(l.scopes=v.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const m=await n._getAppCheckToken(),g=m?`#${xP}=${encodeURIComponent(m)}`:"";return`${SP(n)}?${kl(d).slice(1)}${g}`}function SP({config:n}){return n.emulator?ey(n,TP):`https://${n.authDomain}/${EP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="webStorageSupport";class AP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Po,this._completeRedirectFn=Rf,this._overrideRedirectResult=fy}async _openPopup(e,t,r,i){var l;yr((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const a=await sg(e,t,r,_u(),i);return wP(e,a,qu())}async _openRedirect(e,t,r,i){await this._originValidation(e);const a=await sg(e,t,r,_u(),i);return mN(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:a}=this.eventManagers[t];return i?Promise.resolve(i):(yr(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await mP(e),r=new u1(e);return t.register("authEvent",i=>(re(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(zp,{type:zp},i=>{var l;const a=(l=i==null?void 0:i[0])==null?void 0:l[zp];a!==void 0&&t(!!a),Zt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rP(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ME()||DE()||Bu()}}const CP=AP;class kP{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Wr("unexpected MultiFactorSessionType")}}}class my extends kP{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new my(e)}_finalizeEnroll(e,t,r){return aN(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return TN(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class f1{constructor(){}static assertion(e){return my._fromCredential(e)}}f1.FACTOR_ID="phone";var v0="@firebase/auth",w0="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function RP(n){xi(new Kr("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=r.options;re(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const m={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:FE(n)},g=new Jk(r,i,a,m);return u2(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),xi(new Kr("auth-internal",e=>{const t=pt(e.getProvider("auth").getImmediate());return(r=>new NP(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fr(v0,w0,PP(n)),fr(v0,w0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP=300;FA("authIdTokenMaxAge");function DP(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}Yk({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const a=Ot("internal-error");a.customData=i,t(a)},r.type="text/javascript",r.charset="UTF-8",DP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});RP("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP=2e3;async function VP(n,e,t){const{BuildInfo:r}=bo();yr(e.sessionId,"AuthEvent did not contain a session ID");const i=await UP(e.sessionId),a={};return Bu()?a.ibi=r.packageName:Uu()?a.apn=r.packageName:Zt(n,"operation-not-supported-in-this-environment"),r.displayName&&(a.appDisplayName=r.displayName),a.sessionId=i,sg(n,t,e.type,void 0,e.eventId??void 0,a)}async function LP(n){const{BuildInfo:e}=bo(),t={};Bu()?t.iosBundleId=e.packageName:Uu()?t.androidPackageName=e.packageName:Zt(n,"operation-not-supported-in-this-environment"),await d1(n,t)}function OP(n){const{cordova:e}=bo();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,Wk()?"_blank":"_system","location=yes"),t(i)})})}async function MP(n,e,t){const{cordova:r}=bo();let i=()=>{};try{await new Promise((a,l)=>{let d=null;function m(){var E;a();const I=(E=r.plugins.browsertab)==null?void 0:E.close;typeof I=="function"&&I(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function g(){d||(d=window.setTimeout(()=>{l(Ot(n,"redirect-cancelled-by-user"))},jP))}function v(){(document==null?void 0:document.visibilityState)==="visible"&&g()}e.addPassiveListener(m),document.addEventListener("resume",g,!1),Uu()&&document.addEventListener("visibilitychange",v,!1),i=()=>{e.removePassiveListener(m),document.removeEventListener("resume",g,!1),document.removeEventListener("visibilitychange",v,!1),d&&window.clearTimeout(d)}})}finally{i()}}function FP(n){var t,r,i,a,l,d,m,g,v,I;const e=bo();re(typeof((t=e==null?void 0:e.universalLinks)==null?void 0:t.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),re(typeof((r=e==null?void 0:e.BuildInfo)==null?void 0:r.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),re(typeof((l=(a=(i=e==null?void 0:e.cordova)==null?void 0:i.plugins)==null?void 0:a.browsertab)==null?void 0:l.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),re(typeof((g=(m=(d=e==null?void 0:e.cordova)==null?void 0:d.plugins)==null?void 0:m.browsertab)==null?void 0:g.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),re(typeof((I=(v=e==null?void 0:e.cordova)==null?void 0:v.InAppBrowser)==null?void 0:I.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function UP(n){const e=BP(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function BP(n){if(yr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP=20;class WP extends u1{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function qP(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:GP(),postBody:null,tenantId:n.tenantId,error:Ot(n,"no-auth-event")}}function $P(n,e){return ig()._set(og(n),e)}async function I0(n){const e=await ig()._get(og(n));return e&&await ig()._remove(og(n)),e}function HP(n,e){var r,i;const t=QP(e);if(t.includes("/__/auth/callback")){const a=jd(t),l=a.firebaseError?KP(decodeURIComponent(a.firebaseError)):null,d=(i=(r=l==null?void 0:l.code)==null?void 0:r.split("auth/"))==null?void 0:i[1],m=d?Ot(d):null;return m?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:m,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function GP(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<zP;t++){const r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function ig(){return Bn(ly)}function og(n){return Co("authEvent",n.config.apiKey,n.name)}function KP(n){try{return JSON.parse(n)}catch{return null}}function QP(n){const e=jd(n),t=e.link?decodeURIComponent(e.link):void 0,r=jd(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return jd(i).link||i||r||t||n}function jd(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Ja(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP=500;class YP{constructor(){this._redirectPersistence=Po,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Rf,this._overrideRedirectResult=fy}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new WP(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Zt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){FP(e);const a=await this._initialize(e);await a.initialized(),a.resetRedirect(),$N(),await this._originValidation(e);const l=qP(e,r,i);await $P(e,l);const d=await VP(e,l,t),m=await OP(d);return MP(e,a,m)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=LP(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:i,BuildInfo:a}=bo(),l=setTimeout(async()=>{await I0(e),t.onEvent(E0())},JP),d=async v=>{clearTimeout(l);const I=await I0(e);let E=null;I&&(v!=null&&v.url)&&(E=HP(I,v.url)),t.onEvent(E||E0())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,d);const m=i,g=`${a.packageName.toLowerCase()}://`;bo().handleOpenURL=async v=>{if(v.toLowerCase().startsWith(g)&&d({url:v}),typeof m=="function")try{m(v)}catch(I){console.error(I)}}}}const XP=YP;function E0(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ot("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZP(n,e){pt(n)._logFramework(e)}var eR="@firebase/auth-compat",tR="0.6.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=1e3;function iu(){var n;return((n=self==null?void 0:self.location)==null?void 0:n.protocol)||null}function rR(){return iu()==="http:"||iu()==="https:"}function m1(n=mt()){return!!((iu()==="file:"||iu()==="ionic:"||iu()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function sR(){return $g()||wf()}function iR(){return oE()&&(document==null?void 0:document.documentMode)===11}function oR(n=mt()){return/Edge\/\d+/.test(n)}function aR(n=mt()){return iR()||oR(n)}function p1(){try{const n=self.localStorage,e=qu();if(n)return n.setItem(e,"1"),n.removeItem(e),aR()?pu():!0}catch{return py()&&pu()}return!1}function py(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Wp(){return(rR()||iE()||m1())&&!sR()&&p1()&&!py()}function g1(){return m1()&&typeof document<"u"}async function lR(){return g1()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},nR);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function cR(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un={LOCAL:"local",NONE:"none",SESSION:"session"},Mc=re,y1="persistence";function uR(n,e){if(Mc(Object.values(Un).includes(e),n,"invalid-persistence-type"),$g()){Mc(e!==Un.SESSION,n,"unsupported-persistence-type");return}if(wf()){Mc(e===Un.NONE,n,"unsupported-persistence-type");return}if(py()){Mc(e===Un.NONE||e===Un.LOCAL&&pu(),n,"unsupported-persistence-type");return}Mc(e===Un.NONE||p1(),n,"unsupported-persistence-type")}async function ag(n){await n._initializationPromise;const e=_1(),t=Co(y1,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function hR(n,e){const t=_1();if(!t)return[];const r=Co(y1,n,e);switch(t.getItem(r)){case Un.NONE:return[ol];case Un.LOCAL:return[Iu,Po];case Un.SESSION:return[Po];default:return[]}}function _1(){var n;try{return((n=cR())==null?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR=re;class fi{constructor(){this.browserResolver=Bn(CP),this.cordovaResolver=Bn(XP),this.underlyingResolver=null,this._redirectPersistence=Po,this._completeRedirectFn=Rf,this._overrideRedirectResult=fy}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return g1()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return dR(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await lR();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(n){return n.unwrap()}function fR(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(n){return w1(n)}function pR(n,e){var r;const t=(r=e.customData)==null?void 0:r._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new gR(n,oN(n,e))}else if(t){const i=w1(e),a=e;i&&(a.credential=i,a.tenantId=t.tenantId||void 0,a.email=t.email||void 0,a.phoneNumber=t.phoneNumber||void 0)}}function w1(n){const{_tokenResponse:e}=n instanceof gn?n.customData:n;if(!e)return null;if(!(n instanceof gn)&&"temporaryProof"in e&&"phoneNumber"in e)return Ro.credentialFromResult(n);const t=e.providerId;if(!t||t===Lc.PASSWORD)return null;let r;switch(t){case Lc.GOOGLE:r=Ur;break;case Lc.FACEBOOK:r=Fr;break;case Lc.GITHUB:r=Br;break;case Lc.TWITTER:r=zr;break;default:const{oauthIdToken:i,oauthAccessToken:a,oauthTokenSecret:l,pendingToken:d,nonce:m}=e;return!a&&!l&&!i&&!d?null:d?t.startsWith("saml.")?al._create(t,d):Qr._fromParams({providerId:t,signInMethod:t,pendingToken:d,idToken:i,accessToken:a}):new Za(t).credential({idToken:i,accessToken:a,rawNonce:m})}return n instanceof gn?r.credentialFromError(n):r.credentialFromResult(n)}function Sn(n,e){return e.catch(t=>{throw t instanceof gn&&pR(n,t),t}).then(t=>{const r=t.operationType,i=t.user;return{operationType:r,credential:mR(t),additionalUserInfo:iN(t),user:bf.getOrCreate(i)}})}async function lg(n,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>Sn(n,t.confirm(r))}}class gR{constructor(e,t){this.resolver=t,this.auth=fR(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Sn(v1(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bf=class Kc{constructor(e){this._delegate=e,this.multiFactor=cN(e)}static getOrCreate(e){return Kc.USER_MAP.has(e)||Kc.USER_MAP.set(e,new Kc(e)),Kc.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Sn(this.auth,QE(this._delegate,e))}async linkWithPhoneNumber(e,t){return lg(this.auth,bN(this._delegate,e,t))}async linkWithPopup(e){return Sn(this.auth,BN(this._delegate,e,fi))}async linkWithRedirect(e){return await ag(pt(this.auth)),JN(this._delegate,e,fi)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Sn(this.auth,JE(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return lg(this.auth,DN(this._delegate,e,t))}reauthenticateWithPopup(e){return Sn(this.auth,UN(this._delegate,e,fi))}async reauthenticateWithRedirect(e){return await ag(pt(this.auth)),KN(this._delegate,e,fi)}sendEmailVerification(e){return K2(this._delegate,e)}async unlink(e){return await j2(this._delegate,e),this}updateEmail(e){return X2(this._delegate,e)}updatePassword(e){return Z2(this._delegate,e)}updatePhoneNumber(e){return jN(this._delegate,e)}updateProfile(e){return Y2(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Q2(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};bf.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc=re;class cg{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Fc(r,"invalid-api-key",{appName:e.name}),Fc(r,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?fi:void 0;this._delegate=t.initialize({options:{persistence:yR(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(Tk),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?bf.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){h2(this._delegate,e,t)}applyActionCode(e){return F2(this._delegate,e)}checkActionCode(e){return YE(this._delegate,e)}confirmPasswordReset(e,t){return M2(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Sn(this._delegate,B2(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return G2(this._delegate,e)}isSignInWithEmailLink(e){return q2(this._delegate,e)}async getRedirectResult(){Fc(Wp(),this._delegate,"operation-not-supported-in-this-environment");const e=await XN(this._delegate,fi);return e?Sn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){ZP(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:i,error:a,complete:l}=T0(e,t,r);return this._delegate.onAuthStateChanged(i,a,l)}onIdTokenChanged(e,t,r){const{next:i,error:a,complete:l}=T0(e,t,r);return this._delegate.onIdTokenChanged(i,a,l)}sendSignInLinkToEmail(e,t){return W2(this._delegate,e,t)}sendPasswordResetEmail(e,t){return O2(this._delegate,e,t||void 0)}async setPersistence(e){uR(this._delegate,e);let t;switch(e){case Un.SESSION:t=Po;break;case Un.LOCAL:t=await Bn(Iu)._isAvailable()?Iu:ly;break;case Un.NONE:t=ol;break;default:return Zt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Sn(this._delegate,D2(this._delegate))}signInWithCredential(e){return Sn(this._delegate,Af(this._delegate,e))}signInWithCustomToken(e){return Sn(this._delegate,L2(this._delegate,e))}signInWithEmailAndPassword(e,t){return Sn(this._delegate,z2(this._delegate,e,t))}signInWithEmailLink(e,t){return Sn(this._delegate,$2(this._delegate,e,t))}signInWithPhoneNumber(e,t){return lg(this._delegate,RN(this._delegate,e,t))}async signInWithPopup(e){return Fc(Wp(),this._delegate,"operation-not-supported-in-this-environment"),Sn(this._delegate,FN(this._delegate,e,fi))}async signInWithRedirect(e){return Fc(Wp(),this._delegate,"operation-not-supported-in-this-environment"),await ag(this._delegate),HN(this._delegate,e,fi)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return U2(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}cg.Persistence=Un;function T0(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);const i=r;return{next:l=>i(l&&bf.getOrCreate(l)),error:e,complete:t}}function yR(n,e){const t=hR(n,e);if(typeof self<"u"&&!t.includes(Iu)&&t.push(Iu),typeof window<"u")for(const r of[ly,Po])t.includes(r)||t.push(r);return t.includes(ol)||t.push(ol),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{static credential(e,t){return Ro.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Ro(v1(Lt.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}gy.PHONE_SIGN_IN_METHOD=Ro.PHONE_SIGN_IN_METHOD;gy.PROVIDER_ID=Ro.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R=re;class vR{constructor(e,t,r=Lt.app()){var i;_R((i=r.options)==null?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new NN(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wR="auth-compat";function IR(n){n.INTERNAL.registerComponent(new Kr(wR,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new cg(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Ma.EMAIL_SIGNIN,PASSWORD_RESET:Ma.PASSWORD_RESET,RECOVER_EMAIL:Ma.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Ma.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Ma.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Ma.VERIFY_EMAIL}},EmailAuthProvider:Di,FacebookAuthProvider:Fr,GithubAuthProvider:Br,GoogleAuthProvider:Ur,OAuthProvider:Za,SAMLAuthProvider:Yd,PhoneAuthProvider:gy,PhoneMultiFactorGenerator:f1,RecaptchaVerifier:vR,TwitterAuthProvider:zr,Auth:cg,AuthCredential:Pl,Error:gn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(eR,tR)}IR(Lt);var x0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _i,I1;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,S){function R(){}R.prototype=S.prototype,P.F=S.prototype,P.prototype=new R,P.prototype.constructor=P,P.D=function(j,N,M){for(var k=Array(arguments.length-2),be=2;be<arguments.length;be++)k[be-2]=arguments[be];return S.prototype[N].apply(j,k)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,S,R){R||(R=0);const j=Array(16);if(typeof S=="string")for(var N=0;N<16;++N)j[N]=S.charCodeAt(R++)|S.charCodeAt(R++)<<8|S.charCodeAt(R++)<<16|S.charCodeAt(R++)<<24;else for(N=0;N<16;++N)j[N]=S[R++]|S[R++]<<8|S[R++]<<16|S[R++]<<24;S=P.g[0],R=P.g[1],N=P.g[2];let M=P.g[3],k;k=S+(M^R&(N^M))+j[0]+3614090360&4294967295,S=R+(k<<7&4294967295|k>>>25),k=M+(N^S&(R^N))+j[1]+3905402710&4294967295,M=S+(k<<12&4294967295|k>>>20),k=N+(R^M&(S^R))+j[2]+606105819&4294967295,N=M+(k<<17&4294967295|k>>>15),k=R+(S^N&(M^S))+j[3]+3250441966&4294967295,R=N+(k<<22&4294967295|k>>>10),k=S+(M^R&(N^M))+j[4]+4118548399&4294967295,S=R+(k<<7&4294967295|k>>>25),k=M+(N^S&(R^N))+j[5]+1200080426&4294967295,M=S+(k<<12&4294967295|k>>>20),k=N+(R^M&(S^R))+j[6]+2821735955&4294967295,N=M+(k<<17&4294967295|k>>>15),k=R+(S^N&(M^S))+j[7]+4249261313&4294967295,R=N+(k<<22&4294967295|k>>>10),k=S+(M^R&(N^M))+j[8]+1770035416&4294967295,S=R+(k<<7&4294967295|k>>>25),k=M+(N^S&(R^N))+j[9]+2336552879&4294967295,M=S+(k<<12&4294967295|k>>>20),k=N+(R^M&(S^R))+j[10]+4294925233&4294967295,N=M+(k<<17&4294967295|k>>>15),k=R+(S^N&(M^S))+j[11]+2304563134&4294967295,R=N+(k<<22&4294967295|k>>>10),k=S+(M^R&(N^M))+j[12]+1804603682&4294967295,S=R+(k<<7&4294967295|k>>>25),k=M+(N^S&(R^N))+j[13]+4254626195&4294967295,M=S+(k<<12&4294967295|k>>>20),k=N+(R^M&(S^R))+j[14]+2792965006&4294967295,N=M+(k<<17&4294967295|k>>>15),k=R+(S^N&(M^S))+j[15]+1236535329&4294967295,R=N+(k<<22&4294967295|k>>>10),k=S+(N^M&(R^N))+j[1]+4129170786&4294967295,S=R+(k<<5&4294967295|k>>>27),k=M+(R^N&(S^R))+j[6]+3225465664&4294967295,M=S+(k<<9&4294967295|k>>>23),k=N+(S^R&(M^S))+j[11]+643717713&4294967295,N=M+(k<<14&4294967295|k>>>18),k=R+(M^S&(N^M))+j[0]+3921069994&4294967295,R=N+(k<<20&4294967295|k>>>12),k=S+(N^M&(R^N))+j[5]+3593408605&4294967295,S=R+(k<<5&4294967295|k>>>27),k=M+(R^N&(S^R))+j[10]+38016083&4294967295,M=S+(k<<9&4294967295|k>>>23),k=N+(S^R&(M^S))+j[15]+3634488961&4294967295,N=M+(k<<14&4294967295|k>>>18),k=R+(M^S&(N^M))+j[4]+3889429448&4294967295,R=N+(k<<20&4294967295|k>>>12),k=S+(N^M&(R^N))+j[9]+568446438&4294967295,S=R+(k<<5&4294967295|k>>>27),k=M+(R^N&(S^R))+j[14]+3275163606&4294967295,M=S+(k<<9&4294967295|k>>>23),k=N+(S^R&(M^S))+j[3]+4107603335&4294967295,N=M+(k<<14&4294967295|k>>>18),k=R+(M^S&(N^M))+j[8]+1163531501&4294967295,R=N+(k<<20&4294967295|k>>>12),k=S+(N^M&(R^N))+j[13]+2850285829&4294967295,S=R+(k<<5&4294967295|k>>>27),k=M+(R^N&(S^R))+j[2]+4243563512&4294967295,M=S+(k<<9&4294967295|k>>>23),k=N+(S^R&(M^S))+j[7]+1735328473&4294967295,N=M+(k<<14&4294967295|k>>>18),k=R+(M^S&(N^M))+j[12]+2368359562&4294967295,R=N+(k<<20&4294967295|k>>>12),k=S+(R^N^M)+j[5]+4294588738&4294967295,S=R+(k<<4&4294967295|k>>>28),k=M+(S^R^N)+j[8]+2272392833&4294967295,M=S+(k<<11&4294967295|k>>>21),k=N+(M^S^R)+j[11]+1839030562&4294967295,N=M+(k<<16&4294967295|k>>>16),k=R+(N^M^S)+j[14]+4259657740&4294967295,R=N+(k<<23&4294967295|k>>>9),k=S+(R^N^M)+j[1]+2763975236&4294967295,S=R+(k<<4&4294967295|k>>>28),k=M+(S^R^N)+j[4]+1272893353&4294967295,M=S+(k<<11&4294967295|k>>>21),k=N+(M^S^R)+j[7]+4139469664&4294967295,N=M+(k<<16&4294967295|k>>>16),k=R+(N^M^S)+j[10]+3200236656&4294967295,R=N+(k<<23&4294967295|k>>>9),k=S+(R^N^M)+j[13]+681279174&4294967295,S=R+(k<<4&4294967295|k>>>28),k=M+(S^R^N)+j[0]+3936430074&4294967295,M=S+(k<<11&4294967295|k>>>21),k=N+(M^S^R)+j[3]+3572445317&4294967295,N=M+(k<<16&4294967295|k>>>16),k=R+(N^M^S)+j[6]+76029189&4294967295,R=N+(k<<23&4294967295|k>>>9),k=S+(R^N^M)+j[9]+3654602809&4294967295,S=R+(k<<4&4294967295|k>>>28),k=M+(S^R^N)+j[12]+3873151461&4294967295,M=S+(k<<11&4294967295|k>>>21),k=N+(M^S^R)+j[15]+530742520&4294967295,N=M+(k<<16&4294967295|k>>>16),k=R+(N^M^S)+j[2]+3299628645&4294967295,R=N+(k<<23&4294967295|k>>>9),k=S+(N^(R|~M))+j[0]+4096336452&4294967295,S=R+(k<<6&4294967295|k>>>26),k=M+(R^(S|~N))+j[7]+1126891415&4294967295,M=S+(k<<10&4294967295|k>>>22),k=N+(S^(M|~R))+j[14]+2878612391&4294967295,N=M+(k<<15&4294967295|k>>>17),k=R+(M^(N|~S))+j[5]+4237533241&4294967295,R=N+(k<<21&4294967295|k>>>11),k=S+(N^(R|~M))+j[12]+1700485571&4294967295,S=R+(k<<6&4294967295|k>>>26),k=M+(R^(S|~N))+j[3]+2399980690&4294967295,M=S+(k<<10&4294967295|k>>>22),k=N+(S^(M|~R))+j[10]+4293915773&4294967295,N=M+(k<<15&4294967295|k>>>17),k=R+(M^(N|~S))+j[1]+2240044497&4294967295,R=N+(k<<21&4294967295|k>>>11),k=S+(N^(R|~M))+j[8]+1873313359&4294967295,S=R+(k<<6&4294967295|k>>>26),k=M+(R^(S|~N))+j[15]+4264355552&4294967295,M=S+(k<<10&4294967295|k>>>22),k=N+(S^(M|~R))+j[6]+2734768916&4294967295,N=M+(k<<15&4294967295|k>>>17),k=R+(M^(N|~S))+j[13]+1309151649&4294967295,R=N+(k<<21&4294967295|k>>>11),k=S+(N^(R|~M))+j[4]+4149444226&4294967295,S=R+(k<<6&4294967295|k>>>26),k=M+(R^(S|~N))+j[11]+3174756917&4294967295,M=S+(k<<10&4294967295|k>>>22),k=N+(S^(M|~R))+j[2]+718787259&4294967295,N=M+(k<<15&4294967295|k>>>17),k=R+(M^(N|~S))+j[9]+3951481745&4294967295,P.g[0]=P.g[0]+S&4294967295,P.g[1]=P.g[1]+(N+(k<<21&4294967295|k>>>11))&4294967295,P.g[2]=P.g[2]+N&4294967295,P.g[3]=P.g[3]+M&4294967295}r.prototype.v=function(P,S){S===void 0&&(S=P.length);const R=S-this.blockSize,j=this.C;let N=this.h,M=0;for(;M<S;){if(N==0)for(;M<=R;)i(this,P,M),M+=this.blockSize;if(typeof P=="string"){for(;M<S;)if(j[N++]=P.charCodeAt(M++),N==this.blockSize){i(this,j),N=0;break}}else for(;M<S;)if(j[N++]=P[M++],N==this.blockSize){i(this,j),N=0;break}}this.h=N,this.o+=S},r.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var S=1;S<P.length-8;++S)P[S]=0;S=this.o*8;for(var R=P.length-8;R<P.length;++R)P[R]=S&255,S/=256;for(this.v(P),P=Array(16),S=0,R=0;R<4;++R)for(let j=0;j<32;j+=8)P[S++]=this.g[R]>>>j&255;return P};function a(P,S){var R=d;return Object.prototype.hasOwnProperty.call(R,P)?R[P]:R[P]=S(P)}function l(P,S){this.h=S;const R=[];let j=!0;for(let N=P.length-1;N>=0;N--){const M=P[N]|0;j&&M==S||(R[N]=M,j=!1)}this.g=R}var d={};function m(P){return-128<=P&&P<128?a(P,function(S){return new l([S|0],S<0?-1:0)}):new l([P|0],P<0?-1:0)}function g(P){if(isNaN(P)||!isFinite(P))return I;if(P<0)return L(g(-P));const S=[];let R=1;for(let j=0;P>=R;j++)S[j]=P/R|0,R*=4294967296;return new l(S,0)}function v(P,S){if(P.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(P.charAt(0)=="-")return L(v(P.substring(1),S));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=g(Math.pow(S,8));let j=I;for(let M=0;M<P.length;M+=8){var N=Math.min(8,P.length-M);const k=parseInt(P.substring(M,M+N),S);N<8?(N=g(Math.pow(S,N)),j=j.j(N).add(g(k))):(j=j.j(R),j=j.add(g(k)))}return j}var I=m(0),E=m(1),A=m(16777216);n=l.prototype,n.m=function(){if(U(this))return-L(this).m();let P=0,S=1;for(let R=0;R<this.g.length;R++){const j=this.i(R);P+=(j>=0?j:4294967296+j)*S,S*=4294967296}return P},n.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(O(this))return"0";if(U(this))return"-"+L(this).toString(P);const S=g(Math.pow(P,6));var R=this;let j="";for(;;){const N=Y(R,S).g;R=oe(R,N.j(S));let M=((R.g.length>0?R.g[0]:R.h)>>>0).toString(P);if(R=N,O(R))return M+j;for(;M.length<6;)M="0"+M;j=M+j}},n.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function O(P){if(P.h!=0)return!1;for(let S=0;S<P.g.length;S++)if(P.g[S]!=0)return!1;return!0}function U(P){return P.h==-1}n.l=function(P){return P=oe(this,P),U(P)?-1:O(P)?0:1};function L(P){const S=P.g.length,R=[];for(let j=0;j<S;j++)R[j]=~P.g[j];return new l(R,~P.h).add(E)}n.abs=function(){return U(this)?L(this):this},n.add=function(P){const S=Math.max(this.g.length,P.g.length),R=[];let j=0;for(let N=0;N<=S;N++){let M=j+(this.i(N)&65535)+(P.i(N)&65535),k=(M>>>16)+(this.i(N)>>>16)+(P.i(N)>>>16);j=k>>>16,M&=65535,k&=65535,R[N]=k<<16|M}return new l(R,R[R.length-1]&-2147483648?-1:0)};function oe(P,S){return P.add(L(S))}n.j=function(P){if(O(this)||O(P))return I;if(U(this))return U(P)?L(this).j(L(P)):L(L(this).j(P));if(U(P))return L(this.j(L(P)));if(this.l(A)<0&&P.l(A)<0)return g(this.m()*P.m());const S=this.g.length+P.g.length,R=[];for(var j=0;j<2*S;j++)R[j]=0;for(j=0;j<this.g.length;j++)for(let N=0;N<P.g.length;N++){const M=this.i(j)>>>16,k=this.i(j)&65535,be=P.i(N)>>>16,Ct=P.i(N)&65535;R[2*j+2*N]+=k*Ct,J(R,2*j+2*N),R[2*j+2*N+1]+=M*Ct,J(R,2*j+2*N+1),R[2*j+2*N+1]+=k*be,J(R,2*j+2*N+1),R[2*j+2*N+2]+=M*be,J(R,2*j+2*N+2)}for(P=0;P<S;P++)R[P]=R[2*P+1]<<16|R[2*P];for(P=S;P<2*S;P++)R[P]=0;return new l(R,0)};function J(P,S){for(;(P[S]&65535)!=P[S];)P[S+1]+=P[S]>>>16,P[S]&=65535,S++}function W(P,S){this.g=P,this.h=S}function Y(P,S){if(O(S))throw Error("division by zero");if(O(P))return new W(I,I);if(U(P))return S=Y(L(P),S),new W(L(S.g),L(S.h));if(U(S))return S=Y(P,L(S)),new W(L(S.g),S.h);if(P.g.length>30){if(U(P)||U(S))throw Error("slowDivide_ only works with positive integers.");for(var R=E,j=S;j.l(P)<=0;)R=he(R),j=he(j);var N=Q(R,1),M=Q(j,1);for(j=Q(j,2),R=Q(R,2);!O(j);){var k=M.add(j);k.l(P)<=0&&(N=N.add(R),M=k),j=Q(j,1),R=Q(R,1)}return S=oe(P,N.j(S)),new W(N,S)}for(N=I;P.l(S)>=0;){for(R=Math.max(1,Math.floor(P.m()/S.m())),j=Math.ceil(Math.log(R)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),M=g(R),k=M.j(S);U(k)||k.l(P)>0;)R-=j,M=g(R),k=M.j(S);O(M)&&(M=E),N=N.add(M),P=oe(P,k)}return new W(N,P)}n.B=function(P){return Y(this,P).h},n.and=function(P){const S=Math.max(this.g.length,P.g.length),R=[];for(let j=0;j<S;j++)R[j]=this.i(j)&P.i(j);return new l(R,this.h&P.h)},n.or=function(P){const S=Math.max(this.g.length,P.g.length),R=[];for(let j=0;j<S;j++)R[j]=this.i(j)|P.i(j);return new l(R,this.h|P.h)},n.xor=function(P){const S=Math.max(this.g.length,P.g.length),R=[];for(let j=0;j<S;j++)R[j]=this.i(j)^P.i(j);return new l(R,this.h^P.h)};function he(P){const S=P.g.length+1,R=[];for(let j=0;j<S;j++)R[j]=P.i(j)<<1|P.i(j-1)>>>31;return new l(R,P.h)}function Q(P,S){const R=S>>5;S%=32;const j=P.g.length-R,N=[];for(let M=0;M<j;M++)N[M]=S>0?P.i(M+R)>>>S|P.i(M+R+1)<<32-S:P.i(M+R);return new l(N,P.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,I1=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=g,l.fromString=v,_i=l}).apply(typeof x0<"u"?x0:typeof self<"u"?self:typeof window<"u"?window:{});var xd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var E1,Qc,T1,Vd,ug,x1,S1,A1;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof xd=="object"&&xd];for(var _=0;_<h.length;++_){var w=h[_];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function i(h,_){if(_)e:{var w=r;h=h.split(".");for(var x=0;x<h.length-1;x++){var z=h[x];if(!(z in w))break e;w=w[z]}h=h[h.length-1],x=w[h],_=_(x),_!=x&&_!=null&&e(w,h,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(h){return h||function(_){var w=[],x;for(x in _)Object.prototype.hasOwnProperty.call(_,x)&&w.push([x,_[x]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function d(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function m(h,_,w){return h.call.apply(h.bind,arguments)}function g(h,_,w){return g=m,g.apply(null,arguments)}function v(h,_){var w=Array.prototype.slice.call(arguments,1);return function(){var x=w.slice();return x.push.apply(x,arguments),h.apply(this,x)}}function I(h,_){function w(){}w.prototype=_.prototype,h.Z=_.prototype,h.prototype=new w,h.prototype.constructor=h,h.Ob=function(x,z,K){for(var ae=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)ae[Ne-2]=arguments[Ne];return _.prototype[z].apply(x,ae)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function A(h){const _=h.length;if(_>0){const w=Array(_);for(let x=0;x<_;x++)w[x]=h[x];return w}return[]}function O(h,_){for(let x=1;x<arguments.length;x++){const z=arguments[x];var w=typeof z;if(w=w!="object"?w:z?Array.isArray(z)?"array":w:"null",w=="array"||w=="object"&&typeof z.length=="number"){w=h.length||0;const K=z.length||0;h.length=w+K;for(let ae=0;ae<K;ae++)h[w+ae]=z[ae]}else h.push(z)}}class U{constructor(_,w){this.i=_,this.j=w,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function L(h){l.setTimeout(()=>{throw h},0)}function oe(){var h=P;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class J{constructor(){this.h=this.g=null}add(_,w){const x=W.get();x.set(_,w),this.h?this.h.next=x:this.g=x,this.h=x}}var W=new U(()=>new Y,h=>h.reset());class Y{constructor(){this.next=this.g=this.h=null}set(_,w){this.h=_,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let he,Q=!1,P=new J,S=()=>{const h=Promise.resolve(void 0);he=()=>{h.then(R)}};function R(){for(var h;h=oe();){try{h.h.call(h.g)}catch(w){L(w)}var _=W;_.j(h),_.h<100&&(_.h++,h.next=_.g,_.g=h)}Q=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};l.addEventListener("test",w,_),l.removeEventListener("test",w,_)}catch{}return h})();function k(h){return/^[\s\xa0]*$/.test(h)}function be(h,_){N.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,_)}I(be,N),be.prototype.init=function(h,_){const w=this.type=h.type,x=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget,_||(w=="mouseover"?_=h.fromElement:w=="mouseout"&&(_=h.toElement)),this.relatedTarget=_,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&be.Z.h.call(this)},be.prototype.h=function(){be.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ct="closure_listenable_"+(Math.random()*1e6|0),Ft=0;function Xe(h,_,w,x,z){this.listener=h,this.proxy=null,this.src=_,this.type=w,this.capture=!!x,this.ha=z,this.key=++Ft,this.da=this.fa=!1}function ce(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function we(h,_,w){for(const x in h)_.call(w,h[x],x,h)}function me(h,_){for(const w in h)_.call(void 0,h[w],w,h)}function b(h){const _={};for(const w in h)_[w]=h[w];return _}const X="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Se(h,_){let w,x;for(let z=1;z<arguments.length;z++){x=arguments[z];for(w in x)h[w]=x[w];for(let K=0;K<X.length;K++)w=X[K],Object.prototype.hasOwnProperty.call(x,w)&&(h[w]=x[w])}}function Ce(h){this.src=h,this.g={},this.h=0}Ce.prototype.add=function(h,_,w,x,z){const K=h.toString();h=this.g[K],h||(h=this.g[K]=[],this.h++);const ae=Le(h,_,x,z);return ae>-1?(_=h[ae],w||(_.fa=!1)):(_=new Xe(_,this.src,K,!!x,z),_.fa=w,h.push(_)),_};function Ve(h,_){const w=_.type;if(w in h.g){var x=h.g[w],z=Array.prototype.indexOf.call(x,_,void 0),K;(K=z>=0)&&Array.prototype.splice.call(x,z,1),K&&(ce(_),h.g[w].length==0&&(delete h.g[w],h.h--))}}function Le(h,_,w,x){for(let z=0;z<h.length;++z){const K=h[z];if(!K.da&&K.listener==_&&K.capture==!!w&&K.ha==x)return z}return-1}var $e="closure_lm_"+(Math.random()*1e6|0),Ue={};function Je(h,_,w,x,z){if(Array.isArray(_)){for(let K=0;K<_.length;K++)Je(h,_[K],w,x,z);return null}return w=zl(w),h&&h[Ct]?h.J(_,w,d(x)?!!x.capture:!1,z):hn(h,_,w,!1,x,z)}function hn(h,_,w,x,z,K){if(!_)throw Error("Invalid event type");const ae=d(z)?!!z.capture:!!z;let Ne=Xo(h);if(Ne||(h[$e]=Ne=new Ce(h)),w=Ne.add(_,w,x,ae,K),w.proxy)return w;if(x=Jo(),w.proxy=x,x.src=h,x.listener=w,h.addEventListener)M||(z=ae),z===void 0&&(z=!1),h.addEventListener(_.toString(),x,z);else if(h.attachEvent)h.attachEvent(Yo(_.toString()),x);else if(h.addListener&&h.removeListener)h.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Jo(){function h(w){return _.call(h.src,h.listener,w)}const _=ah;return h}function Bl(h,_,w,x,z){if(Array.isArray(_))for(var K=0;K<_.length;K++)Bl(h,_[K],w,x,z);else x=d(x)?!!x.capture:!!x,w=zl(w),h&&h[Ct]?(h=h.i,K=String(_).toString(),K in h.g&&(_=h.g[K],w=Le(_,w,x,z),w>-1&&(ce(_[w]),Array.prototype.splice.call(_,w,1),_.length==0&&(delete h.g[K],h.h--)))):h&&(h=Xo(h))&&(_=h.g[_.toString()],h=-1,_&&(h=Le(_,w,x,z)),(w=h>-1?_[h]:null)&&Rs(w))}function Rs(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[Ct])Ve(_.i,h);else{var w=h.type,x=h.proxy;_.removeEventListener?_.removeEventListener(w,x,h.capture):_.detachEvent?_.detachEvent(Yo(w),x):_.addListener&&_.removeListener&&_.removeListener(x),(w=Xo(_))?(Ve(w,h),w.h==0&&(w.src=null,_[$e]=null)):ce(h)}}}function Yo(h){return h in Ue?Ue[h]:Ue[h]="on"+h}function ah(h,_){if(h.da)h=!0;else{_=new be(_,this);const w=h.listener,x=h.ha||h.src;h.fa&&Rs(h),h=w.call(x,_)}return h}function Xo(h){return h=h[$e],h instanceof Ce?h:null}var Fi="__closure_events_fn_"+(Math.random()*1e9>>>0);function zl(h){return typeof h=="function"?h:(h[Fi]||(h[Fi]=function(_){return h.handleEvent(_)}),h[Fi])}function kt(){j.call(this),this.i=new Ce(this),this.M=this,this.G=null}I(kt,j),kt.prototype[Ct]=!0,kt.prototype.removeEventListener=function(h,_,w,x){Bl(this,h,_,w,x)};function It(h,_){var w,x=h.G;if(x)for(w=[];x;x=x.G)w.push(x);if(h=h.M,x=_.type||_,typeof _=="string")_=new N(_,h);else if(_ instanceof N)_.target=_.target||h;else{var z=_;_=new N(x,h),Se(_,z)}z=!0;let K,ae;if(w)for(ae=w.length-1;ae>=0;ae--)K=_.g=w[ae],z=tr(K,x,!0,_)&&z;if(K=_.g=h,z=tr(K,x,!0,_)&&z,z=tr(K,x,!1,_)&&z,w)for(ae=0;ae<w.length;ae++)K=_.g=w[ae],z=tr(K,x,!1,_)&&z}kt.prototype.N=function(){if(kt.Z.N.call(this),this.i){var h=this.i;for(const _ in h.g){const w=h.g[_];for(let x=0;x<w.length;x++)ce(w[x]);delete h.g[_],h.h--}}this.G=null},kt.prototype.J=function(h,_,w,x){return this.i.add(String(h),_,!1,w,x)},kt.prototype.K=function(h,_,w,x){return this.i.add(String(h),_,!0,w,x)};function tr(h,_,w,x){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();let z=!0;for(let K=0;K<_.length;++K){const ae=_[K];if(ae&&!ae.da&&ae.capture==w){const Ne=ae.listener,Et=ae.ha||ae.src;ae.fa&&Ve(h.i,ae),z=Ne.call(Et,x)!==!1&&z}}return z&&!x.defaultPrevented}function Wl(h,_){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:l.setTimeout(h,_||0)}function ql(h){h.g=Wl(()=>{h.g=null,h.i&&(h.i=!1,ql(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class lh extends j{constructor(_,w){super(),this.m=_,this.l=w,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:ql(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bs(h){j.call(this),this.h=h,this.g={}}I(bs,j);var $l=[];function Zo(h){we(h.g,function(_,w){this.g.hasOwnProperty(w)&&Rs(_)},h),h.g={}}bs.prototype.N=function(){bs.Z.N.call(this),Zo(this)},bs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ds=l.JSON.stringify,ch=l.JSON.parse,Ui=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function js(){}function uh(){}var Vs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ea(){N.call(this,"d")}I(ea,N);function Hl(){N.call(this,"c")}I(Hl,N);var nr={},ta=null;function Ls(){return ta=ta||new kt}nr.Ia="serverreachability";function na(h){N.call(this,nr.Ia,h)}I(na,N);function es(h){const _=Ls();It(_,new na(_))}nr.STAT_EVENT="statevent";function ts(h,_){N.call(this,nr.STAT_EVENT,h),this.stat=_}I(ts,N);function gt(h){const _=Ls();It(_,new ts(_,h))}nr.Ja="timingevent";function Gl(h,_){N.call(this,nr.Ja,h),this.size=_}I(Gl,N);function Os(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},_)}function Ms(){this.g=!0}Ms.prototype.ua=function(){this.g=!1};function hh(h,_,w,x,z,K){h.info(function(){if(h.g)if(K){var ae="",Ne=K.split("&");for(let Ge=0;Ge<Ne.length;Ge++){var Et=Ne[Ge].split("=");if(Et.length>1){const Nt=Et[0];Et=Et[1];const jn=Nt.split("_");ae=jn.length>=2&&jn[1]=="type"?ae+(Nt+"="+Et+"&"):ae+(Nt+"=redacted&")}}}else ae=null;else ae=K;return"XMLHTTP REQ ("+x+") [attempt "+z+"]: "+_+`
`+w+`
`+ae})}function dh(h,_,w,x,z,K,ae){h.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+z+"]: "+_+`
`+w+`
`+K+" "+ae})}function vr(h,_,w,x){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+Bi(h,w)+(x?" "+x:"")})}function fh(h,_){h.info(function(){return"TIMEOUT: "+_})}Ms.prototype.info=function(){};function Bi(h,_){if(!h.g)return _;if(!_)return null;try{const K=JSON.parse(_);if(K){for(h=0;h<K.length;h++)if(Array.isArray(K[h])){var w=K[h];if(!(w.length<2)){var x=w[1];if(Array.isArray(x)&&!(x.length<1)){var z=x[0];if(z!="noop"&&z!="stop"&&z!="close")for(let ae=1;ae<x.length;ae++)x[ae]=""}}}}return Ds(K)}catch{return _}}var Fs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Us={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},mh;function ns(){}I(ns,js),ns.prototype.g=function(){return new XMLHttpRequest},mh=new ns;function wr(h){return encodeURIComponent(String(h))}function ra(h){var _=1;h=h.split(":");const w=[];for(;_>0&&h.length;)w.push(h.shift()),_--;return h.length&&w.push(h.join(":")),w}function qn(h,_,w,x){this.j=h,this.i=_,this.l=w,this.S=x||1,this.V=new bs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ph}function ph(){this.i=null,this.g="",this.h=!1}var gh={},Kl={};function rr(h,_,w){h.M=1,h.A=ss($n(_)),h.u=w,h.R=!0,Ql(h,null)}function Ql(h,_){h.F=Date.now(),zi(h),h.B=$n(h.A);var w=h.B,x=h.S;Array.isArray(x)||(x=[String(x)]),ic(w.i,"t",x),h.C=0,w=h.j.L,h.h=new ph,h.g=Ah(h.j,w?_:null,!h.u),h.P>0&&(h.O=new lh(g(h.Y,h,h.g),h.P)),_=h.V,w=h.g,x=h.ba;var z="readystatechange";Array.isArray(z)||(z&&($l[0]=z.toString()),z=$l);for(let K=0;K<z.length;K++){const ae=Je(w,z[K],x||_.handleEvent,!1,_.h||_);if(!ae)break;_.g[ae.key]=ae}_=h.J?b(h.J):{},h.u?(h.v||(h.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,_)):(h.v="GET",h.g.ea(h.B,h.v,null,_)),es(),hh(h.i,h.v,h.B,h.l,h.S,h.u)}qn.prototype.ba=function(h){h=h.target;const _=this.O;_&&Cr(h)==3?_.j():this.Y(h)},qn.prototype.Y=function(h){try{if(h==this.g)e:{const Ne=Cr(this.g),Et=this.g.ya(),Ge=this.g.ca();if(!(Ne<3)&&(Ne!=3||this.g&&(this.h.h||this.g.la()||xh(this.g)))){this.K||Ne!=4||Et==7||(Et==8||Ge<=0?es(3):es(2)),sa(this);var _=this.g.ca();this.X=_;var w=yh(this);if(this.o=_==200,dh(this.i,this.v,this.B,this.l,this.S,Ne,_),this.o){if(this.U&&!this.L){t:{if(this.g){var x,z=this.g;if((x=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(x)){var K=x;break t}}K=null}if(h=K)vr(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,nt(this,h);else{this.o=!1,this.m=3,gt(12),rs(this),Wi(this);break e}}if(this.R){h=!0;let Nt;for(;!this.K&&this.C<w.length;)if(Nt=vh(this,w),Nt==Kl){Ne==4&&(this.m=4,gt(14),h=!1),vr(this.i,this.l,null,"[Incomplete Response]");break}else if(Nt==gh){this.m=4,gt(15),vr(this.i,this.l,w,"[Invalid Chunk]"),h=!1;break}else vr(this.i,this.l,Nt,null),nt(this,Nt);if(_h(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ne!=4||w.length!=0||this.h.h||(this.m=1,gt(16),h=!1),this.o=this.o&&h,!h)vr(this.i,this.l,w,"[Invalid Chunked Response]"),rs(this),Wi(this);else if(w.length>0&&!this.W){this.W=!0;var ae=this.j;ae.g==this&&ae.aa&&!ae.P&&(ae.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Xi(ae),ae.P=!0,gt(11))}}else vr(this.i,this.l,w,null),nt(this,w);Ne==4&&rs(this),this.o&&!this.K&&(Ne==4?ma(this.j,this):(this.o=!1,zi(this)))}else ac(this.g),_==400&&w.indexOf("Unknown SID")>0?(this.m=3,gt(12)):(this.m=0,gt(13)),rs(this),Wi(this)}}}catch{}finally{}};function yh(h){if(!_h(h))return h.g.la();const _=xh(h.g);if(_==="")return"";let w="";const x=_.length,z=Cr(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return rs(h),Wi(h),"";h.h.i=new l.TextDecoder}for(let K=0;K<x;K++)h.h.h=!0,w+=h.h.i.decode(_[K],{stream:!(z&&K==x-1)});return _.length=0,h.h.g+=w,h.C=0,h.h.g}function _h(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function vh(h,_){var w=h.C,x=_.indexOf(`
`,w);return x==-1?Kl:(w=Number(_.substring(w,x)),isNaN(w)?gh:(x+=1,x+w>_.length?Kl:(_=_.slice(x,x+w),h.C=x+w,_)))}qn.prototype.cancel=function(){this.K=!0,rs(this)};function zi(h){h.T=Date.now()+h.H,Jl(h,h.H)}function Jl(h,_){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Os(g(h.aa,h),_)}function sa(h){h.D&&(l.clearTimeout(h.D),h.D=null)}qn.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(fh(this.i,this.B),this.M!=2&&(es(),gt(17)),rs(this),this.m=2,Wi(this)):Jl(this,this.T-h)};function Wi(h){h.j.I==0||h.K||ma(h.j,h)}function rs(h){sa(h);var _=h.O;_&&typeof _.dispose=="function"&&_.dispose(),h.O=null,Zo(h.V),h.g&&(_=h.g,h.g=null,_.abort(),_.dispose())}function nt(h,_){try{var w=h.j;if(w.I!=0&&(w.g==h||Xl(w.h,h))){if(!h.L&&Xl(w.h,h)&&w.I==3){try{var x=w.Ba.g.parse(_)}catch{x=null}if(Array.isArray(x)&&x.length==3){var z=x;if(z[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<h.F)fa(w),bn(w);else break e;Pr(w),gt(18)}}else w.xa=z[1],0<w.xa-w.K&&z[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=Os(g(w.Va,w),6e3));qi(w.h)<=1&&w.ta&&(w.ta=void 0)}else Dn(w,11)}else if((h.L||w.g==h)&&fa(w),!k(_))for(z=w.Ba.g.parse(_),_=0;_<z.length;_++){let Ge=z[_];const Nt=Ge[0];if(!(Nt<=w.K))if(w.K=Nt,Ge=Ge[1],w.I==2)if(Ge[0]=="c"){w.M=Ge[1],w.ba=Ge[2];const jn=Ge[3];jn!=null&&(w.ka=jn,w.j.info("VER="+w.ka));const cs=Ge[4];cs!=null&&(w.za=cs,w.j.info("SVER="+w.za));const Rr=Ge[5];Rr!=null&&typeof Rr=="number"&&Rr>0&&(x=1.5*Rr,w.O=x,w.j.info("backChannelRequestTimeoutMs_="+x)),x=w;const br=h.g;if(br){const ya=br.g?br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ya){var K=x.h;K.g||ya.indexOf("spdy")==-1&&ya.indexOf("quic")==-1&&ya.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(oa(K,K.h),K.h=null))}if(x.G){const uc=br.g?br.g.getResponseHeader("X-HTTP-Session-Id"):null;uc&&(x.wa=uc,qe(x.J,x.G,uc))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-h.F,w.j.info("Handshake RTT: "+w.T+"ms")),x=w;var ae=h;if(x.na=cc(x,x.L?x.ba:null,x.W),ae.L){$i(x.h,ae);var Ne=ae,Et=x.O;Et&&(Ne.H=Et),Ne.D&&(sa(Ne),zi(Ne)),x.g=ae}else en(x);w.i.length>0&&ls(w)}else Ge[0]!="stop"&&Ge[0]!="close"||Dn(w,7);else w.I==3&&(Ge[0]=="stop"||Ge[0]=="close"?Ge[0]=="stop"?Dn(w,7):ha(w):Ge[0]!="noop"&&w.l&&w.l.qa(Ge),w.A=0)}}es(4)}catch{}}var im=class{constructor(h,_){this.g=h,this.map=_}};function ia(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Yl(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function qi(h){return h.h?1:h.g?h.g.size:0}function Xl(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function oa(h,_){h.g?h.g.add(_):h.h=_}function $i(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}ia.prototype.cancel=function(){if(this.i=Nn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Nn(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const w of h.g.values())_=_.concat(w.G);return _}return A(h.i)}var wh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pn(h,_){if(h){h=h.split("&");for(let w=0;w<h.length;w++){const x=h[w].indexOf("=");let z,K=null;x>=0?(z=h[w].substring(0,x),K=h[w].substring(x+1)):z=h[w],_(z,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Ir(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;h instanceof Ir?(this.l=h.l,Hi(this,h.j),this.o=h.o,this.g=h.g,Er(this,h.u),this.h=h.h,Bs(this,oc(h.i)),this.m=h.m):h&&(_=String(h).match(wh))?(this.l=!1,Hi(this,_[1]||"",!0),this.o=Gi(_[2]||""),this.g=Gi(_[3]||"",!0),Er(this,_[4]),this.h=Gi(_[5]||"",!0),Bs(this,_[6]||"",!0),this.m=Gi(_[7]||"")):(this.l=!1,this.i=new Me(null,this.l))}Ir.prototype.toString=function(){const h=[];var _=this.j;_&&h.push(Ki(_,ec,!0),":");var w=this.g;return(w||_=="file")&&(h.push("//"),(_=this.o)&&h.push(Ki(_,ec,!0),"@"),h.push(wr(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&h.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(Ki(w,w.charAt(0)=="/"?Qi:tc,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",Ki(w,nc)),h.join("")},Ir.prototype.resolve=function(h){const _=$n(this);let w=!!h.j;w?Hi(_,h.j):w=!!h.o,w?_.o=h.o:w=!!h.g,w?_.g=h.g:w=h.u!=null;var x=h.h;if(w)Er(_,h.u);else if(w=!!h.h){if(x.charAt(0)!="/")if(this.g&&!this.h)x="/"+x;else{var z=_.h.lastIndexOf("/");z!=-1&&(x=_.h.slice(0,z+1)+x)}if(z=x,z==".."||z==".")x="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){x=z.lastIndexOf("/",0)==0,z=z.split("/");const K=[];for(let ae=0;ae<z.length;){const Ne=z[ae++];Ne=="."?x&&ae==z.length&&K.push(""):Ne==".."?((K.length>1||K.length==1&&K[0]!="")&&K.pop(),x&&ae==z.length&&K.push("")):(K.push(Ne),x=!0)}x=K.join("/")}else x=z}return w?_.h=x:w=h.i.toString()!=="",w?Bs(_,oc(h.i)):w=!!h.m,w&&(_.m=h.m),_};function $n(h){return new Ir(h)}function Hi(h,_,w){h.j=w?Gi(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function Er(h,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);h.u=_}else h.u=null}function Bs(h,_,w){_ instanceof Me?(h.i=_,la(h.i,h.l)):(w||(_=Ki(_,om)),h.i=new Me(_,h.l))}function qe(h,_,w){h.i.set(_,w)}function ss(h){return qe(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Gi(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ki(h,_,w){return typeof h=="string"?(h=encodeURI(h).replace(_,Zl),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Zl(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var ec=/[#\/\?@]/g,tc=/[#\?:]/g,Qi=/[#\?]/g,om=/[#\?@]/g,nc=/#/g;function Me(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function Tr(h){h.g||(h.g=new Map,h.h=0,h.i&&Pn(h.i,function(_,w){h.add(decodeURIComponent(_.replace(/\+/g," ")),w)}))}n=Me.prototype,n.add=function(h,_){Tr(this),this.i=null,h=xr(this,h);let w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(_),this.h+=1,this};function rc(h,_){Tr(h),_=xr(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function aa(h,_){return Tr(h),_=xr(h,_),h.g.has(_)}n.forEach=function(h,_){Tr(this),this.g.forEach(function(w,x){w.forEach(function(z){h.call(_,z,x,this)},this)},this)};function sc(h,_){Tr(h);let w=[];if(typeof _=="string")aa(h,_)&&(w=w.concat(h.g.get(xr(h,_))));else for(h=Array.from(h.g.values()),_=0;_<h.length;_++)w=w.concat(h[_]);return w}n.set=function(h,_){return Tr(this),this.i=null,h=xr(this,h),aa(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},n.get=function(h,_){return h?(h=sc(this,h),h.length>0?String(h[0]):_):_};function ic(h,_,w){rc(h,_),w.length>0&&(h.i=null,h.g.set(xr(h,_),A(w)),h.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(let x=0;x<_.length;x++){var w=_[x];const z=wr(w);w=sc(this,w);for(let K=0;K<w.length;K++){let ae=z;w[K]!==""&&(ae+="="+wr(w[K])),h.push(ae)}}return this.i=h.join("&")};function oc(h){const _=new Me;return _.i=h.i,h.g&&(_.g=new Map(h.g),_.h=h.h),_}function xr(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function la(h,_){_&&!h.j&&(Tr(h),h.i=null,h.g.forEach(function(w,x){const z=x.toLowerCase();x!=z&&(rc(this,x),ic(this,z,w))},h)),h.j=_}function Sr(h,_){const w=new Ms;if(l.Image){const x=new Image;x.onload=v(Ht,w,"TestLoadImage: loaded",!0,_,x),x.onerror=v(Ht,w,"TestLoadImage: error",!1,_,x),x.onabort=v(Ht,w,"TestLoadImage: abort",!1,_,x),x.ontimeout=v(Ht,w,"TestLoadImage: timeout",!1,_,x),l.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=h}else _(!1)}function Ar(h,_){const w=new Ms,x=new AbortController,z=setTimeout(()=>{x.abort(),Ht(w,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:x.signal}).then(K=>{clearTimeout(z),K.ok?Ht(w,"TestPingServer: ok",!0,_):Ht(w,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(z),Ht(w,"TestPingServer: error",!1,_)})}function Ht(h,_,w,x,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),x(w)}catch{}}function Ji(){this.g=new Ui}function is(h){this.i=h.Sb||null,this.h=h.ab||!1}I(is,js),is.prototype.g=function(){return new Rn(this.i,this.h)};function Rn(h,_){kt.call(this),this.H=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}I(Rn,kt),n=Rn.prototype,n.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=_,this.readyState=1,sr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(_.body=h),(this.H||l).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,zs(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,sr(this)),this.g&&(this.readyState=3,sr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ih(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ih(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?zs(this):sr(this),this.readyState==3&&Ih(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,zs(this))},n.Na=function(h){this.g&&(this.response=h,zs(this))},n.ga=function(){this.g&&zs(this)};function zs(h){h.readyState=4,h.l=null,h.j=null,h.B=null,sr(h)}n.setRequestHeader=function(h,_){this.A.append(h,_)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var w=_.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=_.next();return h.join(`\r
`)};function sr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Rn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Eh(h){let _="";return we(h,function(w,x){_+=x,_+=":",_+=w,_+=`\r
`}),_}function ca(h,_,w){e:{for(x in w){var x=!1;break e}x=!0}x||(w=Eh(w),typeof h=="string"?w!=null&&wr(w):qe(h,_,w))}function Ye(h){kt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}I(Ye,kt);var Th=/^https?$/i,am=["POST","PUT"];n=Ye.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,_,w,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mh.g(),this.g.onreadystatechange=E(g(this.Ca,this));try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(K){Ws(this,K);return}if(h=w||"",w=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var z in x)w.set(z,x[z]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const K of x.keys())w.set(K,x.get(K));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(w.keys()).find(K=>K.toLowerCase()=="content-type"),z=l.FormData&&h instanceof l.FormData,!(Array.prototype.indexOf.call(am,_,void 0)>=0)||x||z||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,ae]of w)this.g.setRequestHeader(K,ae);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(K){Ws(this,K)}};function Ws(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.o=5,qs(h),as(h)}function qs(h){h.A||(h.A=!0,It(h,"complete"),It(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,It(this,"complete"),It(this,"abort"),as(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),as(this,!0)),Ye.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?os(this):this.Xa())},n.Xa=function(){os(this)};function os(h){if(h.h&&typeof a<"u"){if(h.v&&Cr(h)==4)setTimeout(h.Ca.bind(h),0);else if(It(h,"readystatechange"),Cr(h)==4){h.h=!1;try{const K=h.ca();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var w;if(!(w=_)){var x;if(x=K===0){let ae=String(h.D).match(wh)[1]||null;!ae&&l.self&&l.self.location&&(ae=l.self.location.protocol.slice(0,-1)),x=!Th.test(ae?ae.toLowerCase():"")}w=x}if(w)It(h,"complete"),It(h,"success");else{h.o=6;try{var z=Cr(h)>2?h.g.statusText:""}catch{z=""}h.l=z+" ["+h.ca()+"]",qs(h)}}finally{as(h)}}}}function as(h,_){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const w=h.g;h.g=null,_||It(h,"ready");try{w.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Cr(h){return h.g?h.g.readyState:0}n.ca=function(){try{return Cr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),ch(_)}};function xh(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ac(h){const _={};h=(h.g&&Cr(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<h.length;x++){if(k(h[x]))continue;var w=ra(h[x]);const z=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const K=_[z]||[];_[z]=K,K.push(w)}me(_,function(x){return x.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function kr(h,_,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||_}function ua(h){this.za=0,this.i=[],this.j=new Ms,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=kr("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=kr("baseRetryDelayMs",5e3,h),this.Za=kr("retryDelaySeedMs",1e4,h),this.Ta=kr("forwardChannelMaxRetries",2,h),this.va=kr("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new ia(h&&h.concurrentRequestLimit),this.Ba=new Ji,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ua.prototype,n.ka=8,n.I=1,n.connect=function(h,_,w,x){gt(0),this.W=h,this.H=_||{},w&&x!==void 0&&(this.H.OSID=w,this.H.OAID=x),this.F=this.X,this.J=cc(this,null,this.W),ls(this)};function ha(h){if(da(h),h.I==3){var _=h.V++,w=$n(h.J);if(qe(w,"SID",h.M),qe(w,"RID",_),qe(w,"TYPE","terminate"),Nr(h,w),_=new qn(h,h.j,_),_.M=2,_.A=ss($n(w)),w=!1,l.navigator&&l.navigator.sendBeacon)try{w=l.navigator.sendBeacon(_.A.toString(),"")}catch{}!w&&l.Image&&(new Image().src=_.A,w=!0),w||(_.g=Ah(_.j,null),_.g.ea(_.A)),_.F=Date.now(),zi(_)}Zi(h)}function bn(h){h.g&&(Xi(h),h.g.cancel(),h.g=null)}function da(h){bn(h),h.v&&(l.clearTimeout(h.v),h.v=null),fa(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&l.clearTimeout(h.m),h.m=null)}function ls(h){if(!Yl(h.h)&&!h.m){h.m=!0;var _=h.Ea;he||S(),Q||(he(),Q=!0),P.add(_,h),h.D=0}}function Sh(h,_){return qi(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=_.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Os(g(h.Ea,h,_),pa(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const z=new qn(this,this.j,h);let K=this.o;if(this.U&&(K?(K=b(K),Se(K,this.U)):K=this.U),this.u!==null||this.R||(z.J=K,K=null),this.S)e:{for(var _=0,w=0;w<this.i.length;w++){t:{var x=this.i[w];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(_+=x,_>4096){_=w;break e}if(_===4096||w===this.i.length-1){_=w+1;break e}}_=1e3}else _=1e3;_=lc(this,z,_),w=$n(this.J),qe(w,"RID",h),qe(w,"CVER",22),this.G&&qe(w,"X-HTTP-Session-Id",this.G),Nr(this,w),K&&(this.R?_="headers="+wr(Eh(K))+"&"+_:this.u&&ca(w,this.u,K)),oa(this.h,z),this.Ra&&qe(w,"TYPE","init"),this.S?(qe(w,"$req",_),qe(w,"SID","null"),z.U=!0,rr(z,w,null)):rr(z,w,_),this.I=2}}else this.I==3&&(h?Yi(this,h):this.i.length==0||Yl(this.h)||Yi(this))};function Yi(h,_){var w;_?w=_.l:w=h.V++;const x=$n(h.J);qe(x,"SID",h.M),qe(x,"RID",w),qe(x,"AID",h.K),Nr(h,x),h.u&&h.o&&ca(x,h.u,h.o),w=new qn(h,h.j,w,h.D+1),h.u===null&&(w.J=h.o),_&&(h.i=_.G.concat(h.i)),_=lc(h,w,1e3),w.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),oa(h.h,w),rr(w,x,_)}function Nr(h,_){h.H&&we(h.H,function(w,x){qe(_,x,w)}),h.l&&we({},function(w,x){qe(_,x,w)})}function lc(h,_,w){w=Math.min(h.i.length,w);const x=h.l?g(h.l.Ka,h.l,h):null;e:{var z=h.i;let Ne=-1;for(;;){const Et=["count="+w];Ne==-1?w>0?(Ne=z[0].g,Et.push("ofs="+Ne)):Ne=0:Et.push("ofs="+Ne);let Ge=!0;for(let Nt=0;Nt<w;Nt++){var K=z[Nt].g;const jn=z[Nt].map;if(K-=Ne,K<0)Ne=Math.max(0,z[Nt].g-100),Ge=!1;else try{K="req"+K+"_"||"";try{var ae=jn instanceof Map?jn:Object.entries(jn);for(const[cs,Rr]of ae){let br=Rr;d(Rr)&&(br=Ds(Rr)),Et.push(K+cs+"="+encodeURIComponent(br))}}catch(cs){throw Et.push(K+"type="+encodeURIComponent("_badmap")),cs}}catch{x&&x(jn)}}if(Ge){ae=Et.join("&");break e}}ae=void 0}return h=h.i.splice(0,w),_.G=h,ae}function en(h){if(!h.g&&!h.v){h.Y=1;var _=h.Da;he||S(),Q||(he(),Q=!0),P.add(_,h),h.A=0}}function Pr(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Os(g(h.Da,h),pa(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,$s(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Os(g(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gt(10),bn(this),$s(this))};function Xi(h){h.B!=null&&(l.clearTimeout(h.B),h.B=null)}function $s(h){h.g=new qn(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var _=$n(h.na);qe(_,"RID","rpc"),qe(_,"SID",h.M),qe(_,"AID",h.K),qe(_,"CI",h.F?"0":"1"),!h.F&&h.ia&&qe(_,"TO",h.ia),qe(_,"TYPE","xmlhttp"),Nr(h,_),h.u&&h.o&&ca(_,h.u,h.o),h.O&&(h.g.H=h.O);var w=h.g;h=h.ba,w.M=1,w.A=ss($n(_)),w.u=null,w.R=!0,Ql(w,h)}n.Va=function(){this.C!=null&&(this.C=null,bn(this),Pr(this),gt(19))};function fa(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function ma(h,_){var w=null;if(h.g==_){fa(h),Xi(h),h.g=null;var x=2}else if(Xl(h.h,_))w=_.G,$i(h.h,_),x=1;else return;if(h.I!=0){if(_.o)if(x==1){w=_.u?_.u.length:0,_=Date.now()-_.F;var z=h.D;x=Ls(),It(x,new Gl(x,w)),ls(h)}else en(h);else if(z=_.m,z==3||z==0&&_.X>0||!(x==1&&Sh(h,_)||x==2&&Pr(h)))switch(w&&w.length>0&&(_=h.h,_.i=_.i.concat(w)),z){case 1:Dn(h,5);break;case 4:Dn(h,10);break;case 3:Dn(h,6);break;default:Dn(h,2)}}}function pa(h,_){let w=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(w*=2),w*_}function Dn(h,_){if(h.j.info("Error code "+_),_==2){var w=g(h.bb,h),x=h.Ua;const z=!x;x=new Ir(x||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Hi(x,"https"),ss(x),z?Sr(x.toString(),w):Ar(x.toString(),w)}else gt(2);h.I=0,h.l&&h.l.pa(_),Zi(h),da(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Zi(h){if(h.I=0,h.ja=[],h.l){const _=Nn(h.h);(_.length!=0||h.i.length!=0)&&(O(h.ja,_),O(h.ja,h.i),h.h.i.length=0,A(h.i),h.i.length=0),h.l.oa()}}function cc(h,_,w){var x=w instanceof Ir?$n(w):new Ir(w);if(x.g!="")_&&(x.g=_+"."+x.g),Er(x,x.u);else{var z=l.location;x=z.protocol,_=_?_+"."+z.hostname:z.hostname,z=+z.port;const K=new Ir(null);x&&Hi(K,x),_&&(K.g=_),z&&Er(K,z),w&&(K.h=w),x=K}return w=h.G,_=h.wa,w&&_&&qe(x,w,_),qe(x,"VER",h.ka),Nr(h,x),x}function Ah(h,_,w){if(_&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Aa&&!h.ma?new Ye(new is({ab:w})):new Ye(h.ma),_.Fa(h.L),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ch(){}n=Ch.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ga(){}ga.prototype.g=function(h,_){return new Gt(h,_)};function Gt(h,_){kt.call(this),this.g=new ua(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(h?h["X-WebChannel-Client-Profile"]=_.sa:h={"X-WebChannel-Client-Profile":_.sa}),this.g.U=h,(h=_&&_.Qb)&&!k(h)&&(this.g.u=h),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!k(_)&&(this.g.G=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new Hs(this)}I(Gt,kt),Gt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gt.prototype.close=function(){ha(this.g)},Gt.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.v&&(w={},w.__data__=Ds(h),h=w);_.i.push(new im(_.Ya++,h)),_.I==3&&ls(_)},Gt.prototype.N=function(){this.g.l=null,delete this.j,ha(this.g),delete this.g,Gt.Z.N.call(this)};function kh(h){ea.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const w in _){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}I(kh,ea);function Nh(){Hl.call(this),this.status=1}I(Nh,Hl);function Hs(h){this.g=h}I(Hs,Ch),Hs.prototype.ra=function(){It(this.g,"a")},Hs.prototype.qa=function(h){It(this.g,new kh(h))},Hs.prototype.pa=function(h){It(this.g,new Nh)},Hs.prototype.oa=function(){It(this.g,"b")},ga.prototype.createWebChannel=ga.prototype.g,Gt.prototype.send=Gt.prototype.o,Gt.prototype.open=Gt.prototype.m,Gt.prototype.close=Gt.prototype.close,A1=function(){return new ga},S1=function(){return Ls()},x1=nr,ug={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Fs.NO_ERROR=0,Fs.TIMEOUT=8,Fs.HTTP_ERROR=6,Vd=Fs,Us.COMPLETE="complete",T1=Us,uh.EventType=Vs,Vs.OPEN="a",Vs.CLOSE="b",Vs.ERROR="c",Vs.MESSAGE="d",kt.prototype.listen=kt.prototype.J,Qc=uh,Ye.prototype.listenOnce=Ye.prototype.K,Ye.prototype.getLastError=Ye.prototype.Ha,Ye.prototype.getLastErrorCode=Ye.prototype.ya,Ye.prototype.getStatus=Ye.prototype.ca,Ye.prototype.getResponseJson=Ye.prototype.La,Ye.prototype.getResponseText=Ye.prototype.la,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Fa,E1=Ye}).apply(typeof xd<"u"?xd:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qt.UNAUTHENTICATED=new qt(null),qt.GOOGLE_CREDENTIALS=new qt("google-credentials-uid"),qt.FIRST_PARTY=new qt("first-party-uid"),qt.MOCK_USER=new qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bl="12.8.0";function ER(n){bl=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new If("@firebase/firestore");function $a(){return Si.logLevel}function TR(n){Si.setLogLevel(n)}function te(n,...e){if(Si.logLevel<=De.DEBUG){const t=e.map(yy);Si.debug(`Firestore (${bl}): ${n}`,...t)}}function xt(n,...e){if(Si.logLevel<=De.ERROR){const t=e.map(yy);Si.error(`Firestore (${bl}): ${n}`,...t)}}function Jr(n,...e){if(Si.logLevel<=De.WARN){const t=e.map(yy);Si.warn(`Firestore (${bl}): ${n}`,...t)}}function yy(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,C1(n,r,t)}function C1(n,e,t){let r=`FIRESTORE (${bl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw xt(r),new Error(r)}function ye(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||C1(e,i,r)}function xR(n,e){n||de(57014,e)}function ue(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends gn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(qt.UNAUTHENTICATED)))}shutdown(){}}class AR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class CR{constructor(e){this.t=e,this.currentUser=qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ye(this.o===void 0,42304);let r=this.i;const i=m=>this.i!==r?(r=this.i,t(m)):Promise.resolve();let a=new Xt;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Xt,e.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const m=a;e.enqueueRetryable((async()=>{await m.promise,await i(this.currentUser)}))},d=m=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((m=>d(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?d(m):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Xt)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ye(typeof r.accessToken=="string",31837,{l:r}),new k1(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string",2055,{h:e}),new qt(e)}}class kR{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=qt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class NR{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new kR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(qt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class S0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class PR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,lt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ye(this.o===void 0,3512);const r=a=>{a.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,te("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const i=a=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>i(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new S0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ye(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new S0(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=RR(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%62))}return r}}function ke(n,e){return n<e?-1:n>e?1:0}function hg(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),a=e.charAt(r);if(i!==a)return qp(i)===qp(a)?ke(i,a):qp(i)?1:-1}return ke(n.length,e.length)}const bR=55296,DR=57343;function qp(n){const e=n.charCodeAt(0);return e>=bR&&e<=DR}function ll(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function N1(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A0="__name__";class Or{constructor(e,t,r){t===void 0?t=0:t>e.length&&de(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&de(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Or.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Or?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=Or.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return ke(e.length,t.length)}static compareSegments(e,t){const r=Or.isNumericId(e),i=Or.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Or.extractNumericId(e).compare(Or.extractNumericId(t)):hg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _i.fromString(e.substring(4,e.length-2))}}class je extends Or{construct(e,t,r){return new je(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Z(G.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new je(t)}static emptyPath(){return new je([])}}const jR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Or{construct(e,t,r){return new ct(e,t,r)}static isValidIdentifier(e){return jR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===A0}static keyField(){return new ct([A0])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(r.length===0)throw new Z(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const d=e[i];if(d==="\\"){if(i+1===e.length)throw new Z(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[i+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Z(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,i+=2}else d==="`"?(l=!l,i++):d!=="."||l?(r+=d,i++):(a(),i++)}if(a(),l)throw new Z(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(t)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(je.fromString(e))}static fromName(e){return new le(je.fromString(e).popFirst(5))}static empty(){return new le(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return je.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new je(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(n,e,t){if(!t)throw new Z(G.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function P1(n,e,t,r){if(e===!0&&r===!0)throw new Z(G.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function C0(n){if(!le.isDocumentKey(n))throw new Z(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function k0(n){if(le.isDocumentKey(n))throw new Z(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function R1(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Df(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":de(12329,{type:typeof n})}function We(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Z(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Df(n);throw new Z(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function b1(n,e){if(e<=0)throw new Z(G.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Hu(n,e){if(!R1(n))throw new Z(G.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(i&&typeof l!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new Z(G.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0=-62135596800,P0=1e6;class He{static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*P0);return new He(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Z(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Z(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<N0)throw new Z(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/P0}_compareTo(e){return this.seconds===e.seconds?ke(this.nanoseconds,e.nanoseconds):ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:He._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Hu(e,He._jsonSchema))return new He(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-N0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}He._jsonSchemaVersion="firestore/timestamp/1.0",He._jsonSchema={type:Dt("string",He._jsonSchemaVersion),seconds:Dt("number"),nanoseconds:Dt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new He(0,0))}static max(){return new Ie(new He(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl=-1;class tf{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function dg(n){return n.fields.find((e=>e.kind===2))}function po(n){return n.fields.filter((e=>e.kind!==2))}tf.UNKNOWN_ID=-1;class Ld{constructor(e,t){this.fieldPath=e,this.kind=t}}class Eu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Eu(0,Wn.min())}}function D1(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ie.fromTimestamp(r===1e9?new He(t+1,0):new He(t,r));return new Wn(i,le.empty(),e)}function j1(n){return new Wn(n.readTime,n.key,cl)}class Wn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Wn(Ie.min(),le.empty(),cl)}static max(){return new Wn(Ie.max(),le.empty(),cl)}}function wy(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=le.comparator(n.documentKey,e.documentKey),t!==0?t:ke(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class L1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ji(n){if(n.code!==G.FAILED_PRECONDITION||n.message!==V1)throw n;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&de(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new F(((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof F?t:F.resolve(t)}catch(t){return F.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):F.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):F.reject(t)}static resolve(e){return new F(((t,r)=>{t(e)}))}static reject(e){return new F(((t,r)=>{r(e)}))}static waitFor(e){return new F(((t,r)=>{let i=0,a=0,l=!1;e.forEach((d=>{++i,d.next((()=>{++a,l&&a===i&&t()}),(m=>r(m)))})),l=!0,a===i&&t()}))}static or(e){let t=F.resolve(!1);for(const r of e)t=t.next((i=>i?F.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,a)=>{r.push(t.call(this,i,a))})),this.waitFor(r)}static mapArray(e,t){return new F(((r,i)=>{const a=e.length,l=new Array(a);let d=0;for(let m=0;m<a;m++){const g=m;t(e[g]).next((v=>{l[g]=v,++d,d===a&&r(l)}),(v=>i(v)))}}))}static doWhile(e,t){return new F(((r,i)=>{const a=()=>{e()===!0?t().next((()=>{a()}),i):r()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn="SimpleDb";class jf{static open(e,t,r,i){try{return new jf(t,e.transaction(i,r))}catch(a){throw new ou(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Xt,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ou(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Iy(r.target.error);this.S.reject(new ou(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(te(Fn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new LR(t)}}class Hr{static delete(e){return te(Fn,"Removing database:",e),yo(zg().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!pu())return!1;if(Hr.F())return!0;const e=mt(),t=Hr.M(e),r=0<t&&t<10,i=O1(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Hr.M(mt())===12.2&&xt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(te(Fn,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const l=a.target.result;t(l)},i.onblocked=()=>{r(new ou(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const l=a.target.error;l.name==="VersionError"?r(new Z(G.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new Z(G.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new ou(e,l))},i.onupgradeneeded=a=>{te(Fn,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,i.transaction,a.oldVersion,this.version).next((()=>{te(Fn,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const d=jf.open(this.db,e,a?"readonly":"readwrite",r),m=i(d).next((g=>(d.C(),g))).catch((g=>(d.abort(g),F.reject(g)))).toPromise();return m.catch((()=>{})),await d.D,m}catch(d){const m=d,g=m.name!=="FirebaseError"&&l<3;if(te(Fn,"Transaction failed with error:",m.message,"Retrying:",g),this.close(),!g)return Promise.reject(m)}}}close(){this.db&&this.db.close(),this.db=void 0}}function O1(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class VR{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return yo(this.U.delete())}}class ou extends Z{constructor(e,t){super(G.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Vi(n){return n.name==="IndexedDbTransactionError"}class LR{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(te(Fn,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(te(Fn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),yo(r)}add(e){return te(Fn,"ADD",this.store.name,e,e),yo(this.store.add(e))}get(e){return yo(this.store.get(e)).next((t=>(t===void 0&&(t=null),te(Fn,"GET",this.store.name,e,t),t)))}delete(e){return te(Fn,"DELETE",this.store.name,e),yo(this.store.delete(e))}count(){return te(Fn,"COUNT",this.store.name),yo(this.store.count())}H(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(r.range);return new F(((l,d)=>{a.onerror=m=>{d(m.target.error)},a.onsuccess=m=>{l(m.target.result)}}))}{const a=this.cursor(r),l=[];return this.J(a,((d,m)=>{l.push(m)})).next((()=>l))}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new F(((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}}))}X(e,t){te(Fn,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const i=this.cursor(r);return this.J(i,((a,l,d)=>d.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.J(i,t)}te(e){const t=this.cursor({});return new F(((r,i)=>{t.onerror=a=>{const l=Iy(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():r()})):r()}}))}J(e,t){const r=[];return new F(((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void i();const m=new VR(d),g=t(d.primaryKey,d.value,m);if(g instanceof F){const v=g.catch((I=>(m.done(),F.reject(I))));r.push(v)}m.isDone?i():m.G===null?d.continue():d.continue(m.G)}})).next((()=>F.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function yo(n){return new F(((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Iy(r.target.error);t(i)}}))}let R0=!1;function Iy(n){const e=Hr.M(mt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return R0||(R0=!0,setTimeout((()=>{throw r}),0)),r}}return n}const au="IndexBackfiller";class OR{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){te(au,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();te(au,`Documents written: ${t}`)}catch(t){Vi(t)?te(au,"Ignoring IndexedDB error during index backfill: ",t):await ji(t)}await this.re(6e4)}))}}class MR{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let i=t,a=!0;return F.doWhile((()=>a===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!r.has(l))return te(au,`Processing collection: ${l}`),this.oe(e,l,i).next((d=>{i-=d,r.add(l)}));a=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(i,a))).next((d=>(te(au,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,a)=>{const l=j1(a);wy(l,r)>0&&(r=l)})),new Wn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}An.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi=-1;function Gu(n){return n==null}function Tu(n){return n===0&&1/n==-1/0}function M1(n){return typeof n=="number"&&Number.isInteger(n)&&!Tu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf="";function cn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=b0(e)),e=FR(n.get(t),e);return b0(e)}function FR(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="";break;case nf:t+="";break;default:t+=a}}return t}function b0(n){return n+nf+""}function qr(n){const e=n.length;if(ye(e>=2,64408,{path:n}),e===2)return ye(n.charAt(0)===nf&&n.charAt(1)==="",56145,{path:n}),je.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf(nf,a);switch((l<0||l>t)&&de(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(a,l);let m;i.length===0?m=d:(i+=d,m=i,i=""),r.push(m);break;case"":i+=n.substring(a,l),i+="\0";break;case"":i+=n.substring(a,l+1);break;default:de(61167,{path:n})}a=l+2}return new je(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go="remoteDocuments",Ku="owner",Fa="owner",xu="mutationQueues",UR="userId",hr="mutations",D0="batchId",xo="userMutationsIndex",j0=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Od(n,e){return[n,cn(e)]}function F1(n,e,t){return[n,cn(e),t]}const BR={},ul="documentMutations",rf="remoteDocumentsV14",zR=["prefixPath","collectionGroup","readTime","documentId"],Md="documentKeyIndex",WR=["prefixPath","collectionGroup","documentId"],U1="collectionGroupIndex",qR=["collectionGroup","readTime","prefixPath","documentId"],Su="remoteDocumentGlobal",fg="remoteDocumentGlobalKey",hl="targets",B1="queryTargetsIndex",$R=["canonicalId","targetId"],dl="targetDocuments",HR=["targetId","path"],Ey="documentTargetsIndex",GR=["path","targetId"],sf="targetGlobalKey",No="targetGlobal",Au="collectionParents",KR=["collectionId","parent"],fl="clientMetadata",QR="clientId",Vf="bundles",JR="bundleId",Lf="namedQueries",YR="name",Ty="indexConfiguration",XR="indexId",mg="collectionGroupIndex",ZR="collectionGroup",lu="indexState",eb=["indexId","uid"],z1="sequenceNumberIndex",tb=["uid","sequenceNumber"],cu="indexEntries",nb=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],W1="documentKeyIndex",rb=["indexId","uid","orderedDocumentKey"],Of="documentOverlays",sb=["userId","collectionPath","documentId"],pg="collectionPathOverlayIndex",ib=["userId","collectionPath","largestBatchId"],q1="collectionGroupOverlayIndex",ob=["userId","collectionGroup","largestBatchId"],xy="globals",ab="name",$1=[xu,hr,ul,go,hl,Ku,No,dl,fl,Su,Au,Vf,Lf],lb=[...$1,Of],H1=[xu,hr,ul,rf,hl,Ku,No,dl,fl,Su,Au,Vf,Lf,Of],G1=H1,Sy=[...G1,Ty,lu,cu],cb=Sy,K1=[...Sy,xy],ub=K1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg extends L1{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Mt(n,e){const t=ue(n);return Hr.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Li(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Q1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e,t){this.comparator=e,this.root=t||Jt.EMPTY}insert(e,t){return new tt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Jt.BLACK,null,null))}remove(e){return new tt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sd(this.root,e,this.comparator,!0)}}class Sd{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Jt{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Jt.RED,this.left=i??Jt.EMPTY,this.right=a??Jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Jt(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Jt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw de(43730,{key:this.key,value:this.value});if(this.right.isRed())throw de(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw de(27949);return e+(this.isRed()?0:1)}}Jt.EMPTY=null,Jt.RED=!0,Jt.BLACK=!1;Jt.EMPTY=new class{constructor(){this.size=0}get key(){throw de(57766)}get value(){throw de(16141)}get color(){throw de(16727)}get left(){throw de(29726)}get right(){throw de(36894)}copy(e,t,r,i,a){return this}insert(e,t,r){return new Jt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.comparator=e,this.data=new tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new L0(this.data.getIterator())}getIteratorFrom(e){return new L0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Qe)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qe(this.comparator);return t.data=e,t}}class L0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ua(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new Cn([])}unionWith(e){let t=new Qe(ct.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Cn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ll(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hb(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new J1("Invalid base64 string: "+a):a}})(e);return new _t(t)}static fromUint8Array(e){const t=(function(i){let a="";for(let l=0;l<i.length;++l)a+=String.fromCharCode(i[l]);return a})(e);return new _t(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_t.EMPTY_BYTE_STRING=new _t("");const db=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ts(n){if(ye(!!n,39018),typeof n=="string"){let e=0;const t=db.exec(n);if(ye(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:at(n.seconds),nanos:at(n.nanos)}}function at(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function xs(n){return typeof n=="string"?_t.fromBase64String(n):_t.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1="server_timestamp",X1="__type__",Z1="__previous_value__",eT="__local_write_time__";function Mf(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[X1])==null?void 0:r.stringValue)===Y1}function Ff(n){const e=n.mapValue.fields[Z1];return Mf(e)?Ff(e):e}function Cu(n){const e=Ts(n.mapValue.fields[eT].timestampValue);return new He(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e,t,r,i,a,l,d,m,g,v,I){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=m,this.useFetchStreams=g,this.isUsingEmulator=v,this.apiKey=I}}const yg="(default)";class Ai{constructor(e,t){this.projectId=e,this.database=t||yg}static empty(){return new Ai("","")}get isDefaultDatabase(){return this.database===yg}isEqual(e){return e instanceof Ai&&e.projectId===this.projectId&&e.database===this.database}}function mb(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Z(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ai(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="__type__",tT="__max__",mi={mapValue:{fields:{__type__:{stringValue:tT}}}},Cy="__vector__",ml="value",Fd={nullValue:"NULL_VALUE"};function Ci(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Mf(n)?4:nT(n)?9007199254740991:Uf(n)?10:11:de(28295,{value:n})}function Yr(n,e){if(n===e)return!0;const t=Ci(n);if(t!==Ci(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Cu(n).isEqual(Cu(e));case 3:return(function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const l=Ts(i.timestampValue),d=Ts(a.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,a){return xs(i.bytesValue).isEqual(xs(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,a){return at(i.geoPointValue.latitude)===at(a.geoPointValue.latitude)&&at(i.geoPointValue.longitude)===at(a.geoPointValue.longitude)})(n,e);case 2:return(function(i,a){if("integerValue"in i&&"integerValue"in a)return at(i.integerValue)===at(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const l=at(i.doubleValue),d=at(a.doubleValue);return l===d?Tu(l)===Tu(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return ll(n.arrayValue.values||[],e.arrayValue.values||[],Yr);case 10:case 11:return(function(i,a){const l=i.mapValue.fields||{},d=a.mapValue.fields||{};if(V0(l)!==V0(d))return!1;for(const m in l)if(l.hasOwnProperty(m)&&(d[m]===void 0||!Yr(l[m],d[m])))return!1;return!0})(n,e);default:return de(52216,{left:n})}}function ku(n,e){return(n.values||[]).find((t=>Yr(t,e)))!==void 0}function ki(n,e){if(n===e)return 0;const t=Ci(n),r=Ci(e);if(t!==r)return ke(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ke(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const d=at(a.integerValue||a.doubleValue),m=at(l.integerValue||l.doubleValue);return d<m?-1:d>m?1:d===m?0:isNaN(d)?isNaN(m)?0:-1:1})(n,e);case 3:return O0(n.timestampValue,e.timestampValue);case 4:return O0(Cu(n),Cu(e));case 5:return hg(n.stringValue,e.stringValue);case 6:return(function(a,l){const d=xs(a),m=xs(l);return d.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const d=a.split("/"),m=l.split("/");for(let g=0;g<d.length&&g<m.length;g++){const v=ke(d[g],m[g]);if(v!==0)return v}return ke(d.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const d=ke(at(a.latitude),at(l.latitude));return d!==0?d:ke(at(a.longitude),at(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return M0(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var E,A,O,U;const d=a.fields||{},m=l.fields||{},g=(E=d[ml])==null?void 0:E.arrayValue,v=(A=m[ml])==null?void 0:A.arrayValue,I=ke(((O=g==null?void 0:g.values)==null?void 0:O.length)||0,((U=v==null?void 0:v.values)==null?void 0:U.length)||0);return I!==0?I:M0(g,v)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===mi.mapValue&&l===mi.mapValue)return 0;if(a===mi.mapValue)return 1;if(l===mi.mapValue)return-1;const d=a.fields||{},m=Object.keys(d),g=l.fields||{},v=Object.keys(g);m.sort(),v.sort();for(let I=0;I<m.length&&I<v.length;++I){const E=hg(m[I],v[I]);if(E!==0)return E;const A=ki(d[m[I]],g[v[I]]);if(A!==0)return A}return ke(m.length,v.length)})(n.mapValue,e.mapValue);default:throw de(23264,{he:t})}}function O0(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ke(n,e);const t=Ts(n),r=Ts(e),i=ke(t.seconds,r.seconds);return i!==0?i:ke(t.nanos,r.nanos)}function M0(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const a=ki(t[i],r[i]);if(a)return a}return ke(t.length,r.length)}function pl(n){return _g(n)}function _g(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Ts(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return xs(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return le.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const a of t.values||[])i?i=!1:r+=",",r+=_g(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const l of r)a?a=!1:i+=",",i+=`${l}:${_g(t.fields[l])}`;return i+"}"})(n.mapValue):de(61005,{value:n})}function Ud(n){switch(Ci(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ff(n);return e?16+Ud(e):16;case 5:return 2*n.stringValue.length;case 6:return xs(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,a)=>i+Ud(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Li(r.fields,((a,l)=>{i+=a.length+Ud(l)})),i})(n.mapValue);default:throw de(13486,{value:n})}}function Do(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function vg(n){return!!n&&"integerValue"in n}function Nu(n){return!!n&&"arrayValue"in n}function F0(n){return!!n&&"nullValue"in n}function U0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Bd(n){return!!n&&"mapValue"in n}function Uf(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Ay])==null?void 0:r.stringValue)===Cy}function uu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Li(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=uu(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=uu(n.arrayValue.values[t]);return e}return{...n}}function nT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===tT}const rT={mapValue:{fields:{[Ay]:{stringValue:Cy},[ml]:{arrayValue:{}}}}};function pb(n){return"nullValue"in n?Fd:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Do(Ai.empty(),le.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Uf(n)?rT:{mapValue:{}}:de(35942,{value:n})}function gb(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Do(Ai.empty(),le.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?rT:"mapValue"in n?Uf(n)?{mapValue:{}}:mi:de(61959,{value:n})}function B0(n,e){const t=ki(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function z0(n,e){const t=ki(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.value=e}static empty(){return new Yt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Bd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=uu(t)}setAll(e){let t=ct.emptyPath(),r={},i=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const m=this.getFieldsMap(t);this.applyChanges(m,r,i),r={},i=[],t=d.popLast()}l?r[d.lastSegment()]=uu(l):i.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());Bd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Yr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Bd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Li(t,((i,a)=>e[i]=a));for(const i of r)delete e[i]}clone(){return new Yt(uu(this.value))}}function sT(n){const e=[];return Li(n.fields,((t,r)=>{const i=new ct([t]);if(Bd(r)){const a=sT(r.mapValue).fields;if(a.length===0)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)})),new Cn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,t,r,i,a,l,d){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new it(e,0,Ie.min(),Ie.min(),Ie.min(),Yt.empty(),0)}static newFoundDocument(e,t,r,i){return new it(e,1,t,Ie.min(),r,i,0)}static newNoDocument(e,t){return new it(e,2,t,Ie.min(),Ie.min(),Yt.empty(),0)}static newUnknownDocument(e,t){return new it(e,3,t,Ie.min(),Ie.min(),Yt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof it&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new it(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e,t){this.position=e,this.inclusive=t}}function W0(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(a.field.isKeyField()?r=le.comparator(le.fromName(l.referenceValue),t.key):r=ki(l,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function q0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Yr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,t="asc"){this.field=e,this.dir=t}}function yb(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{}class Oe extends iT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new _b(e,t,r):t==="array-contains"?new Ib(e,r):t==="in"?new hT(e,r):t==="not-in"?new Eb(e,r):t==="array-contains-any"?new Tb(e,r):new Oe(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new vb(e,r):new wb(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ki(t,this.value)):t!==null&&Ci(this.value)===Ci(t)&&this.matchesComparison(ki(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ke extends iT{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ke(e,t)}matches(e){return gl(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gl(n){return n.op==="and"}function wg(n){return n.op==="or"}function ky(n){return oT(n)&&gl(n)}function oT(n){for(const e of n.filters)if(e instanceof Ke)return!1;return!0}function Ig(n){if(n instanceof Oe)return n.field.canonicalString()+n.op.toString()+pl(n.value);if(ky(n))return n.filters.map((e=>Ig(e))).join(",");{const e=n.filters.map((t=>Ig(t))).join(",");return`${n.op}(${e})`}}function aT(n,e){return n instanceof Oe?(function(r,i){return i instanceof Oe&&r.op===i.op&&r.field.isEqual(i.field)&&Yr(r.value,i.value)})(n,e):n instanceof Ke?(function(r,i){return i instanceof Ke&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((a,l,d)=>a&&aT(l,i.filters[d])),!0):!1})(n,e):void de(19439)}function lT(n,e){const t=n.filters.concat(e);return Ke.create(t,n.op)}function cT(n){return n instanceof Oe?(function(t){return`${t.field.canonicalString()} ${t.op} ${pl(t.value)}`})(n):n instanceof Ke?(function(t){return t.op.toString()+" {"+t.getFilters().map(cT).join(" ,")+"}"})(n):"Filter"}class _b extends Oe{constructor(e,t,r){super(e,t,r),this.key=le.fromName(r.referenceValue)}matches(e){const t=le.comparator(e.key,this.key);return this.matchesComparison(t)}}class vb extends Oe{constructor(e,t){super(e,"in",t),this.keys=uT("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class wb extends Oe{constructor(e,t){super(e,"not-in",t),this.keys=uT("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function uT(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>le.fromName(r.referenceValue)))}class Ib extends Oe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Nu(t)&&ku(t.arrayValue,this.value)}}class hT extends Oe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ku(this.value.arrayValue,t)}}class Eb extends Oe{constructor(e,t){super(e,"not-in",t)}matches(e){if(ku(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ku(this.value.arrayValue,t)}}class Tb extends Oe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Nu(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>ku(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e,t=null,r=[],i=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=d,this.Te=null}}function Eg(n,e=null,t=[],r=[],i=null,a=null,l=null){return new xb(n,e,t,r,i,a,l)}function jo(n){const e=ue(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Ig(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Gu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>pl(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>pl(r))).join(",")),e.Te=t}return e.Te}function Qu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!yb(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!aT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!q0(n.startAt,e.startAt)&&q0(n.endAt,e.endAt)}function of(n){return le.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function af(n,e){return n.filters.filter((t=>t instanceof Oe&&t.field.isEqual(e)))}function $0(n,e,t){let r=Fd,i=!0;for(const a of af(n,e)){let l=Fd,d=!0;switch(a.op){case"<":case"<=":l=pb(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=Fd}B0({value:r,inclusive:i},{value:l,inclusive:d})<0&&(r=l,i=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];B0({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}}return{value:r,inclusive:i}}function H0(n,e,t){let r=mi,i=!0;for(const a of af(n,e)){let l=mi,d=!0;switch(a.op){case">=":case">":l=gb(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=mi}z0({value:r,inclusive:i},{value:l,inclusive:d})>0&&(r=l,i=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];z0({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,t=null,r=[],i=[],a=null,l="F",d=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=m,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function dT(n,e,t,r,i,a,l,d){return new Cs(n,e,t,r,i,a,l,d)}function Dl(n){return new Cs(n)}function G0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Sb(n){return le.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ny(n){return n.collectionGroup!==null}function tl(n){const e=ue(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new Qe(ct.comparator);return l.filters.forEach((m=>{m.getFlattenedFilters().forEach((g=>{g.isInequality()&&(d=d.add(g.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Pu(a,r))})),t.has(ct.keyField().canonicalString())||e.Ie.push(new Pu(ct.keyField(),r))}return e.Ie}function yn(n){const e=ue(n);return e.Ee||(e.Ee=Ab(e,tl(n))),e.Ee}function Ab(n,e){if(n.limitType==="F")return Eg(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const a=i.dir==="desc"?"asc":"desc";return new Pu(i.field,a)}));const t=n.endAt?new Ni(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ni(n.startAt.position,n.startAt.inclusive):null;return Eg(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Tg(n,e){const t=n.filters.concat([e]);return new Cs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Cb(n,e){const t=n.explicitOrderBy.concat([e]);return new Cs(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function lf(n,e,t){return new Cs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function kb(n,e){return new Cs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function Nb(n,e){return new Cs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function Ju(n,e){return Qu(yn(n),yn(e))&&n.limitType===e.limitType}function fT(n){return`${jo(yn(n))}|lt:${n.limitType}`}function Ha(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>cT(i))).join(", ")}]`),Gu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>pl(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>pl(i))).join(",")),`Target(${r})`})(yn(n))}; limitType=${n.limitType})`}function Yu(n,e){return e.isFoundDocument()&&(function(r,i){const a=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):le.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,i){for(const a of tl(r))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const a of r.filters)if(!a.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(l,d,m){const g=W0(l,d,m);return l.inclusive?g<=0:g<0})(r.startAt,tl(r),i)||r.endAt&&!(function(l,d,m){const g=W0(l,d,m);return l.inclusive?g>=0:g>0})(r.endAt,tl(r),i))})(n,e)}function mT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pT(n){return(e,t)=>{let r=!1;for(const i of tl(n)){const a=Pb(i,e,t);if(a!==0)return a;r=r||i.field.isKeyField()}return 0}}function Pb(n,e,t){const r=n.field.isKeyField()?le.comparator(e.key,t.key):(function(a,l,d){const m=l.data.field(a),g=d.data.field(a);return m!==null&&g!==null?ki(m,g):de(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return de(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,a]of r)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Li(this.inner,((t,r)=>{for(const[i,a]of r)e(i,a)}))}isEmpty(){return Q1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb=new tt(le.comparator);function kn(){return Rb}const gT=new tt(le.comparator);function Jc(...n){let e=gT;for(const t of n)e=e.insert(t.key,t);return e}function yT(n){let e=gT;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function $r(){return hu()}function _T(){return hu()}function hu(){return new ks((n=>n.toString()),((n,e)=>n.isEqual(e)))}const bb=new tt(le.comparator),Db=new Qe(le.comparator);function Pe(...n){let e=Db;for(const t of n)e=e.add(t);return e}const jb=new Qe(ke);function Py(){return jb}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ry(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tu(e)?"-0":e}}function vT(n){return{integerValue:""+n}}function wT(n,e){return M1(e)?vT(e):Ry(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(){this._=void 0}}function Vb(n,e,t){return n instanceof yl?(function(i,a){const l={fields:{[X1]:{stringValue:Y1},[eT]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Mf(a)&&(a=Ff(a)),a&&(l.fields[Z1]=a),{mapValue:l}})(t,e):n instanceof Vo?ET(n,e):n instanceof Lo?TT(n,e):(function(i,a){const l=IT(i,a),d=K0(l)+K0(i.Ae);return vg(l)&&vg(i.Ae)?vT(d):Ry(i.serializer,d)})(n,e)}function Lb(n,e,t){return n instanceof Vo?ET(n,e):n instanceof Lo?TT(n,e):t}function IT(n,e){return n instanceof _l?(function(r){return vg(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class yl extends Bf{}class Vo extends Bf{constructor(e){super(),this.elements=e}}function ET(n,e){const t=xT(e);for(const r of n.elements)t.some((i=>Yr(i,r)))||t.push(r);return{arrayValue:{values:t}}}class Lo extends Bf{constructor(e){super(),this.elements=e}}function TT(n,e){let t=xT(e);for(const r of n.elements)t=t.filter((i=>!Yr(i,r)));return{arrayValue:{values:t}}}class _l extends Bf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function K0(n){return at(n.integerValue||n.doubleValue)}function xT(n){return Nu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,t){this.field=e,this.transform=t}}function Ob(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Vo&&i instanceof Vo||r instanceof Lo&&i instanceof Lo?ll(r.elements,i.elements,Yr):r instanceof _l&&i instanceof _l?Yr(r.Ae,i.Ae):r instanceof yl&&i instanceof yl})(n.transform,e.transform)}class Mb{constructor(e,t){this.version=e,this.transformResults=t}}class ut{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ut}static exists(e){return new ut(void 0,e)}static updateTime(e){return new ut(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class zf{}function ST(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Vl(n.key,ut.none()):new jl(n.key,n.data,ut.none());{const t=n.data,r=Yt.empty();let i=new Qe(ct.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?r.delete(a):r.set(a,l),i=i.add(a)}return new Ns(n.key,r,new Cn(i.toArray()),ut.none())}}function Fb(n,e,t){n instanceof jl?(function(i,a,l){const d=i.value.clone(),m=J0(i.fieldTransforms,a,l.transformResults);d.setAll(m),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Ns?(function(i,a,l){if(!zd(i.precondition,a))return void a.convertToUnknownDocument(l.version);const d=J0(i.fieldTransforms,a,l.transformResults),m=a.data;m.setAll(AT(i)),m.setAll(d),a.convertToFoundDocument(l.version,m).setHasCommittedMutations()})(n,e,t):(function(i,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function du(n,e,t,r){return n instanceof jl?(function(a,l,d,m){if(!zd(a.precondition,l))return d;const g=a.value.clone(),v=Y0(a.fieldTransforms,m,l);return g.setAll(v),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ns?(function(a,l,d,m){if(!zd(a.precondition,l))return d;const g=Y0(a.fieldTransforms,m,l),v=l.data;return v.setAll(AT(a)),v.setAll(g),l.convertToFoundDocument(l.version,v).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((I=>I.field)))})(n,e,t,r):(function(a,l,d){return zd(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function Ub(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=IT(r.transform,i||null);a!=null&&(t===null&&(t=Yt.empty()),t.set(r.field,a))}return t||null}function Q0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ll(r,i,((a,l)=>Ob(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class jl extends zf{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ns extends zf{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function AT(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function J0(n,e,t){const r=new Map;ye(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,d=e.data.field(a.field);r.set(a.field,Lb(l,d,t[i]))}return r}function Y0(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,Vb(a,l,e))}return r}class Vl extends zf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class by extends zf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&Fb(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=du(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=du(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=_T();return this.mutations.forEach((i=>{const a=e.get(i.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(i.key)?null:d;const m=ST(l,d);m!==null&&r.set(i.key,m),l.isValidDocument()||l.convertToNoDocument(Ie.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Pe())}isEqual(e){return this.batchId===e.batchId&&ll(this.mutations,e.mutations,((t,r)=>Q0(t,r)))&&ll(this.baseMutations,e.baseMutations,((t,r)=>Q0(t,r)))}}class jy{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ye(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return bb})();const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new jy(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,Fe;function CT(n){switch(n){case G.OK:return de(64938);case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0;default:return de(15467,{code:n})}}function kT(n){if(n===void 0)return xt("GRPC error has no .code"),G.UNKNOWN;switch(n){case Rt.OK:return G.OK;case Rt.CANCELLED:return G.CANCELLED;case Rt.UNKNOWN:return G.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return G.INTERNAL;case Rt.UNAVAILABLE:return G.UNAVAILABLE;case Rt.UNAUTHENTICATED:return G.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case Rt.NOT_FOUND:return G.NOT_FOUND;case Rt.ALREADY_EXISTS:return G.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return G.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case Rt.ABORTED:return G.ABORTED;case Rt.OUT_OF_RANGE:return G.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return G.UNIMPLEMENTED;case Rt.DATA_LOSS:return G.DATA_LOSS;default:return de(39323,{code:n})}}(Fe=Rt||(Rt={}))[Fe.OK=0]="OK",Fe[Fe.CANCELLED=1]="CANCELLED",Fe[Fe.UNKNOWN=2]="UNKNOWN",Fe[Fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fe[Fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fe[Fe.NOT_FOUND=5]="NOT_FOUND",Fe[Fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fe[Fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fe[Fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fe[Fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fe[Fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fe[Fe.ABORTED=10]="ABORTED",Fe[Fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fe[Fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fe[Fe.INTERNAL=13]="INTERNAL",Fe[Fe.UNAVAILABLE=14]="UNAVAILABLE",Fe[Fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb=new _i([4294967295,4294967295],0);function X0(n){const e=NT().encode(n),t=new I1;return t.update(e),new Uint8Array(t.digest())}function Z0(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new _i([t,r],0),new _i([i,a],0)]}class Ly{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Yc(`Invalid padding: ${t}`);if(r<0)throw new Yc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Yc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Yc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=_i.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(_i.fromNumber(r)));return i.compare(zb)===1&&(i=new _i([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=X0(e),[r,i]=Z0(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,i,a);if(!this.we(l))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new Ly(a,i,t);return r.forEach((d=>l.insert(d))),l}insert(e){if(this.ge===0)return;const t=X0(e),[r,i]=Z0(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(r,i,a);this.be(l)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Yc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,eh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Zu(Ie.min(),i,new tt(ke),kn(),Pe())}}class eh{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new eh(r,t,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}}class PT{constructor(e,t){this.targetId=e,this.Ce=t}}class RT{constructor(e,t,r=_t.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class eI{constructor(){this.ve=0,this.Fe=tI(),this.Me=_t.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pe(),t=Pe(),r=Pe();return this.Fe.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:de(38017,{changeType:a})}})),new eh(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=tI()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,ye(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class Wb{constructor(e){this.Ge=e,this.ze=new Map,this.je=kn(),this.He=Ad(),this.Je=Ad(),this.Ze=new tt(ke)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:de(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const a=i.target;if(of(a))if(r===0){const l=new le(a.path);this.et(t,l,it.newNoDocument(l,Ie.min()))}else ye(r===1,20013,{expectedCount:r});else{const l=this._t(t);if(l!==r){const d=this.ut(e),m=d?this.ct(d,e,l):1;if(m!==0){this.it(t);const g=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:a=0}=t;let l,d;try{l=xs(r).toUint8Array()}catch(m){if(m instanceof J1)return Jr("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{d=new Ly(l,i,a)}catch(m){return Jr(m instanceof Yc?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return d.ge===0?null:d}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((a=>{const l=this.Ge.ht(),d=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.et(t,a,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const d=this.ot(l);if(d){if(a.current&&of(d.target)){const m=new le(d.target.path);this.It(m).has(l)||this.Et(l,m)||this.et(l,m,it.newNoDocument(m,e))}a.Be&&(t.set(l,a.ke()),a.Ke())}}));let r=Pe();this.Je.forEach(((a,l)=>{let d=!0;l.forEachWhile((m=>{const g=this.ot(m);return!g||g.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const i=new Zu(e,t,this.Ze,this.je,r);return this.je=kn(),this.He=Ad(),this.Je=Ad(),this.Ze=new tt(ke),i}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new eI,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Qe(ke),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Qe(ke),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||te("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new eI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Ad(){return new tt(le.comparator)}function tI(){return new tt(le.comparator)}const qb={asc:"ASCENDING",desc:"DESCENDING"},$b={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Hb={and:"AND",or:"OR"};class Gb{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xg(n,e){return n.useProto3Json||Gu(e)?e:{value:e}}function vl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Kb(n,e){return vl(n,e.toTimestamp())}function St(n){return ye(!!n,49232),Ie.fromTimestamp((function(t){const r=Ts(t);return new He(r.seconds,r.nanos)})(n))}function Oy(n,e){return Sg(n,e).canonicalString()}function Sg(n,e){const t=(function(i){return new je(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function DT(n){const e=je.fromString(n);return ye(WT(e),10190,{key:e.toString()}),e}function Ru(n,e){return Oy(n.databaseId,e.path)}function Gr(n,e){const t=DT(e);if(t.get(1)!==n.databaseId.projectId)throw new Z(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Z(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new le(LT(t))}function jT(n,e){return Oy(n.databaseId,e)}function VT(n){const e=DT(n);return e.length===4?je.emptyPath():LT(e)}function Ag(n){return new je(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function LT(n){return ye(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function nI(n,e,t){return{name:Ru(n,e),fields:t.value.mapValue.fields}}function OT(n,e,t){const r=Gr(n,e.name),i=St(e.updateTime),a=e.createTime?St(e.createTime):Ie.min(),l=new Yt({mapValue:{fields:e.fields}}),d=it.newFoundDocument(r,i,a,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function Qb(n,e){return"found"in e?(function(r,i){ye(!!i.found,43571),i.found.name,i.found.updateTime;const a=Gr(r,i.found.name),l=St(i.found.updateTime),d=i.found.createTime?St(i.found.createTime):Ie.min(),m=new Yt({mapValue:{fields:i.found.fields}});return it.newFoundDocument(a,l,d,m)})(n,e):"missing"in e?(function(r,i){ye(!!i.missing,3894),ye(!!i.readTime,22933);const a=Gr(r,i.missing),l=St(i.readTime);return it.newNoDocument(a,l)})(n,e):de(7234,{result:e})}function Jb(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:de(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=(function(g,v){return g.useProto3Json?(ye(v===void 0||typeof v=="string",58123),_t.fromBase64String(v||"")):(ye(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),_t.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(g){const v=g.code===void 0?G.UNKNOWN:kT(g.code);return new Z(v,g.message||"")})(l);t=new RT(r,i,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Gr(n,r.document.name),a=St(r.document.updateTime),l=r.document.createTime?St(r.document.createTime):Ie.min(),d=new Yt({mapValue:{fields:r.document.fields}}),m=it.newFoundDocument(i,a,l,d),g=r.targetIds||[],v=r.removedTargetIds||[];t=new Wd(g,v,m.key,m)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Gr(n,r.document),a=r.readTime?St(r.readTime):Ie.min(),l=it.newNoDocument(i,a),d=r.removedTargetIds||[];t=new Wd([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Gr(n,r.document),a=r.removedTargetIds||[];t=new Wd([],a,i,null)}else{if(!("filter"in e))return de(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:a}=r,l=new Bb(i,a),d=r.targetId;t=new PT(d,l)}}return t}function bu(n,e){let t;if(e instanceof jl)t={update:nI(n,e.key,e.value)};else if(e instanceof Vl)t={delete:Ru(n,e.key)};else if(e instanceof Ns)t={update:nI(n,e.key,e.data),updateMask:nD(e.fieldMask)};else{if(!(e instanceof by))return de(16599,{dt:e.type});t={verify:Ru(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,l){const d=l.transform;if(d instanceof yl)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Vo)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Lo)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof _l)return{fieldPath:l.field.canonicalString(),increment:d.Ae};throw de(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,a){return a.updateTime!==void 0?{updateTime:Kb(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:de(27497)})(n,e.precondition)),t}function Cg(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?ut.updateTime(St(a.updateTime)):a.exists!==void 0?ut.exists(a.exists):ut.none()})(e.currentDocument):ut.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(l,d){let m=null;if("setToServerValue"in d)ye(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),m=new yl;else if("appendMissingElements"in d){const v=d.appendMissingElements.values||[];m=new Vo(v)}else if("removeAllFromArray"in d){const v=d.removeAllFromArray.values||[];m=new Lo(v)}else"increment"in d?m=new _l(l,d.increment):de(16584,{proto:d});const g=ct.fromServerFormat(d.fieldPath);return new Xu(g,m)})(n,i))):[];if(e.update){e.update.name;const i=Gr(n,e.update.name),a=new Yt({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(m){const g=m.fieldPaths||[];return new Cn(g.map((v=>ct.fromServerFormat(v))))})(e.updateMask);return new Ns(i,a,l,t,r)}return new jl(i,a,t,r)}if(e.delete){const i=Gr(n,e.delete);return new Vl(i,t)}if(e.verify){const i=Gr(n,e.verify);return new by(i,t)}return de(1463,{proto:e})}function Yb(n,e){return n&&n.length>0?(ye(e!==void 0,14353),n.map((t=>(function(i,a){let l=i.updateTime?St(i.updateTime):St(a);return l.isEqual(Ie.min())&&(l=St(a)),new Mb(l,i.transformResults||[])})(t,e)))):[]}function MT(n,e){return{documents:[jT(n,e.path)]}}function FT(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=jT(n,i);const a=(function(g){if(g.length!==0)return zT(Ke.create(g,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(g){if(g.length!==0)return g.map((v=>(function(E){return{field:Ga(E.field),direction:Zb(E.dir)}})(v)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=xg(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:i}}function UT(n){let e=VT(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){ye(r===1,65062);const v=t.from[0];v.allDescendants?i=v.collectionId:e=e.child(v.collectionId)}let a=[];t.where&&(a=(function(I){const E=BT(I);return E instanceof Ke&&ky(E)?E.getFilters():[E]})(t.where));let l=[];t.orderBy&&(l=(function(I){return I.map((E=>(function(O){return new Pu(Ka(O.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(O.direction))})(E)))})(t.orderBy));let d=null;t.limit&&(d=(function(I){let E;return E=typeof I=="object"?I.value:I,Gu(E)?null:E})(t.limit));let m=null;t.startAt&&(m=(function(I){const E=!!I.before,A=I.values||[];return new Ni(A,E)})(t.startAt));let g=null;return t.endAt&&(g=(function(I){const E=!I.before,A=I.values||[];return new Ni(A,E)})(t.endAt)),dT(e,i,l,a,d,"F",m,g)}function Xb(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function BT(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ka(t.unaryFilter.field);return Oe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ka(t.unaryFilter.field);return Oe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ka(t.unaryFilter.field);return Oe.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Ka(t.unaryFilter.field);return Oe.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return de(61313);default:return de(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Oe.create(Ka(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return de(58110);default:return de(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ke.create(t.compositeFilter.filters.map((r=>BT(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return de(1026)}})(t.compositeFilter.op))})(n):de(30097,{filter:n})}function Zb(n){return qb[n]}function eD(n){return $b[n]}function tD(n){return Hb[n]}function Ga(n){return{fieldPath:n.canonicalString()}}function Ka(n){return ct.fromServerFormat(n.fieldPath)}function zT(n){return n instanceof Oe?(function(t){if(t.op==="=="){if(U0(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NAN"}};if(F0(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(U0(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NOT_NAN"}};if(F0(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ga(t.field),op:eD(t.op),value:t.value}}})(n):n instanceof Ke?(function(t){const r=t.getFilters().map((i=>zT(i)));return r.length===1?r[0]:{compositeFilter:{op:tD(t.op),filters:r}}})(n):de(54877,{filter:n})}function nD(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function WT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function qT(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,t,r,i,a=Ie.min(),l=Ie.min(),d=_t.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=m}withSequenceNumber(e){return new vs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e){this.yt=e}}function rD(n,e){let t;if(e.document)t=OT(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=le.fromSegments(e.noDocument.path),i=Mo(e.noDocument.readTime);t=it.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return de(56709);{const r=le.fromSegments(e.unknownDocument.path),i=Mo(e.unknownDocument.version);t=it.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){const a=new He(i[0],i[1]);return Ie.fromTimestamp(a)})(e.readTime)),t}function rI(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:cf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,l){return{name:Ru(a,l.key),fields:l.data.value.mapValue.fields,updateTime:vl(a,l.version.toTimestamp()),createTime:vl(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Oo(e.version)};else{if(!e.isUnknownDocument())return de(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Oo(e.version)}}return r}function cf(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Oo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Mo(n){const e=new He(n.seconds,n.nanoseconds);return Ie.fromTimestamp(e)}function _o(n,e){const t=(e.baseMutations||[]).map((a=>Cg(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>Cg(n.yt,a))),i=He.fromMillis(e.localWriteTimeMs);return new Dy(e.batchId,i,t,r)}function Xc(n){const e=Mo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Mo(n.lastLimboFreeSnapshotVersion):Ie.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return ye(l===1,1966,{count:l}),yn(Dl(VT(a.documents[0])))})(n.query):(function(a){return yn(UT(a))})(n.query),new vs(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,_t.fromBase64String(n.resumeToken))}function HT(n,e){const t=Oo(e.snapshotVersion),r=Oo(e.lastLimboFreeSnapshotVersion);let i;i=of(e.target)?MT(n.yt,e.target):FT(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:jo(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function My(n){const e=UT({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lf(e,e.limit,"L"):e}function $p(n,e){return new Vy(e.largestBatchId,Cg(n.yt,e.overlayMutation))}function sI(n,e){const t=e.path.lastSegment();return[n,cn(e.path.popLast()),t]}function iI(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Oo(r.readTime),documentKey:cn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{getBundleMetadata(e,t){return oI(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:Mo(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return oI(e).put((function(i){return{bundleId:i.id,createTime:Oo(St(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return aI(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:My(a.bundledQuery),readTime:Mo(a.readTime)}})(r)}))}saveNamedQuery(e,t){return aI(e).put((function(i){return{name:i.name,readTime:Oo(St(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function oI(n){return Mt(n,Vf)}function aI(n){return Mt(n,Lf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Wf(e,r)}getOverlay(e,t){return Uc(e).get(sI(this.userId,t)).next((r=>r?$p(this.serializer,r):null))}getOverlays(e,t){const r=$r();return F.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){const i=[];return r.forEach(((a,l)=>{const d=new Vy(t,l);i.push(this.bt(e,d))})),F.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach((l=>i.add(cn(l.getCollectionPath()))));const a=[];return i.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(Uc(e).X(pg,d))})),F.waitFor(a)}getOverlaysForCollection(e,t,r){const i=$r(),a=cn(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Uc(e).H(pg,l).next((d=>{for(const m of d){const g=$p(this.serializer,m);i.set(g.getKey(),g)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){const a=$r();let l;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Uc(e).ee({index:q1,range:d},((m,g,v)=>{const I=$p(this.serializer,g);a.size()<i||I.largestBatchId===l?(a.set(I.getKey(),I),l=I.largestBatchId):v.done()})).next((()=>a))}bt(e,t){return Uc(e).put((function(i,a,l){const[d,m,g]=sI(a,l.mutation.key);return{userId:a,collectionPath:m,documentId:g,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:bu(i.yt,l.mutation)}})(this.serializer,this.userId,t))}}function Uc(n){return Mt(n,Of)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{St(e){return Mt(e,xy)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?_t.fromUint8Array(r):_t.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(at(e.integerValue));else if("doubleValue"in e){const r=at(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Tu(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Ts(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(xs(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?nT(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Uf(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):de(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const r=e.fields||{};this.Ft(t,55);for(const i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){var l,d;const r=e.fields||{};this.Ft(t,53);const i=ml,a=((d=(l=r[i].arrayValue)==null?void 0:l.values)==null?void 0:d.length)||0;this.Ft(t,15),t.Mt(at(a)),this.Ot(i,t),this.Ct(r[i],t)}qt(e,t){const r=e.values||[];this.Ft(t,50);for(const i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),le.fromName(e).path.forEach((r=>{this.Ft(t,60),this.$t(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}vo.Wt=new vo;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba=255;function oD(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function lI(n){const e=64-(function(r){let i=0;for(let a=0;a<8;++a){const l=oD(255&r[a]);if(i+=l,l!==8)break}return i})(n);return Math.ceil(e/8)}class aD{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const i=t.codePointAt(0);this.Ht(240|i>>>18),this.Ht(128|63&i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i)}}this.Jt()}Yt(e){const t=this.en(e),r=lI(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),r=lI(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Ba),this.sn(255)}_n(){this.an(Ba),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ba?(this.sn(Ba),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ba?(this.an(Ba),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class lD{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class cD{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Bc{constructor(){this.cn=new aD,this.ascending=new lD(this.cn),this.descending=new cD(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,t,r,i){this.hn=e,this.Pn=t,this.Tn=r,this.In=i}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new wo(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:qd(this.Tn),directionalValue:qd(this.In),orderedDocumentKey:qd(t),documentKey:r.path.toArray()}}An(e,t,r){const i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function li(n,e){let t=n.hn-e.hn;return t!==0?t:(t=cI(n.Tn,e.Tn),t!==0?t:(t=cI(n.In,e.In),t!==0?t:le.comparator(n.Pn,e.Pn)))}function cI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function qd(n){return lE()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function uI(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}class hI{constructor(e){this.Vn=new Qe(((t,r)=>ct.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(ye(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=dg(e);if(t!==void 0&&!this.pn(t))return!1;const r=po(e);let i=new Set,a=0,l=0;for(;a<r.length&&this.pn(r[a]);++a)i=i.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!i.has(d.field.canonicalString())){const m=r[a];if(!this.yn(d,m)||!this.wn(this.dn[l++],m))return!1}++a}for(;a<r.length;++a){const d=r[a];if(l>=this.dn.length||!this.wn(this.dn[l++],d))return!1}return!0}bn(){if(this.fn)return null;let e=new Qe(ct.comparator);const t=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Ld(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ld(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ld(r.field,r.dir==="asc"?0:1)));return new tf(tf.UNKNOWN_ID,this.collectionId,t,Eu.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GT(n){var t,r;if(ye(n instanceof Oe||n instanceof Ke,20012),n instanceof Oe){if(n instanceof hT){const i=((r=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:r.map((a=>Oe.create(n.field,"==",a))))||[];return Ke.create(i,"or")}return n}const e=n.filters.map((i=>GT(i)));return Ke.create(e,n.op)}function uD(n){if(n.getFilters().length===0)return[];const e=Pg(GT(n));return ye(KT(e),7391),kg(e)||Ng(e)?[e]:e.getFilters()}function kg(n){return n instanceof Oe}function Ng(n){return n instanceof Ke&&ky(n)}function KT(n){return kg(n)||Ng(n)||(function(t){if(t instanceof Ke&&wg(t)){for(const r of t.getFilters())if(!kg(r)&&!Ng(r))return!1;return!0}return!1})(n)}function Pg(n){if(ye(n instanceof Oe||n instanceof Ke,34018),n instanceof Oe)return n;if(n.filters.length===1)return Pg(n.filters[0]);const e=n.filters.map((r=>Pg(r)));let t=Ke.create(e,n.op);return t=uf(t),KT(t)?t:(ye(t instanceof Ke,64498),ye(gl(t),40251),ye(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Fy(r,i))))}function Fy(n,e){let t;return ye(n instanceof Oe||n instanceof Ke,38388),ye(e instanceof Oe||e instanceof Ke,25473),t=n instanceof Oe?e instanceof Oe?(function(i,a){return Ke.create([i,a],"and")})(n,e):dI(n,e):e instanceof Oe?dI(e,n):(function(i,a){if(ye(i.filters.length>0&&a.filters.length>0,48005),gl(i)&&gl(a))return lT(i,a.getFilters());const l=wg(i)?i:a,d=wg(i)?a:i,m=l.filters.map((g=>Fy(g,d)));return Ke.create(m,"or")})(n,e),uf(t)}function dI(n,e){if(gl(e))return lT(e,n.getFilters());{const t=e.filters.map((r=>Fy(n,r)));return Ke.create(t,"or")}}function uf(n){if(ye(n instanceof Oe||n instanceof Ke,11850),n instanceof Oe)return n;const e=n.getFilters();if(e.length===1)return uf(e[0]);if(oT(n))return n;const t=e.map((i=>uf(i))),r=[];return t.forEach((i=>{i instanceof Oe?r.push(i):i instanceof Ke&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Ke.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(){this.Sn=new Uy}addToCollectionParentIndex(e,t){return this.Sn.add(t),F.resolve()}getCollectionParents(e,t){return F.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return F.resolve()}deleteFieldIndex(e,t){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,t){return F.resolve()}getDocumentsMatchingTarget(e,t){return F.resolve(null)}getIndexType(e,t){return F.resolve(0)}getFieldIndexes(e,t){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,t){return F.resolve(Wn.min())}getMinOffsetFromCollectionGroup(e,t){return F.resolve(Wn.min())}updateCollectionGroup(e,t,r){return F.resolve()}updateIndexEntries(e,t){return F.resolve()}}class Uy{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Qe(je.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qe(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI="IndexedDbIndexManager",Cd=new Uint8Array(0);class dD{constructor(e,t){this.databaseId=t,this.Dn=new Uy,this.Cn=new ks((r=>jo(r)),((r,i)=>Qu(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const a={collectionId:r,parent:cn(i)};return mI(e).put(a)}return F.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[N1(t),""],!1,!0);return mI(e).H(i).next((a=>{for(const l of a){if(l.collectionId!==t)break;r.push(qr(l.parent))}return r}))}addFieldIndex(e,t){const r=zc(e),i=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((m=>[m.fieldPath.canonicalString(),m.kind]))}})(t);delete i.indexId;const a=r.add(i);if(t.indexState){const l=Wa(e);return a.next((d=>{l.put(iI(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=zc(e),i=Wa(e),a=za(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=zc(e),r=za(e),i=Wa(e);return t.X().next((()=>r.X())).next((()=>i.X()))}createTargetIndexes(e,t){return F.forEach(this.vn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const a=new hI(r).bn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=za(e);let i=!0;const a=new Map;return F.forEach(this.vn(t),(l=>this.Fn(e,l).next((d=>{i&&(i=!!d),a.set(l,d)})))).next((()=>{if(i){let l=Pe();const d=[];return F.forEach(a,((m,g)=>{te(fI,`Using index ${(function(W){return`id=${W.indexId}|cg=${W.collectionGroup}|f=${W.fields.map((Y=>`${Y.fieldPath}:${Y.kind}`)).join(",")}`})(m)} to execute ${jo(t)}`);const v=(function(W,Y){const he=dg(Y);if(he===void 0)return null;for(const Q of af(W,he.fieldPath))switch(Q.op){case"array-contains-any":return Q.value.arrayValue.values||[];case"array-contains":return[Q.value]}return null})(g,m),I=(function(W,Y){const he=new Map;for(const Q of po(Y))for(const P of af(W,Q.fieldPath))switch(P.op){case"==":case"in":he.set(Q.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return he.set(Q.fieldPath.canonicalString(),P.value),Array.from(he.values())}return null})(g,m),E=(function(W,Y){const he=[];let Q=!0;for(const P of po(Y)){const S=P.kind===0?$0(W,P.fieldPath,W.startAt):H0(W,P.fieldPath,W.startAt);he.push(S.value),Q&&(Q=S.inclusive)}return new Ni(he,Q)})(g,m),A=(function(W,Y){const he=[];let Q=!0;for(const P of po(Y)){const S=P.kind===0?H0(W,P.fieldPath,W.endAt):$0(W,P.fieldPath,W.endAt);he.push(S.value),Q&&(Q=S.inclusive)}return new Ni(he,Q)})(g,m),O=this.Mn(m,g,E),U=this.Mn(m,g,A),L=this.xn(m,g,I),oe=this.On(m.indexId,v,O,E.inclusive,U,A.inclusive,L);return F.forEach(oe,(J=>r.Z(J,t.limit).next((W=>{W.forEach((Y=>{const he=le.fromSegments(Y.documentKey);l.has(he)||(l=l.add(he),d.push(he))}))}))))})).next((()=>d))}return F.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=uD(Ke.create(e.filters,"and")).map((r=>Eg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,r,i,a,l,d){const m=(t!=null?t.length:1)*Math.max(r.length,a.length),g=m/(t!=null?t.length:1),v=[];for(let I=0;I<m;++I){const E=t?this.Nn(t[I/g]):Cd,A=this.Bn(e,E,r[I%g],i),O=this.Ln(e,E,a[I%g],l),U=d.map((L=>this.Bn(e,E,L,!0)));v.push(...this.createRange(A,O,U))}return v}Bn(e,t,r,i){const a=new wo(e,le.empty(),t,r);return i?a:a.En()}Ln(e,t,r,i){const a=new wo(e,le.empty(),t,r);return i?a.En():a}Fn(e,t){const r=new hI(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((a=>{let l=null;for(const d of a)r.gn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let r=2;const i=this.vn(t);return F.forEach(i,(a=>this.Fn(e,a).next((l=>{l?r!==0&&l.fields.length<(function(m){let g=new Qe(ct.comparator),v=!1;for(const I of m.filters)for(const E of I.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?v=!0:g=g.add(E.field));for(const I of m.orderBy)I.field.isKeyField()||(g=g.add(I.field));return g.size+(v?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(l){return l.limit!==null})(t)&&i.length>1&&r===2?1:r))}kn(e,t){const r=new Bc;for(const i of po(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const l=r.ln(i.kind);vo.Wt.Dt(a,l)}return r.un()}Nn(e){const t=new Bc;return vo.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const r=new Bc;return vo.Wt.Dt(Do(this.databaseId,t),r.ln((function(a){const l=po(a);return l.length===0?0:l[l.length-1].kind})(e))),r.un()}xn(e,t,r){if(r===null)return[];let i=[];i.push(new Bc);let a=0;for(const l of po(e)){const d=r[a++];for(const m of i)if(this.qn(t,l.fieldPath)&&Nu(d))i=this.Un(i,l,d);else{const g=m.ln(l.kind);vo.Wt.Dt(d,g)}}return this.$n(i)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const d of i){const m=new Bc;m.seed(d.un()),vo.Wt.Dt(l,m.ln(t.kind)),a.push(m)}return a}qn(e,t){return!!e.filters.find((r=>r instanceof Oe&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=zc(e),i=Wa(e);return(t?r.H(mg,IDBKeyRange.bound(t,t)):r.H()).next((a=>{const l=[];return F.forEach(a,(d=>i.get([d.indexId,this.uid]).next((m=>{l.push((function(v,I){const E=I?new Eu(I.sequenceNumber,new Wn(Mo(I.readTime),new le(qr(I.documentKey)),I.largestBatchId)):Eu.empty(),A=v.fields.map((([O,U])=>new Ld(ct.fromServerFormat(O),U)));return new tf(v.indexId,v.collectionGroup,A,E)})(d,m))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:ke(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const i=zc(e),a=Wa(e);return this.Wn(e).next((l=>i.H(mg,IDBKeyRange.bound(t,t)).next((d=>F.forEach(d,(m=>a.put(iI(m.indexId,this.uid,l,r))))))))}updateIndexEntries(e,t){const r=new Map;return F.forEach(t,((i,a)=>{const l=r.get(i.collectionGroup);return(l?F.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next((d=>(r.set(i.collectionGroup,d),F.forEach(d,(m=>this.Qn(e,i,m).next((g=>{const v=this.Gn(a,m);return g.isEqual(v)?F.resolve():this.zn(e,a,m,g,v)})))))))}))}jn(e,t,r,i){return za(e).put(i.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,i){return za(e).delete(i.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){const i=za(e);let a=new Qe(li);return i.ee({index:W1,range:IDBKeyRange.only([r.indexId,this.uid,qd(this.Kn(r,t))])},((l,d)=>{a=a.add(new wo(r.indexId,t,uI(d.arrayValue),uI(d.directionalValue)))})).next((()=>a))}Gn(e,t){let r=new Qe(li);const i=this.kn(t,e);if(i==null)return r;const a=dg(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Nu(l))for(const d of l.arrayValue.values||[])r=r.add(new wo(t.indexId,e.key,this.Nn(d),i))}else r=r.add(new wo(t.indexId,e.key,Cd,i));return r}zn(e,t,r,i,a){te(fI,"Updating index entries for document '%s'",t.key);const l=[];return(function(m,g,v,I,E){const A=m.getIterator(),O=g.getIterator();let U=Ua(A),L=Ua(O);for(;U||L;){let oe=!1,J=!1;if(U&&L){const W=v(U,L);W<0?J=!0:W>0&&(oe=!0)}else U!=null?J=!0:oe=!0;oe?(I(L),L=Ua(O)):J?(E(U),U=Ua(A)):(U=Ua(A),L=Ua(O))}})(i,a,li,(d=>{l.push(this.jn(e,t,r,d))}),(d=>{l.push(this.Hn(e,t,r,d))})),F.waitFor(l)}Wn(e){let t=1;return Wa(e).ee({index:z1,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,a)=>{a.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((l,d)=>li(l,d))).filter(((l,d,m)=>!d||li(l,m[d-1])!==0));const i=[];i.push(e);for(const l of r){const d=li(l,e),m=li(l,t);if(d===0)i[0]=e.En();else if(d>0&&m<0)i.push(l),i.push(l.En());else if(m>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2){if(this.Jn(i[l],i[l+1]))return[];const d=i[l].An(this.uid,Cd,le.empty()),m=i[l+1].An(this.uid,Cd,le.empty());a.push(IDBKeyRange.bound(d,m))}return a}Jn(e,t){return li(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(pI)}getMinOffset(e,t){return F.mapArray(this.vn(t),(r=>this.Fn(e,r).next((i=>i||de(44426))))).next(pI)}}function mI(n){return Mt(n,Au)}function za(n){return Mt(n,cu)}function zc(n){return Mt(n,Ty)}function Wa(n){return Mt(n,lu)}function pI(n){ye(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;wy(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Wn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},QT=41943040;class an{static withCacheSize(e){return new an(e,an.DEFAULT_COLLECTION_PERCENTILE,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(n,e,t){const r=n.store(hr),i=n.store(ul),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const m=r.ee({range:l},((v,I,E)=>(d++,E.delete())));a.push(m.next((()=>{ye(d===1,47070,{batchId:t.batchId})})));const g=[];for(const v of t.mutations){const I=F1(e,v.key.path,t.batchId);a.push(i.delete(I)),g.push(v.key)}return F.waitFor(a).next((()=>g))}function hf(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw de(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */an.DEFAULT_COLLECTION_PERCENTILE=10,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,an.DEFAULT=new an(QT,an.DEFAULT_COLLECTION_PERCENTILE,an.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),an.DISABLED=new an(-1,0,0);class qf{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Zn={}}static wt(e,t,r,i){ye(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new qf(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ci(e).ee({index:xo,range:r},((i,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,r,i){const a=Qa(e),l=ci(e);return l.add({}).next((d=>{ye(typeof d=="number",49019);const m=new Dy(d,t,r,i),g=(function(A,O,U){const L=U.baseMutations.map((J=>bu(A.yt,J))),oe=U.mutations.map((J=>bu(A.yt,J)));return{userId:O,batchId:U.batchId,localWriteTimeMs:U.localWriteTime.toMillis(),baseMutations:L,mutations:oe}})(this.serializer,this.userId,m),v=[];let I=new Qe(((E,A)=>ke(E.canonicalString(),A.canonicalString())));for(const E of i){const A=F1(this.userId,E.key.path,d);I=I.add(E.key.path.popLast()),v.push(l.put(g)),v.push(a.put(A,BR))}return I.forEach((E=>{v.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Zn[d]=m.keys()})),F.waitFor(v).next((()=>m))}))}lookupMutationBatch(e,t){return ci(e).get(t).next((r=>r?(ye(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),_o(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?F.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const i=r.keys();return this.Zn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return ci(e).ee({index:xo,range:i},((l,d,m)=>{d.userId===this.userId&&(ye(d.batchId>=r,47524,{Yn:r}),a=_o(this.serializer,d)),m.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=vi;return ci(e).ee({index:xo,range:t,reverse:!0},((i,a,l)=>{r=a.batchId,l.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,vi],[this.userId,Number.POSITIVE_INFINITY]);return ci(e).H(xo,t).next((r=>r.map((i=>_o(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Od(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Qa(e).ee({range:i},((l,d,m)=>{const[g,v,I]=l,E=qr(v);if(g===this.userId&&t.path.isEqual(E))return ci(e).get(I).next((A=>{if(!A)throw de(61480,{er:l,batchId:I});ye(A.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:A.userId,batchId:I}),a.push(_o(this.serializer,A))}));m.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qe(ke);const i=[];return t.forEach((a=>{const l=Od(this.userId,a.path),d=IDBKeyRange.lowerBound(l),m=Qa(e).ee({range:d},((g,v,I)=>{const[E,A,O]=g,U=qr(A);E===this.userId&&a.path.isEqual(U)?r=r.add(O):I.done()}));i.push(m)})),F.waitFor(i).next((()=>this.tr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=Od(this.userId,r),l=IDBKeyRange.lowerBound(a);let d=new Qe(ke);return Qa(e).ee({range:l},((m,g,v)=>{const[I,E,A]=m,O=qr(E);I===this.userId&&r.isPrefixOf(O)?O.length===i&&(d=d.add(A)):v.done()})).next((()=>this.tr(e,d)))}tr(e,t){const r=[],i=[];return t.forEach((a=>{i.push(ci(e).get(a).next((l=>{if(l===null)throw de(35274,{batchId:a});ye(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),r.push(_o(this.serializer,l))})))})),F.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return JT(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),F.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return F.resolve();const r=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),i=[];return Qa(e).ee({range:r},((a,l,d)=>{if(a[0]===this.userId){const m=qr(a[1]);i.push(m)}else d.done()})).next((()=>{ye(i.length===0,56720,{rr:i.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return YT(e,this.userId,t)}ir(e){return XT(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:vi,lastStreamToken:""}))}}function YT(n,e,t){const r=Od(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return Qa(n).ee({range:a,Y:!0},((d,m,g)=>{const[v,I,E]=d;v===e&&I===i&&(l=!0),g.done()})).next((()=>l))}function ci(n){return Mt(n,hr)}function Qa(n){return Mt(n,ul)}function XT(n){return Mt(n,xu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Fo(0)}static ar(){return new Fo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const r=new Fo(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Ie.fromTimestamp(new He(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.ur(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.cr(e,i))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>qa(e).delete(t.targetId))).next((()=>this.ur(e))).next((r=>(ye(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r))))}removeTargets(e,t,r){let i=0;const a=[];return qa(e).ee(((l,d)=>{const m=Xc(d);m.sequenceNumber<=t&&r.get(m.targetId)===null&&(i++,a.push(this.removeTargetData(e,m)))})).next((()=>F.waitFor(a))).next((()=>i))}forEachTarget(e,t){return qa(e).ee(((r,i)=>{const a=Xc(i);t(a)}))}ur(e){return yI(e).get(sf).next((t=>(ye(t!==null,2888),t)))}cr(e,t){return yI(e).put(sf,t)}lr(e,t){return qa(e).put(HT(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const r=jo(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return qa(e).ee({range:i,index:B1},((l,d,m)=>{const g=Xc(d);Qu(t,g.target)&&(a=g,m.done())})).next((()=>a))}addMatchingKeys(e,t,r){const i=[],a=di(e);return t.forEach((l=>{const d=cn(l.path);i.push(a.put({targetId:r,path:d})),i.push(this.referenceDelegate.addReference(e,r,l))})),F.waitFor(i)}removeMatchingKeys(e,t,r){const i=di(e);return F.forEach(t,(a=>{const l=cn(a.path);return F.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=di(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=di(e);let a=Pe();return i.ee({range:r,Y:!0},((l,d,m)=>{const g=qr(l[1]),v=new le(g);a=a.add(v)})).next((()=>a))}containsKey(e,t){const r=cn(t.path),i=IDBKeyRange.bound([r],[N1(r)],!1,!0);let a=0;return di(e).ee({index:Ey,Y:!0,range:i},(([l,d],m,g)=>{l!==0&&(a++,g.done())})).next((()=>a>0))}At(e,t){return qa(e).get(t).next((r=>r?Xc(r):null))}}function qa(n){return Mt(n,hl)}function yI(n){return Mt(n,No)}function di(n){return Mt(n,dl)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="LruGarbageCollector",mD=1048576;function vI([n,e],[t,r]){const i=ke(n,t);return i===0?ke(e,r):i}class pD{constructor(e){this.Pr=e,this.buffer=new Qe(vI),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();vI(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ZT{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){te(_I,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vi(t)?te(_I,"Ignoring IndexedDB error during garbage collection: ",t):await ji(t)}await this.Ar(3e5)}))}}class gD{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return F.resolve(An.ce);const r=new pD(t);return this.Vr.forEachTarget(e,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.mr(e,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(gI)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gI):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,a,l,d,m,g;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((I=>(I>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${I}`),i=this.params.maximumSequenceNumbersToCollect):i=I,l=Date.now(),this.nthSequenceNumber(e,i)))).next((I=>(r=I,d=Date.now(),this.removeTargets(e,r,t)))).next((I=>(a=I,m=Date.now(),this.removeOrphanedDocuments(e,r)))).next((I=>(g=Date.now(),$a()<=De.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-v}ms
	Determined least recently used ${i} in `+(d-l)+`ms
	Removed ${a} targets in `+(m-d)+`ms
	Removed ${I} documents in `+(g-m)+`ms
Total Duration: ${g-v}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:I}))))}}function ex(n,e){return new gD(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,t){this.db=e,this.garbageCollector=ex(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((r,i)=>t(i)))}addReference(e,t,r){return kd(e,r)}removeReference(e,t,r){return kd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return kd(e,t)}wr(e,t){return(function(i,a){let l=!1;return XT(i).te((d=>YT(i,d,a).next((m=>(m&&(l=!0),F.resolve(!m)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.yr(e,((l,d)=>{if(d<=t){const m=this.wr(e,l).next((g=>{if(!g)return a++,r.getEntry(e,l).next((()=>(r.removeEntry(l,Ie.min()),di(e).delete((function(I){return[0,cn(I.path)]})(l)))))}));i.push(m)}})).next((()=>F.waitFor(i))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return kd(e,t)}yr(e,t){const r=di(e);let i,a=An.ce;return r.ee({index:Ey},(([l,d],{path:m,sequenceNumber:g})=>{l===0?(a!==An.ce&&t(new le(qr(i)),a),a=g,i=m):a=An.ce})).next((()=>{a!==An.ce&&t(new le(qr(i)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function kd(n,e){return di(n).put((function(r,i){return{targetId:0,path:cn(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(){this.changes=new ks((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,it.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?F.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return fo(e).put(r)}removeEntry(e,t,r){return fo(e).delete((function(a,l){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],cf(l),d[d.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=it.newInvalidDocument(t);return fo(e).ee({index:Md,range:IDBKeyRange.only(Wc(t))},((i,a)=>{r=this.Sr(t,a)})).next((()=>r))}Dr(e,t){let r={size:0,document:it.newInvalidDocument(t)};return fo(e).ee({index:Md,range:IDBKeyRange.only(Wc(t))},((i,a)=>{r={document:this.Sr(t,a),size:hf(a)}})).next((()=>r))}getEntries(e,t){let r=kn();return this.Cr(e,t,((i,a)=>{const l=this.Sr(i,a);r=r.insert(i,l)})).next((()=>r))}vr(e,t){let r=kn(),i=new tt(le.comparator);return this.Cr(e,t,((a,l)=>{const d=this.Sr(a,l);r=r.insert(a,d),i=i.insert(a,hf(l))})).next((()=>({documents:r,Fr:i})))}Cr(e,t,r){if(t.isEmpty())return F.resolve();let i=new Qe(EI);t.forEach((m=>i=i.add(m)));const a=IDBKeyRange.bound(Wc(i.first()),Wc(i.last())),l=i.getIterator();let d=l.getNext();return fo(e).ee({index:Md,range:a},((m,g,v)=>{const I=le.fromSegments([...g.prefixPath,g.collectionGroup,g.documentId]);for(;d&&EI(d,I)<0;)r(d,null),d=l.getNext();d&&d.isEqual(I)&&(r(d,g),d=l.hasNext()?l.getNext():null),d?v.j(Wc(d)):v.done()})).next((()=>{for(;d;)r(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,a){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),cf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],m=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fo(e).H(IDBKeyRange.bound(d,m,!0)).next((g=>{a==null||a.incrementDocumentReadCount(g.length);let v=kn();for(const I of g){const E=this.Sr(le.fromSegments(I.prefixPath.concat(I.collectionGroup,I.documentId)),I);E.isFoundDocument()&&(Yu(t,E)||i.has(E.key))&&(v=v.insert(E.key,E))}return v}))}getAllFromCollectionGroup(e,t,r,i){let a=kn();const l=II(t,r),d=II(t,Wn.max());return fo(e).ee({index:U1,range:IDBKeyRange.bound(l,d,!0)},((m,g,v)=>{const I=this.Sr(le.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);a=a.insert(I.key,I),a.size===i&&v.done()})).next((()=>a))}newChangeBuffer(e){return new vD(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return wI(e).get(fg).next((t=>(ye(!!t,20021),t)))}br(e,t){return wI(e).put(fg,t)}Sr(e,t){if(t){const r=rD(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ie.min())))return r}return it.newInvalidDocument(e)}}function nx(n){return new _D(n)}class vD extends tx{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new ks((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const t=[];let r=0,i=new Qe(((a,l)=>ke(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const d=this.Or.get(a);if(t.push(this.Mr.removeEntry(e,a,d.readTime)),l.isValidDocument()){const m=rI(this.Mr.serializer,l);i=i.add(a.path.popLast());const g=hf(m);r+=g-d.size,t.push(this.Mr.addEntry(e,a,m))}else if(r-=d.size,this.trackRemovals){const m=rI(this.Mr.serializer,l.convertToNoDocument(Ie.min()));t.push(this.Mr.addEntry(e,a,m))}})),i.forEach((a=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Mr.updateMetadata(e,r)),F.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:r,Fr:i})=>(i.forEach(((a,l)=>{this.Or.set(a,{size:l,readTime:r.get(a).readTime})})),r)))}}function wI(n){return Mt(n,Su)}function fo(n){return Mt(n,rf)}function Wc(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function II(n,e){const t=e.documentKey.path.toArray();return[n,cf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function EI(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=ke(t[a],r[a]),i)return i;return i=ke(t.length,r.length),i||(i=ke(t[t.length-2],r[r.length-2]),i||ke(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&du(r.mutation,i,Cn.empty(),He.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Pe()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Pe()){const i=$r();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((a=>{let l=Jc();return a.forEach(((d,m)=>{l=l.insert(d,m.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=$r();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Pe())))}populateOverlays(e,t,r){const i=[];return r.forEach((a=>{t.has(a)||i.push(a)})),this.documentOverlayCache.getOverlays(e,i).next((a=>{a.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,r,i){let a=kn();const l=hu(),d=(function(){return hu()})();return t.forEach(((m,g)=>{const v=r.get(g.key);i.has(g.key)&&(v===void 0||v.mutation instanceof Ns)?a=a.insert(g.key,g):v!==void 0?(l.set(g.key,v.mutation.getFieldMask()),du(v.mutation,g,v.mutation.getFieldMask(),He.now())):l.set(g.key,Cn.empty())})),this.recalculateAndSaveOverlays(e,a).next((m=>(m.forEach(((g,v)=>l.set(g,v))),t.forEach(((g,v)=>d.set(g,new wD(v,l.get(g)??null)))),d)))}recalculateAndSaveOverlays(e,t){const r=hu();let i=new tt(((l,d)=>l-d)),a=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((m=>{const g=t.get(m);if(g===null)return;let v=r.get(m)||Cn.empty();v=d.applyToLocalView(g,v),r.set(m,v);const I=(i.get(d.batchId)||Pe()).add(m);i=i.insert(d.batchId,I)}))})).next((()=>{const l=[],d=i.getReverseIterator();for(;d.hasNext();){const m=d.getNext(),g=m.key,v=m.value,I=_T();v.forEach((E=>{if(!a.has(E)){const A=ST(t.get(E),r.get(E));A!==null&&I.set(E,A),a=a.add(E)}})),l.push(this.documentOverlayCache.saveOverlays(e,g,I))}return F.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return Sb(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ny(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):F.resolve($r());let d=cl,m=a;return l.next((g=>F.forEach(g,((v,I)=>(d<I.largestBatchId&&(d=I.largestBatchId),a.get(v)?F.resolve():this.remoteDocumentCache.getEntry(e,v).next((E=>{m=m.insert(v,E)}))))).next((()=>this.populateOverlays(e,g,a))).next((()=>this.computeViews(e,m,g,Pe()))).next((v=>({batchId:d,changes:yT(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new le(t)).next((r=>{let i=Jc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const a=t.collectionGroup;let l=Jc();return this.indexManager.getCollectionParents(e,a).next((d=>F.forEach(d,(m=>{const g=(function(I,E){return new Cs(E,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)})(t,m.child(a));return this.getDocumentsMatchingCollectionQuery(e,g,r,i).next((v=>{v.forEach(((I,E)=>{l=l.insert(I,E)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,i)))).next((l=>{a.forEach(((m,g)=>{const v=g.getKey();l.get(v)===null&&(l=l.insert(v,it.newInvalidDocument(v)))}));let d=Jc();return l.forEach(((m,g)=>{const v=a.get(m);v!==void 0&&du(v.mutation,g,Cn.empty(),He.now()),Yu(t,g)&&(d=d.insert(m,g))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return F.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:St(i.createTime)}})(t)),F.resolve()}getNamedQuery(e,t){return F.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:My(i.bundledQuery),readTime:St(i.readTime)}})(t)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(){this.overlays=new tt(le.comparator),this.Lr=new Map}getOverlay(e,t){return F.resolve(this.overlays.get(t))}getOverlays(e,t){const r=$r();return F.forEach(t,(i=>this.getOverlay(e,i).next((a=>{a!==null&&r.set(i,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,a)=>{this.bt(e,t,a)})),F.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach((a=>this.overlays=this.overlays.remove(a))),this.Lr.delete(r)),F.resolve()}getOverlaysForCollection(e,t,r){const i=$r(),a=t.length+1,l=new le(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const m=d.getNext().value,g=m.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===a&&m.largestBatchId>r&&i.set(m.getKey(),m)}return F.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new tt(((g,v)=>g-v));const l=this.overlays.getIterator();for(;l.hasNext();){const g=l.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>r){let v=a.get(g.largestBatchId);v===null&&(v=$r(),a=a.insert(g.largestBatchId,v)),v.set(g.getKey(),g)}}const d=$r(),m=a.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((g,v)=>d.set(g,v))),!(d.size()>=i)););return F.resolve(d)}bt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const l=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Vy(t,r));let a=this.Lr.get(t);a===void 0&&(a=Pe(),this.Lr.set(t,a)),this.Lr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(){this.sessionToken=_t.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(){this.kr=new Qe(Wt.Kr),this.qr=new Qe(Wt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new Wt(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new Wt(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){const t=new le(new je([])),r=new Wt(t,e),i=new Wt(t,e+1),a=[];return this.qr.forEachInRange([r,i],(l=>{this.Wr(l),a.push(l.key)})),a}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new le(new je([])),r=new Wt(t,e),i=new Wt(t,e+1);let a=Pe();return this.qr.forEachInRange([r,i],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new Wt(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Wt{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return le.comparator(e.key,t.key)||ke(e.Hr,t.Hr)}static Ur(e,t){return ke(e.Hr,t.Hr)||le.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Qe(Wt.Kr)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const a=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Dy(a,t,r,i);this.mutationQueue.push(l);for(const d of i)this.Jr=this.Jr.add(new Wt(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return F.resolve(l)}lookupMutationBatch(e,t){return F.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Xr(r),a=i<0?0:i;return F.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?vi:this.Yn-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Wt(t,0),i=new Wt(t,Number.POSITIVE_INFINITY),a=[];return this.Jr.forEachInRange([r,i],(l=>{const d=this.Zr(l.Hr);a.push(d)})),F.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Qe(ke);return t.forEach((i=>{const a=new Wt(i,0),l=new Wt(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([a,l],(d=>{r=r.add(d.Hr)}))})),F.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;le.isDocumentKey(a)||(a=a.child(""));const l=new Wt(new le(a),0);let d=new Qe(ke);return this.Jr.forEachWhile((m=>{const g=m.key.path;return!!r.isPrefixOf(g)&&(g.length===i&&(d=d.add(m.Hr)),!0)}),l),F.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((r=>{const i=this.Zr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){ye(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return F.forEach(t.mutations,(i=>{const a=new Wt(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){const r=new Wt(t,0),i=this.Jr.firstAfterOrEqual(r);return F.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e){this.ti=e,this.docs=(function(){return new tt(le.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return F.resolve(r?r.document.mutableCopy():it.newInvalidDocument(t))}getEntries(e,t){let r=kn();return t.forEach((i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():it.newInvalidDocument(i))})),F.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let a=kn();const l=t.path,d=new le(l.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(d);for(;m.hasNext();){const{key:g,value:{document:v}}=m.getNext();if(!l.isPrefixOf(g.path))break;g.path.length>l.length+1||wy(j1(v),r)<=0||(i.has(v.key)||Yu(t,v))&&(a=a.insert(v.key,v.mutableCopy()))}return F.resolve(a)}getAllFromCollectionGroup(e,t,r,i){de(9500)}ni(e,t){return F.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new AD(this)}getSize(e){return F.resolve(this.size)}}class AD extends tx{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)})),F.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e){this.persistence=e,this.ri=new ks((t=>jo(t)),Qu),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.ii=0,this.si=new By,this.targetCount=0,this.oi=Fo._r()}forEachTarget(e,t){return this.ri.forEach(((r,i)=>t(i))),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),F.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Fo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,F.resolve()}updateTargetData(e,t){return this.lr(t),F.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.ri.forEach(((l,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.ri.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),i++)})),F.waitFor(a).next((()=>i))}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return F.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),F.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((l=>{a.push(i.markPotentiallyOrphaned(e,l))})),F.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),F.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return F.resolve(r)}containsKey(e,t){return F.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e,t){this._i={},this.overlays={},this.ai=new An(0),this.ui=!1,this.ui=!0,this.ci=new TD,this.referenceDelegate=e(this),this.li=new CD(this),this.indexManager=new hD,this.remoteDocumentCache=(function(i){return new SD(i)})((r=>this.referenceDelegate.hi(r))),this.serializer=new $T(t),this.Pi=new ID(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ED,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new xD(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){te("MemoryPersistence","Starting transaction:",e);const i=new kD(this.ai.next());return this.referenceDelegate.Ti(),r(i).next((a=>this.referenceDelegate.Ii(i).next((()=>a)))).toPromise().then((a=>(i.raiseOnCommittedEvent(),a)))}Ei(e,t){return F.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}}class kD extends L1{constructor(e){super(),this.currentSequenceNumber=e}}class $f{constructor(e){this.persistence=e,this.Ri=new By,this.Ai=null}static Vi(e){return new $f(e)}get di(){if(this.Ai)return this.Ai;throw de(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),F.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),F.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((i=>this.di.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((a=>this.di.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.di,(r=>{const i=le.fromPath(r);return this.mi(e,i).next((a=>{a||t.removeEntry(i,Ie.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return F.or([()=>F.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class df{constructor(e,t){this.persistence=e,this.fi=new ks((r=>cn(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=ex(this,t)}static Vi(e,t){return new df(e,t)}Ti(){}Ii(e){return F.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return F.forEach(this.fi,((r,i)=>this.wr(e,r,i).next((a=>a?F.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ni(e,(l=>this.wr(e,l,t).next((d=>{d||(r++,a.removeEntry(l,Ie.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),F.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),F.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),F.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ud(e.data.value)),t}wr(e,t,r){return F.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.fi.get(t);return F.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.serializer=e}k(e,t,r,i){const a=new jf("createOrUpgrade",t);r<1&&i>=1&&((function(m){m.createObjectStore(Ku)})(e),(function(m){m.createObjectStore(xu,{keyPath:UR}),m.createObjectStore(hr,{keyPath:D0,autoIncrement:!0}).createIndex(xo,j0,{unique:!0}),m.createObjectStore(ul)})(e),TI(e),(function(m){m.createObjectStore(go)})(e));let l=F.resolve();return r<3&&i>=3&&(r!==0&&((function(m){m.deleteObjectStore(dl),m.deleteObjectStore(hl),m.deleteObjectStore(No)})(e),TI(e)),l=l.next((()=>(function(m){const g=m.store(No),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ie.min().toTimestamp(),targetCount:0};return g.put(sf,v)})(a)))),r<4&&i>=4&&(r!==0&&(l=l.next((()=>(function(m,g){return g.store(hr).H().next((I=>{m.deleteObjectStore(hr),m.createObjectStore(hr,{keyPath:D0,autoIncrement:!0}).createIndex(xo,j0,{unique:!0});const E=g.store(hr),A=I.map((O=>E.put(O)));return F.waitFor(A)}))})(e,a)))),l=l.next((()=>{(function(m){m.createObjectStore(fl,{keyPath:QR})})(e)}))),r<5&&i>=5&&(l=l.next((()=>this.gi(a)))),r<6&&i>=6&&(l=l.next((()=>((function(m){m.createObjectStore(Su)})(e),this.pi(a))))),r<7&&i>=7&&(l=l.next((()=>this.yi(a)))),r<8&&i>=8&&(l=l.next((()=>this.wi(e,a)))),r<9&&i>=9&&(l=l.next((()=>{(function(m){m.objectStoreNames.contains("remoteDocumentChanges")&&m.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(l=l.next((()=>this.bi(a)))),r<11&&i>=11&&(l=l.next((()=>{(function(m){m.createObjectStore(Vf,{keyPath:JR})})(e),(function(m){m.createObjectStore(Lf,{keyPath:YR})})(e)}))),r<12&&i>=12&&(l=l.next((()=>{(function(m){const g=m.createObjectStore(Of,{keyPath:sb});g.createIndex(pg,ib,{unique:!1}),g.createIndex(q1,ob,{unique:!1})})(e)}))),r<13&&i>=13&&(l=l.next((()=>(function(m){const g=m.createObjectStore(rf,{keyPath:zR});g.createIndex(Md,WR),g.createIndex(U1,qR)})(e))).next((()=>this.Si(e,a))).next((()=>e.deleteObjectStore(go)))),r<14&&i>=14&&(l=l.next((()=>this.Di(e,a)))),r<15&&i>=15&&(l=l.next((()=>(function(m){m.createObjectStore(Ty,{keyPath:XR,autoIncrement:!0}).createIndex(mg,ZR,{unique:!1}),m.createObjectStore(lu,{keyPath:eb}).createIndex(z1,tb,{unique:!1}),m.createObjectStore(cu,{keyPath:nb}).createIndex(W1,rb,{unique:!1})})(e)))),r<16&&i>=16&&(l=l.next((()=>{t.objectStore(lu).clear()})).next((()=>{t.objectStore(cu).clear()}))),r<17&&i>=17&&(l=l.next((()=>{(function(m){m.createObjectStore(xy,{keyPath:ab})})(e)}))),r<18&&i>=18&&lE()&&(l=l.next((()=>{t.objectStore(lu).clear()})).next((()=>{t.objectStore(cu).clear()}))),l}pi(e){let t=0;return e.store(go).ee(((r,i)=>{t+=hf(i)})).next((()=>{const r={byteSize:t};return e.store(Su).put(fg,r)}))}gi(e){const t=e.store(xu),r=e.store(hr);return t.H().next((i=>F.forEach(i,(a=>{const l=IDBKeyRange.bound([a.userId,vi],[a.userId,a.lastAcknowledgedBatchId]);return r.H(xo,l).next((d=>F.forEach(d,(m=>{ye(m.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:m.batchId});const g=_o(this.serializer,m);return JT(e,a.userId,g).next((()=>{}))}))))}))))}yi(e){const t=e.store(dl),r=e.store(go);return e.store(No).get(sf).next((i=>{const a=[];return r.ee(((l,d)=>{const m=new je(l),g=(function(I){return[0,cn(I)]})(m);a.push(t.get(g).next((v=>v?F.resolve():(I=>t.put({targetId:0,path:cn(I),sequenceNumber:i.highestListenSequenceNumber}))(m))))})).next((()=>F.waitFor(a)))}))}wi(e,t){e.createObjectStore(Au,{keyPath:KR});const r=t.store(Au),i=new Uy,a=l=>{if(i.add(l)){const d=l.lastSegment(),m=l.popLast();return r.put({collectionId:d,parent:cn(m)})}};return t.store(go).ee({Y:!0},((l,d)=>{const m=new je(l);return a(m.popLast())})).next((()=>t.store(ul).ee({Y:!0},(([l,d,m],g)=>{const v=qr(d);return a(v.popLast())}))))}bi(e){const t=e.store(hl);return t.ee(((r,i)=>{const a=Xc(i),l=HT(this.serializer,a);return t.put(l)}))}Si(e,t){const r=t.store(go),i=[];return r.ee(((a,l)=>{const d=t.store(rf),m=(function(I){return I.document?new le(je.fromString(I.document.name).popFirst(5)):I.noDocument?le.fromSegments(I.noDocument.path):I.unknownDocument?le.fromSegments(I.unknownDocument.path):de(36783)})(l).path.toArray(),g={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(d.put(g))})).next((()=>F.waitFor(i)))}Di(e,t){const r=t.store(hr),i=nx(this.serializer),a=new zy($f.Vi,this.serializer.yt);return r.H().next((l=>{const d=new Map;return l.forEach((m=>{let g=d.get(m.userId)??Pe();_o(this.serializer,m).keys().forEach((v=>g=g.add(v))),d.set(m.userId,g)})),F.forEach(d,((m,g)=>{const v=new qt(g),I=Wf.wt(this.serializer,v),E=a.getIndexManager(v),A=qf.wt(v,this.serializer,E,a.referenceDelegate);return new rx(i,A,I,E).recalculateAndSaveOverlaysForDocumentKeys(new gg(t,An.ce),m).next()}))}))}}function TI(n){n.createObjectStore(dl,{keyPath:HR}).createIndex(Ey,GR,{unique:!0}),n.createObjectStore(hl,{keyPath:"targetId"}).createIndex(B1,$R,{unique:!0}),n.createObjectStore(No)}const ui="IndexedDbPersistence",Hp=18e5,Gp=5e3,Kp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sx="main";class Wy{constructor(e,t,r,i,a,l,d,m,g,v,I=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=a,this.window=l,this.document=d,this.Fi=g,this.Mi=v,this.xi=I,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=E=>Promise.resolve(),!Wy.v())throw new Z(G.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new yD(this,i),this.Ki=t+sx,this.serializer=new $T(m),this.qi=new Hr(this.Ki,this.xi,new ND(this.serializer)),this.ci=new iD,this.li=new fD(this.referenceDelegate,this.serializer),this.remoteDocumentCache=nx(this.serializer),this.Pi=new sD,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,v===!1&&xt(ui,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Z(G.FAILED_PRECONDITION,Kp);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new An(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Nd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Vi(e))return te(ui,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te(ui,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return qc(e).get(Fa).next((t=>F.resolve(this.Xi(t))))}Yi(e){return Nd(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Hp)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Mt(t,fl);return r.H().next((i=>{const a=this.ns(i,Hp),l=i.filter((d=>a.indexOf(d)===-1));return F.forEach(l,(d=>r.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?F.resolve(!0):qc(e).get(Fa).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Gp)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Z(G.FAILED_PRECONDITION,Kp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Nd(e).H().next((r=>this.ns(r,Gp).find((i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,d=this.networkEnabled===i.networkEnabled;if(a||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&te(ui,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Ku,fl],(e=>{const t=new gg(e,An.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Nd(e).H().next((t=>this.ns(t,Hp).map((r=>r.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return qf.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new dD(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Wf.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){te(ui,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=(function(m){return m===18?ub:m===17?K1:m===16?cb:m===15?Sy:m===14?G1:m===13?H1:m===12?lb:m===11?$1:void de(60245)})(this.xi);let l;return this.qi.runTransaction(e,i,a,(d=>(l=new gg(d,this.ai?this.ai.next():An.ce),t==="readwrite-primary"?this.ji(l).next((m=>!!m||this.Hi(l))).next((m=>{if(!m)throw xt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Z(G.FAILED_PRECONDITION,V1);return r(l)})).next((m=>this.Zi(l).next((()=>m)))):this.Ps(l).next((()=>r(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Ps(e){return qc(e).get(Fa).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Gp)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Z(G.FAILED_PRECONDITION,Kp)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return qc(e).put(Fa,t)}static v(){return Hr.v()}Ji(e){const t=qc(e);return t.get(Fa).next((r=>this.Xi(r)?(te(ui,"Releasing primary lease."),t.delete(Fa)):F.resolve()))}ts(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(xt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;aE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const r=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return te(ui,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return xt(ui,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){xt("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function qc(n){return Mt(n,Ku)}function Nd(n){return Mt(n,fl)}function qy(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=Pe(),i=Pe();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new $y(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return aE()?8:O1(mt())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const a={result:null};return this.gs(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ps(e,t,i,r).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new PD;return this.ys(e,t,l).next((d=>{if(a.result=d,this.As)return this.ws(e,t,l,d.size)}))})).next((()=>a.result))}ws(e,t,r,i){return r.documentReadCount<this.Vs?($a()<=De.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",Ha(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),F.resolve()):($a()<=De.DEBUG&&te("QueryEngine","Query:",Ha(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?($a()<=De.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",Ha(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yn(t))):F.resolve())}gs(e,t){if(G0(t))return F.resolve(null);let r=yn(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=lf(t,null,"F"),r=yn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const l=Pe(...a);return this.fs.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,r).next((m=>{const g=this.bs(t,d);return this.Ss(t,g,l,m.readTime)?this.gs(e,lf(t,null,"F")):this.Ds(e,g,t,m)}))))})))))}ps(e,t,r,i){return G0(t)||i.isEqual(Ie.min())?F.resolve(null):this.fs.getDocuments(e,r).next((a=>{const l=this.bs(t,a);return this.Ss(t,l,r,i)?F.resolve(null):($a()<=De.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ha(t)),this.Ds(e,l,t,D1(i,cl)).next((d=>d)))}))}bs(e,t){let r=new Qe(pT(e));return t.forEach(((i,a)=>{Yu(e,a)&&(r=r.add(a))})),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}ys(e,t,r){return $a()<=De.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",Ha(t)),this.fs.getDocumentsMatchingQuery(e,t,Wn.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="LocalStore",RD=3e8;class bD{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new tt(ke),this.Fs=new ks((a=>jo(a)),Qu),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rx(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function ox(n,e,t,r){return new bD(n,e,t,r)}async function ax(n,e){const t=ue(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((a=>(i=a,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const l=[],d=[];let m=Pe();for(const g of i){l.push(g.batchId);for(const v of g.mutations)m=m.add(v.key)}for(const g of a){d.push(g.batchId);for(const v of g.mutations)m=m.add(v.key)}return t.localDocuments.getDocuments(r,m).next((g=>({Ns:g,removedBatchIds:l,addedBatchIds:d})))}))}))}function DD(n,e){const t=ue(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),a=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,m,g,v){const I=g.batch,E=I.keys();let A=F.resolve();return E.forEach((O=>{A=A.next((()=>v.getEntry(m,O))).next((U=>{const L=g.docVersions.get(O);ye(L!==null,48541),U.version.compareTo(L)<0&&(I.applyToRemoteDocument(U,g),U.isValidDocument()&&(U.setReadTime(g.commitVersion),v.addEntry(U)))}))})),A.next((()=>d.mutationQueue.removeMutationBatch(m,I)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let m=Pe();for(let g=0;g<d.mutationResults.length;++g)d.mutationResults[g].transformResults.length>0&&(m=m.add(d.batch.mutations[g].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function lx(n){const e=ue(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function jD(n,e){const t=ue(n),r=e.snapshotVersion;let i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;const d=[];e.targetChanges.forEach(((v,I)=>{const E=i.get(I);if(!E)return;d.push(t.li.removeMatchingKeys(a,v.removedDocuments,I).next((()=>t.li.addMatchingKeys(a,v.addedDocuments,I))));let A=E.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(I)!==null?A=A.withResumeToken(_t.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):v.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(v.resumeToken,r)),i=i.insert(I,A),(function(U,L,oe){return U.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=RD?!0:oe.addedDocuments.size+oe.modifiedDocuments.size+oe.removedDocuments.size>0})(E,A,v)&&d.push(t.li.updateTargetData(a,A))}));let m=kn(),g=Pe();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,v))})),d.push(cx(a,l,e.documentUpdates).next((v=>{m=v.Bs,g=v.Ls}))),!r.isEqual(Ie.min())){const v=t.li.getLastRemoteSnapshotVersion(a).next((I=>t.li.setTargetsMetadata(a,a.currentSequenceNumber,r)));d.push(v)}return F.waitFor(d).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,m,g))).next((()=>m))})).then((a=>(t.vs=i,a)))}function cx(n,e,t){let r=Pe(),i=Pe();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let l=kn();return t.forEach(((d,m)=>{const g=a.get(d);m.isFoundDocument()!==g.isFoundDocument()&&(i=i.add(d)),m.isNoDocument()&&m.version.isEqual(Ie.min())?(e.removeEntry(d,m.readTime),l=l.insert(d,m)):!g.isValidDocument()||m.version.compareTo(g.version)>0||m.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(m),l=l.insert(d,m)):te(Hy,"Ignoring outdated watch update for ",d,". Current version:",g.version," Watch version:",m.version)})),{Bs:l,Ls:i}}))}function VD(n,e){const t=ue(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=vi),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function wl(n,e){const t=ue(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.li.getTargetData(r,e).next((a=>a?(i=a,F.resolve(i)):t.li.allocateTargetId(r).next((l=>(i=new vs(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function Il(n,e,t){const r=ue(n),i=r.vs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Vi(l))throw l;te(Hy,`Failed to update sequence numbers for target ${e}: ${l}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function ff(n,e,t){const r=ue(n);let i=Ie.min(),a=Pe();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(m,g,v){const I=ue(m),E=I.Fs.get(v);return E!==void 0?F.resolve(I.vs.get(E)):I.li.getTargetData(g,v)})(r,l,yn(e)).next((d=>{if(d)return i=d.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(l,d.targetId).next((m=>{a=m}))})).next((()=>r.Cs.getDocumentsMatchingQuery(l,e,t?i:Ie.min(),t?a:Pe()))).next((d=>(dx(r,mT(e),d),{documents:d,ks:a})))))}function ux(n,e){const t=ue(n),r=ue(t.li),i=t.vs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(a=>r.At(a,e).next((l=>l?l.target:null))))}function hx(n,e){const t=ue(n),r=t.Ms.get(e)||Ie.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.xs.getAllFromCollectionGroup(i,e,D1(r,cl),Number.MAX_SAFE_INTEGER))).then((i=>(dx(t,e,i),i)))}function dx(n,e,t){let r=n.Ms.get(e)||Ie.min();t.forEach(((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.Ms.set(e,r)}async function LD(n,e,t,r){const i=ue(n);let a=Pe(),l=kn();for(const g of t){const v=e.Ks(g.metadata.name);g.document&&(a=a.add(v));const I=e.qs(g);I.setReadTime(e.Us(g.metadata.readTime)),l=l.insert(v,I)}const d=i.xs.newChangeBuffer({trackRemovals:!0}),m=await wl(i,(function(v){return yn(Dl(je.fromString(`__bundle__/docs/${v}`)))})(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(g=>cx(g,d,l).next((v=>(d.apply(g),v))).next((v=>i.li.removeMatchingKeysForTargetId(g,m.targetId).next((()=>i.li.addMatchingKeys(g,a,m.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(g,v.Bs,v.Ls))).next((()=>v.Bs))))))}async function OD(n,e,t=Pe()){const r=await wl(n,yn(My(e.bundledQuery))),i=ue(n);return i.persistence.runTransaction("Save named query","readwrite",(a=>{const l=St(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Pi.saveNamedQuery(a,e);const d=r.withResumeToken(_t.EMPTY_BYTE_STRING,l);return i.vs=i.vs.insert(d.targetId,d),i.li.updateTargetData(a,d).next((()=>i.li.removeMatchingKeysForTargetId(a,r.targetId))).next((()=>i.li.addMatchingKeys(a,t,r.targetId))).next((()=>i.Pi.saveNamedQuery(a,e)))}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx="firestore_clients";function xI(n,e){return`${fx}_${n}_${e}`}const mx="firestore_mutations";function SI(n,e,t){let r=`${mx}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const px="firestore_targets";function Qp(n,e){return`${px}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="SharedClientState";class mf{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static $s(e,t,r){const i=JSON.parse(r);let a,l=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(a=new Z(i.error.code,i.error.message))),l?new mf(e,t,i.state,a):(xt(Mr,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class fu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){const r=JSON.parse(t);let i,a=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(i=new Z(r.error.code,r.error.message))),a?new fu(e,r.state,i):(xt(Mr,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,a=Py();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=M1(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new pf(e,a):(xt(Mr,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Gy{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Gy(t.clientId,t.onlineState):(xt(Mr,`Failed to parse online state: ${e}`),null)}}class Rg{constructor(){this.activeTargetIds=Py()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jp{constructor(e,t,r,i,a){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new tt(ke),this.started=!1,this.Zs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.Xs=xI(this.persistenceKey,this.zs),this.Ys=(function(m){return`firestore_sequence_number_${m}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Rg),this.eo=new RegExp(`^${fx}_${l}_([^_]*)$`),this.no=new RegExp(`^${mx}_${l}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${px}_${l}_(\\d+)$`),this.io=(function(m){return`firestore_online_state_${m}`})(this.persistenceKey),this.so=(function(m){return`firestore_bundle_loaded_v2_${m}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const i=this.getItem(xI(this.persistenceKey,r));if(i){const a=pf.$s(r,i);a&&(this.Js=this.Js.insert(a.clientId,a))}}this.oo();const t=this.storage.getItem(this.io);if(t){const r=this._o(t);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Qp(this.persistenceKey,e));if(i){const a=fu.$s(e,i);a&&(r=a.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Qp(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach((i=>{this.lo(i)})),this.currentUser=e,r.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return te(Mr,"READ",e,t),t}setItem(e,t){te(Mr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){te(Mr,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(te(Mr,"EVENT",t.key,t.newValue),t.key===this.Xs)return void xt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const r=this.Eo(t.key);return this.Ro(r,null)}{const r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){const r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){const r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){const r=(function(a){let l=An.ce;if(a!=null)try{const d=JSON.parse(a);ye(typeof d=="number",30636,{yo:a}),l=d}catch(d){xt(Mr,"Failed to read sequence number from WebStorage",d)}return l})(t.newValue);r!==An.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){const r=this.wo(t.newValue);await Promise.all(r.map((i=>this.syncEngine.bo(i))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){const i=new mf(this.currentUser,e,t,r),a=SI(this.persistenceKey,this.currentUser,e);this.setItem(a,i.Ws())}lo(e){const t=SI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){const i=Qp(this.persistenceKey,e),a=new fu(e,t,r);this.setItem(i,a.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const r=this.Eo(e);return pf.$s(r,t)}Vo(e,t){const r=this.no.exec(e),i=Number(r[1]),a=r[2]!==void 0?r[2]:null;return mf.$s(new qt(a),i,t)}fo(e,t){const r=this.ro.exec(e),i=Number(r[1]);return fu.$s(i,t)}_o(e){return Gy.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);te(Mr,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const r=t?this.Js.insert(e,t):this.Js.remove(e),i=this.uo(this.Js),a=this.uo(r),l=[],d=[];return a.forEach((m=>{i.has(m)||l.push(m)})),i.forEach((m=>{a.has(m)||d.push(m)})),this.syncEngine.Co(l,d).then((()=>{this.Js=r}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=Py();return e.forEach(((r,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class gx{constructor(){this.vo=new Rg,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Rg,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="ConnectivityMonitor";class CI{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){te(AI,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){te(AI,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pd=null;function bg(){return Pd===null?Pd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Pd++,"0x"+Pd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="RestConnection",FD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class UD{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===yg?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,a){const l=bg(),d=this.Qo(e,t.toUriEncodedString());te(Yp,`Sending RPC '${e}' ${l}:`,d,r);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(m,i,a);const{host:g}=new URL(d),v=Cl(g);return this.zo(e,d,m,r,v).then((I=>(te(Yp,`Received RPC '${e}' ${l}: `,I),I)),(I=>{throw Jr(Yp,`RPC '${e}' ${l} failed with error: `,I,"url: ",d,"request:",r),I}))}jo(e,t,r,i,a,l){return this.Wo(e,t,r,i,a)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+bl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,a)=>e[a]=i)),r&&r.headers.forEach(((i,a)=>e[a]=i))}Qo(e,t){const r=FD[e];let i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="WebChannelConnection",$c=(n,e,t)=>{n.listen(e,(r=>{try{t(r)}catch(i){setTimeout((()=>{throw i}),0)}}))};class nl extends UD{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!nl.c_){const e=S1();$c(e,x1.STAT_EVENT,(t=>{t.stat===ug.PROXY?te(on,"STAT_EVENT: detected buffering proxy"):t.stat===ug.NOPROXY&&te(on,"STAT_EVENT: detected no buffering proxy")})),nl.c_=!0}}zo(e,t,r,i,a){const l=bg();return new Promise(((d,m)=>{const g=new E1;g.setWithCredentials(!0),g.listenOnce(T1.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case Vd.NO_ERROR:const I=g.getResponseJson();te(on,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(I)),d(I);break;case Vd.TIMEOUT:te(on,`RPC '${e}' ${l} timed out`),m(new Z(G.DEADLINE_EXCEEDED,"Request time out"));break;case Vd.HTTP_ERROR:const E=g.getStatus();if(te(on,`RPC '${e}' ${l} failed with status:`,E,"response text:",g.getResponseText()),E>0){let A=g.getResponseJson();Array.isArray(A)&&(A=A[0]);const O=A==null?void 0:A.error;if(O&&O.status&&O.message){const U=(function(oe){const J=oe.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(J)>=0?J:G.UNKNOWN})(O.status);m(new Z(U,O.message))}else m(new Z(G.UNKNOWN,"Server responded with status "+g.getStatus()))}else m(new Z(G.UNAVAILABLE,"Connection failed."));break;default:de(9055,{l_:e,streamId:l,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{te(on,`RPC '${e}' ${l} completed.`)}}));const v=JSON.stringify(i);te(on,`RPC '${e}' ${l} sending request:`,i),g.send(t,"POST",v,r,15)}))}T_(e,t,r){const i=bg(),a=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const g=a.join("");te(on,`Creating RPC '${e}' stream ${i}: ${g}`,d);const v=l.createWebChannel(g,d);this.I_(v);let I=!1,E=!1;const A=new BD({Ho:O=>{E?te(on,`Not sending because RPC '${e}' stream ${i} is closed:`,O):(I||(te(on,`Opening RPC '${e}' stream ${i} transport.`),v.open(),I=!0),te(on,`RPC '${e}' stream ${i} sending:`,O),v.send(O))},Jo:()=>v.close()});return $c(v,Qc.EventType.OPEN,(()=>{E||(te(on,`RPC '${e}' stream ${i} transport opened.`),A.i_())})),$c(v,Qc.EventType.CLOSE,(()=>{E||(E=!0,te(on,`RPC '${e}' stream ${i} transport closed`),A.o_(),this.E_(v))})),$c(v,Qc.EventType.ERROR,(O=>{E||(E=!0,Jr(on,`RPC '${e}' stream ${i} transport errored. Name:`,O.name,"Message:",O.message),A.o_(new Z(G.UNAVAILABLE,"The operation could not be completed")))})),$c(v,Qc.EventType.MESSAGE,(O=>{var U;if(!E){const L=O.data[0];ye(!!L,16349);const oe=L,J=(oe==null?void 0:oe.error)||((U=oe[0])==null?void 0:U.error);if(J){te(on,`RPC '${e}' stream ${i} received error:`,J);const W=J.status;let Y=(function(P){const S=Rt[P];if(S!==void 0)return kT(S)})(W),he=J.message;Y===void 0&&(Y=G.INTERNAL,he="Unknown error status: "+W+" with message "+J.message),E=!0,A.o_(new Z(Y,he)),v.close()}else te(on,`RPC '${e}' stream ${i} received:`,L),A.__(L)}})),nl.u_(),setTimeout((()=>{A.s_()}),0),A}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return A1()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zD(n){return new nl(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(){return typeof window<"u"?window:null}function $d(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(n){return new Gb(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nl.c_=!1;class Ky{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=a,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&te("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI="PersistentStream";class _x{constructor(e,t,r,i,a,l,d,m){this.Ci=e,this.b_=r,this.S_=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ky(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===G.RESOURCE_EXHAUSTED?(xt(t.toString()),xt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new Z(G.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return te(kI,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(te(kI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class WD extends _x{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Jb(this.serializer,e),r=(function(a){if(!("targetChange"in a))return Ie.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Ie.min():l.readTime?St(l.readTime):Ie.min()})(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=Ag(this.serializer),t.addTarget=(function(a,l){let d;const m=l.target;if(d=of(m)?{documents:MT(a,m)}:{query:FT(a,m).ft},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=bT(a,l.resumeToken);const g=xg(a,l.expectedCount);g!==null&&(d.expectedCount=g)}else if(l.snapshotVersion.compareTo(Ie.min())>0){d.readTime=vl(a,l.snapshotVersion.toTimestamp());const g=xg(a,l.expectedCount);g!==null&&(d.expectedCount=g)}return d})(this.serializer,e);const r=Xb(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=Ag(this.serializer),t.removeTarget=e,this.K_(t)}}class qD extends _x{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.serializer=a}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return ye(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ye(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ye(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Yb(e.writeResults,e.commitTime),r=St(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Ag(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>bu(this.serializer,r)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{}class HD extends $D{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Z(G.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Wo(e,Sg(t,r),i,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Z(G.UNKNOWN,a.toString())}))}jo(e,t,r,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.jo(e,Sg(t,r),i,l,d,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Z(G.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function GD(n,e,t,r){return new HD(n,e,t,r)}class KD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(xt(t),this.aa=!1):te("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo="RemoteStore";class QD{constructor(e,t,r,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=a,this.Aa.Mo((l=>{r.enqueueAndForget((async()=>{Oi(this)&&(te(Uo,"Restarting streams for network reachability change."),await(async function(m){const g=ue(m);g.Ea.add(4),await Ll(g),g.Va.set("Unknown"),g.Ea.delete(4),await nh(g)})(this))}))})),this.Va=new KD(r,i)}}async function nh(n){if(Oi(n))for(const e of n.Ra)await e(!0)}async function Ll(n){for(const e of n.Ra)await e(!1)}function Hf(n,e){const t=ue(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Yy(t)?Jy(t):Ml(t).O_()&&Qy(t,e))}function El(n,e){const t=ue(n),r=Ml(t);t.Ia.delete(e),r.O_()&&vx(t,e),t.Ia.size===0&&(r.O_()?r.L_():Oi(t)&&t.Va.set("Unknown"))}function Qy(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ml(n).Z_(e)}function vx(n,e){n.da.$e(e),Ml(n).X_(e)}function Jy(n){n.da=new Wb({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ml(n).start(),n.Va.ua()}function Yy(n){return Oi(n)&&!Ml(n).x_()&&n.Ia.size>0}function Oi(n){return ue(n).Ea.size===0}function wx(n){n.da=void 0}async function JD(n){n.Va.set("Online")}async function YD(n){n.Ia.forEach(((e,t)=>{Qy(n,e)}))}async function XD(n,e){wx(n),Yy(n)?(n.Va.ha(e),Jy(n)):n.Va.set("Unknown")}async function ZD(n,e,t){if(n.Va.set("Online"),e instanceof RT&&e.state===2&&e.cause)try{await(async function(i,a){const l=a.cause;for(const d of a.targetIds)i.Ia.has(d)&&(await i.remoteSyncer.rejectListen(d,l),i.Ia.delete(d),i.da.removeTarget(d))})(n,e)}catch(r){te(Uo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await gf(n,r)}else if(e instanceof Wd?n.da.Xe(e):e instanceof PT?n.da.st(e):n.da.tt(e),!t.isEqual(Ie.min()))try{const r=await lx(n.localStore);t.compareTo(r)>=0&&await(function(a,l){const d=a.da.Tt(l);return d.targetChanges.forEach(((m,g)=>{if(m.resumeToken.approximateByteSize()>0){const v=a.Ia.get(g);v&&a.Ia.set(g,v.withResumeToken(m.resumeToken,l))}})),d.targetMismatches.forEach(((m,g)=>{const v=a.Ia.get(m);if(!v)return;a.Ia.set(m,v.withResumeToken(_t.EMPTY_BYTE_STRING,v.snapshotVersion)),vx(a,m);const I=new vs(v.target,m,g,v.sequenceNumber);Qy(a,I)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){te(Uo,"Failed to raise snapshot:",r),await gf(n,r)}}async function gf(n,e,t){if(!Vi(e))throw e;n.Ea.add(1),await Ll(n),n.Va.set("Offline"),t||(t=()=>lx(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{te(Uo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await nh(n)}))}function Ix(n,e){return e().catch((t=>gf(n,t,e)))}async function Ol(n){const e=ue(n),t=Pi(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vi;for(;ej(e);)try{const i=await VD(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,tj(e,i)}catch(i){await gf(e,i)}Ex(e)&&Tx(e)}function ej(n){return Oi(n)&&n.Ta.length<10}function tj(n,e){n.Ta.push(e);const t=Pi(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function Ex(n){return Oi(n)&&!Pi(n).x_()&&n.Ta.length>0}function Tx(n){Pi(n).start()}async function nj(n){Pi(n).ra()}async function rj(n){const e=Pi(n);for(const t of n.Ta)e.ea(t.mutations)}async function sj(n,e,t){const r=n.Ta.shift(),i=jy.from(r,e,t);await Ix(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Ol(n)}async function ij(n,e){e&&Pi(n).Y_&&await(async function(r,i){if((function(l){return CT(l)&&l!==G.ABORTED})(i.code)){const a=r.Ta.shift();Pi(r).B_(),await Ix(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i))),await Ol(r)}})(n,e),Ex(n)&&Tx(n)}async function NI(n,e){const t=ue(n);t.asyncQueue.verifyOperationInProgress(),te(Uo,"RemoteStore received new credentials");const r=Oi(t);t.Ea.add(3),await Ll(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await nh(t)}async function Dg(n,e){const t=ue(n);e?(t.Ea.delete(2),await nh(t)):e||(t.Ea.add(2),await Ll(t),t.Va.set("Unknown"))}function Ml(n){return n.ma||(n.ma=(function(t,r,i){const a=ue(t);return a.sa(),new WD(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Zo:JD.bind(null,n),Yo:YD.bind(null,n),t_:XD.bind(null,n),J_:ZD.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),Yy(n)?Jy(n):n.Va.set("Unknown")):(await n.ma.stop(),wx(n))}))),n.ma}function Pi(n){return n.fa||(n.fa=(function(t,r,i){const a=ue(t);return a.sa(),new qD(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:nj.bind(null,n),t_:ij.bind(null,n),ta:rj.bind(null,n),na:sj.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Ol(n)):(await n.fa.stop(),n.Ta.length>0&&(te(Uo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Xt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,d=new Xy(e,t,l,i,a);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fl(n,e){if(xt("AsyncQueue",`${e}: ${n}`),Vi(n))return new Z(G.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{static emptySet(e){return new rl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||le.comparator(t.key,r.key):(t,r)=>le.comparator(t.key,r.key),this.keyedMap=Jc(),this.sortedSet=new tt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof rl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new rl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(){this.ga=new tt(le.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):de(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Tl{constructor(e,t,r,i,a,l,d,m,g){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=m,this.hasCachedResults=g}static fromInitialDocuments(e,t,r,i,a){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new Tl(e,t,rl.emptySet(t),l,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ju(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class aj{constructor(){this.queries=RI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=ue(t),a=i.queries;i.queries=RI(),a.forEach(((l,d)=>{for(const m of d.ba)m.onError(r)}))})(this,new Z(G.ABORTED,"Firestore shutting down"))}}function RI(){return new ks((n=>fT(n)),Ju)}async function Zy(n,e){const t=ue(n);let r=3;const i=e.query;let a=t.queries.get(i);a?!a.Sa()&&e.Da()&&(r=2):(a=new oj,r=e.Da()?0:1);try{switch(r){case 0:a.wa=await t.onListen(i,!0);break;case 1:a.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const d=Fl(l,`Initialization of query '${Ha(e.query)}' failed`);return void e.onError(d)}t.queries.set(i,a),a.ba.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&t_(t)}async function e_(n,e){const t=ue(n),r=e.query;let i=3;const a=t.queries.get(r);if(a){const l=a.ba.indexOf(e);l>=0&&(a.ba.splice(l,1),a.ba.length===0?i=e.Da()?0:1:!a.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function lj(n,e){const t=ue(n);let r=!1;for(const i of e){const a=i.query,l=t.queries.get(a);if(l){for(const d of l.ba)d.Fa(i)&&(r=!0);l.wa=i}}r&&t_(t)}function cj(n,e,t){const r=ue(n),i=r.queries.get(e);if(i)for(const a of i.ba)a.onError(t);r.queries.delete(e)}function t_(n){n.Ca.forEach((e=>{e.next()}))}var jg,bI;(bI=jg||(jg={})).Ma="default",bI.Cache="cache";class n_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Tl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Tl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==jg.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e){this.serializer=e}Ks(e){return Gr(this.serializer,e)}qs(e){return e.metadata.exists?OT(this.serializer,e.document,!1):it.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return St(e)}}class hj{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=xx(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const r=je.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new DI(this.serializer);for(const i of e)if(i.metadata.queries){const a=r.Ks(i.metadata.name);for(const l of i.metadata.queries){const d=(t.get(l)||Pe()).add(a);t.set(l,d)}}return t}async ja(e){const t=await LD(e,new DI(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(const i of this.Wa)await OD(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function xx(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.key=e}}class Ax{constructor(e){this.key=e}}class Cx{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Pe(),this.mutatedKeys=Pe(),this.eu=pT(e),this.tu=new rl(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new PI,i=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,d=!1;const m=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,g=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((v,I)=>{const E=i.get(v),A=Yu(this.query,I)?I:null,O=!!E&&this.mutatedKeys.has(E.key),U=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let L=!1;E&&A?E.data.isEqual(A.data)?O!==U&&(r.track({type:3,doc:A}),L=!0):this.su(E,A)||(r.track({type:2,doc:A}),L=!0,(m&&this.eu(A,m)>0||g&&this.eu(A,g)<0)&&(d=!0)):!E&&A?(r.track({type:0,doc:A}),L=!0):E&&!A&&(r.track({type:1,doc:E}),L=!0,(m||g)&&(d=!0)),L&&(A?(l=l.add(A),a=U?a.add(v):a.delete(v)):(l=l.delete(v),a=a.delete(v)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const v=this.query.limitType==="F"?l.last():l.first();l=l.delete(v.key),a=a.delete(v.key),r.track({type:1,doc:v})}return{tu:l,iu:r,Ss:d,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((v,I)=>(function(A,O){const U=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de(20277,{Vt:L})}};return U(A)-U(O)})(v.type,I.type)||this.eu(v.doc,I.doc))),this.ou(r),i=i??!1;const d=t&&!i?this._u():[],m=this.Ya.size===0&&this.current&&!i?1:0,g=m!==this.Xa;return this.Xa=m,l.length!==0||g?{snapshot:new Tl(this.query,e.tu,a,l,e.mutatedKeys,m===0,g,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new PI,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Pe(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new Ax(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new Sx(r))})),t}cu(e){this.Za=e.ks,this.Ya=Pe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Tl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Mi="SyncEngine";class dj{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class fj{constructor(e){this.key=e,this.hu=!1}}class mj{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new ks((d=>fT(d)),Ju),this.Iu=new Map,this.Eu=new Set,this.Ru=new tt(le.comparator),this.Au=new Map,this.Vu=new By,this.du={},this.mu=new Map,this.fu=Fo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function pj(n,e,t=!0){const r=Gf(n);let i;const a=r.Tu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await kx(r,e,t,!0),i}async function gj(n,e){const t=Gf(n);await kx(t,e,!0,!1)}async function kx(n,e,t,r){const i=await wl(n.localStore,yn(e)),a=i.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await r_(n,e,a,l==="current",i.resumeToken)),n.isPrimaryClient&&t&&Hf(n.remoteStore,i),d}async function r_(n,e,t,r,i){n.pu=(I,E,A)=>(async function(U,L,oe,J){let W=L.view.ru(oe);W.Ss&&(W=await ff(U.localStore,L.query,!1).then((({documents:P})=>L.view.ru(P,W))));const Y=J&&J.targetChanges.get(L.targetId),he=J&&J.targetMismatches.get(L.targetId)!=null,Q=L.view.applyChanges(W,U.isPrimaryClient,Y,he);return Vg(U,L.targetId,Q.au),Q.snapshot})(n,I,E,A);const a=await ff(n.localStore,e,!0),l=new Cx(e,a.ks),d=l.ru(a.documents),m=eh.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),g=l.applyChanges(d,n.isPrimaryClient,m);Vg(n,t,g.au);const v=new dj(e,t,l);return n.Tu.set(e,v),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),g.snapshot}async function yj(n,e,t){const r=ue(n),i=r.Tu.get(e),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((l=>!Ju(l,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Il(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&El(r.remoteStore,i.targetId),xl(r,i.targetId)})).catch(ji)):(xl(r,i.targetId),await Il(r.localStore,i.targetId,!0))}async function _j(n,e){const t=ue(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),El(t.remoteStore,r.targetId))}async function vj(n,e,t){const r=a_(n);try{const i=await(function(l,d){const m=ue(l),g=He.now(),v=d.reduce(((A,O)=>A.add(O.key)),Pe());let I,E;return m.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let O=kn(),U=Pe();return m.xs.getEntries(A,v).next((L=>{O=L,O.forEach(((oe,J)=>{J.isValidDocument()||(U=U.add(oe))}))})).next((()=>m.localDocuments.getOverlayedDocuments(A,O))).next((L=>{I=L;const oe=[];for(const J of d){const W=Ub(J,I.get(J.key).overlayedDocument);W!=null&&oe.push(new Ns(J.key,W,sT(W.value.mapValue),ut.exists(!0)))}return m.mutationQueue.addMutationBatch(A,g,oe,d)})).next((L=>{E=L;const oe=L.applyToLocalDocumentSet(I,U);return m.documentOverlayCache.saveOverlays(A,L.batchId,oe)}))})).then((()=>({batchId:E.batchId,changes:yT(I)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(l,d,m){let g=l.du[l.currentUser.toKey()];g||(g=new tt(ke)),g=g.insert(d,m),l.du[l.currentUser.toKey()]=g})(r,i.batchId,t),await Ps(r,i.changes),await Ol(r.remoteStore)}catch(i){const a=Fl(i,"Failed to persist write");t.reject(a)}}async function Nx(n,e){const t=ue(n);try{const r=await jD(t.localStore,e);e.targetChanges.forEach(((i,a)=>{const l=t.Au.get(a);l&&(ye(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?ye(l.hu,14607):i.removedDocuments.size>0&&(ye(l.hu,42227),l.hu=!1))})),await Ps(t,r,e)}catch(r){await ji(r)}}function jI(n,e,t){const r=ue(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((a,l)=>{const d=l.view.va(e);d.snapshot&&i.push(d.snapshot)})),(function(l,d){const m=ue(l);m.onlineState=d;let g=!1;m.queries.forEach(((v,I)=>{for(const E of I.ba)E.va(d)&&(g=!0)})),g&&t_(m)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wj(n,e,t){const r=ue(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),a=i&&i.key;if(a){let l=new tt(le.comparator);l=l.insert(a,it.newNoDocument(a,Ie.min()));const d=Pe().add(a),m=new Zu(Ie.min(),new Map,new tt(ke),l,d);await Nx(r,m),r.Ru=r.Ru.remove(a),r.Au.delete(e),o_(r)}else await Il(r.localStore,e,!1).then((()=>xl(r,e,t))).catch(ji)}async function Ij(n,e){const t=ue(n),r=e.batch.batchId;try{const i=await DD(t.localStore,e);i_(t,r,null),s_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ps(t,i)}catch(i){await ji(i)}}async function Ej(n,e,t){const r=ue(n);try{const i=await(function(l,d){const m=ue(l);return m.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let v;return m.mutationQueue.lookupMutationBatch(g,d).next((I=>(ye(I!==null,37113),v=I.keys(),m.mutationQueue.removeMutationBatch(g,I)))).next((()=>m.mutationQueue.performConsistencyCheck(g))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(g,v,d))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,v))).next((()=>m.localDocuments.getDocuments(g,v)))}))})(r.localStore,e);i_(r,e,t),s_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ps(r,i)}catch(i){await ji(i)}}async function Tj(n,e){const t=ue(n);Oi(t.remoteStore)||te(Mi,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(l){const d=ue(l);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(m=>d.mutationQueue.getHighestUnacknowledgedBatchId(m)))})(t.localStore);if(r===vi)return void e.resolve();const i=t.mu.get(r)||[];i.push(e),t.mu.set(r,i)}catch(r){const i=Fl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function s_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function i_(n,e,t){const r=ue(n);let i=r.du[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function xl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((r=>{n.Vu.containsKey(r)||Px(n,r)}))}function Px(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(El(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),o_(n))}function Vg(n,e,t){for(const r of t)r instanceof Sx?(n.Vu.addReference(r.key,e),xj(n,r)):r instanceof Ax?(te(Mi,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||Px(n,r.key)):de(19791,{wu:r})}function xj(n,e){const t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(te(Mi,"New document in limbo: "+t),n.Eu.add(r),o_(n))}function o_(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new le(je.fromString(e)),r=n.fu.next();n.Au.set(r,new fj(t)),n.Ru=n.Ru.insert(t,r),Hf(n.remoteStore,new vs(yn(Dl(t.path)),r,"TargetPurposeLimboResolution",An.ce))}}async function Ps(n,e,t){const r=ue(n),i=[],a=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach(((d,m)=>{l.push(r.pu(m,e,t).then((g=>{var v;if((g||t)&&r.isPrimaryClient){const I=g?!g.fromCache:(v=t==null?void 0:t.targetChanges.get(m.targetId))==null?void 0:v.current;r.sharedClientState.updateQueryState(m.targetId,I?"current":"not-current")}if(g){i.push(g);const I=$y.Es(m.targetId,g);a.push(I)}})))})),await Promise.all(l),r.Pu.J_(i),await(async function(m,g){const v=ue(m);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(I=>F.forEach(g,(E=>F.forEach(E.Ts,(A=>v.persistence.referenceDelegate.addReference(I,E.targetId,A))).next((()=>F.forEach(E.Is,(A=>v.persistence.referenceDelegate.removeReference(I,E.targetId,A)))))))))}catch(I){if(!Vi(I))throw I;te(Hy,"Failed to update sequence numbers: "+I)}for(const I of g){const E=I.targetId;if(!I.fromCache){const A=v.vs.get(E),O=A.snapshotVersion,U=A.withLastLimboFreeSnapshotVersion(O);v.vs=v.vs.insert(E,U)}}})(r.localStore,a))}async function Sj(n,e){const t=ue(n);if(!t.currentUser.isEqual(e)){te(Mi,"User change. New user:",e.toKey());const r=await ax(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((d=>{d.forEach((m=>{m.reject(new Z(G.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ps(t,r.Ns)}}function Aj(n,e){const t=ue(n),r=t.Au.get(e);if(r&&r.hu)return Pe().add(r.key);{let i=Pe();const a=t.Iu.get(e);if(!a)return i;for(const l of a){const d=t.Tu.get(l);i=i.unionWith(d.view.nu)}return i}}async function Cj(n,e){const t=ue(n),r=await ff(t.localStore,e.query,!0),i=e.view.cu(r);return t.isPrimaryClient&&Vg(t,e.targetId,i.au),i}async function kj(n,e){const t=ue(n);return hx(t.localStore,e).then((r=>Ps(t,r)))}async function Nj(n,e,t,r){const i=ue(n),a=await(function(d,m){const g=ue(d),v=ue(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",(I=>v.Xn(I,m).next((E=>E?g.localDocuments.getDocuments(I,E):F.resolve(null)))))})(i.localStore,e);a!==null?(t==="pending"?await Ol(i.remoteStore):t==="acknowledged"||t==="rejected"?(i_(i,e,r||null),s_(i,e),(function(d,m){ue(ue(d).mutationQueue).nr(m)})(i.localStore,e)):de(6720,"Unknown batchState",{bu:t}),await Ps(i,a)):te(Mi,"Cannot apply mutation batch with id: "+e)}async function Pj(n,e){const t=ue(n);if(Gf(t),a_(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await VI(t,r.toArray());t.gu=!0,await Dg(t.remoteStore,!0);for(const a of i)Hf(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const r=[];let i=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then((()=>(xl(t,l),Il(t.localStore,l,!0)))),El(t.remoteStore,l)})),await i,await VI(t,r),(function(l){const d=ue(l);d.Au.forEach(((m,g)=>{El(d.remoteStore,g)})),d.Vu.zr(),d.Au=new Map,d.Ru=new tt(le.comparator)})(t),t.gu=!1,await Dg(t.remoteStore,!1)}}async function VI(n,e,t){const r=ue(n),i=[],a=[];for(const l of e){let d;const m=r.Iu.get(l);if(m&&m.length!==0){d=await wl(r.localStore,yn(m[0]));for(const g of m){const v=r.Tu.get(g),I=await Cj(r,v);I.snapshot&&a.push(I.snapshot)}}else{const g=await ux(r.localStore,l);d=await wl(r.localStore,g),await r_(r,Rx(g),l,!1,d.resumeToken)}i.push(d)}return r.Pu.J_(a),i}function Rx(n){return dT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Rj(n){return(function(t){return ue(ue(t).persistence).hs()})(ue(n).localStore)}async function bj(n,e,t,r){const i=ue(n);if(i.gu)return void te(Mi,"Ignoring unexpected query state notification.");const a=i.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await hx(i.localStore,mT(a[0])),d=Zu.createSynthesizedRemoteEventForCurrentChange(e,t==="current",_t.EMPTY_BYTE_STRING);await Ps(i,l,d);break}case"rejected":await Il(i.localStore,e,!0),xl(i,e,r);break;default:de(64155,t)}}async function Dj(n,e,t){const r=Gf(n);if(r.gu){for(const i of e){if(r.Iu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){te(Mi,"Adding an already active target "+i);continue}const a=await ux(r.localStore,i),l=await wl(r.localStore,a);await r_(r,Rx(a),l.targetId,!1,l.resumeToken),Hf(r.remoteStore,l)}for(const i of t)r.Iu.has(i)&&await Il(r.localStore,i,!1).then((()=>{El(r.remoteStore,i),xl(r,i)})).catch(ji)}}function Gf(n){const e=ue(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Nx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Aj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wj.bind(null,e),e.Pu.J_=lj.bind(null,e.eventManager),e.Pu.yu=cj.bind(null,e.eventManager),e}function a_(n){const e=ue(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ij.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ej.bind(null,e),e}function jj(n,e,t){const r=ue(n);(async function(a,l,d){try{const m=await l.getMetadata();if(await(function(A,O){const U=ue(A),L=St(O.createTime);return U.persistence.runTransaction("hasNewerBundle","readonly",(oe=>U.Pi.getBundleMetadata(oe,O.id))).then((oe=>!!oe&&oe.createTime.compareTo(L)>=0))})(a.localStore,m))return await l.close(),d._completeWith((function(A){return{taskState:"Success",documentsLoaded:A.totalDocuments,bytesLoaded:A.totalBytes,totalDocuments:A.totalDocuments,totalBytes:A.totalBytes}})(m)),Promise.resolve(new Set);d._updateProgress(xx(m));const g=new hj(m,l.serializer);let v=await l.Su();for(;v;){const E=await g.Ga(v);E&&d._updateProgress(E),v=await l.Su()}const I=await g.ja(a.localStore);return await Ps(a,I.Ja,void 0),await(function(A,O){const U=ue(A);return U.persistence.runTransaction("Save bundle","readwrite",(L=>U.Pi.saveBundleMetadata(L,O)))})(a.localStore,m),d._completeWith(I.progress),Promise.resolve(I.Ha)}catch(m){return Jr(Mi,`Loading bundle failed with ${m}`),d._failWith(m),Promise.resolve(new Set)}})(r,e,t).then((i=>{r.sharedClientState.notifyBundleLoaded(i)}))}class Du{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=th(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ox(this.persistence,new ix,e.initialUser,this.serializer)}Cu(e){return new zy($f.Vi,this.serializer)}Du(e){return new gx}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Du.provider={build:()=>new Du};class Vj extends Du{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ye(this.persistence.referenceDelegate instanceof df,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ZT(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?an.withCacheSize(this.cacheSizeBytes):an.DEFAULT;return new zy((r=>df.Vi(r,t)),this.serializer)}}class bx extends Du{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await a_(this.xu.syncEngine),await Ol(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return ox(this.persistence,new ix,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new ZT(r,e.asyncQueue,t)}Mu(e,t){const r=new MR(t,this.persistence);return new OR(e.asyncQueue,r)}Cu(e){const t=qy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?an.withCacheSize(this.cacheSizeBytes):an.DEFAULT;return new Wy(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,yx(),$d(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new gx}}class Lj extends bx{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Jp&&(this.sharedClientState.syncEngine={So:Nj.bind(null,t),Do:bj.bind(null,t),Co:Dj.bind(null,t),hs:Rj.bind(null,t),bo:kj.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async r=>{await Pj(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=yx();if(!Jp.v(t))throw new Z(G.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=qy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jp(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class ju{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>jI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Sj.bind(null,this.syncEngine),await Dg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new aj})()}createDatastore(e){const t=th(e.databaseInfo.databaseId),r=zD(e.databaseInfo);return GD(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,a,l,d){return new QD(r,i,a,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>jI(this.syncEngine,t,0)),(function(){return CI.v()?new CI:new MD})())}createSyncEngine(e,t){return(function(i,a,l,d,m,g,v){const I=new mj(i,a,l,d,m,g);return v&&(I.gu=!0),I})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const a=ue(i);te(Uo,"RemoteStore shutting down."),a.Ea.add(5),await Ll(a),a.Aa.shutdown(),a.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}ju.provider={build:()=>new ju};function LI(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):xt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Xt,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);const i=await this.Uu(r);return new uj(JSON.parse(i),e.length+r)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mj=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Z(G.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,a){const l=ue(i),d={documents:a.map((I=>Ru(l.serializer,I)))},m=await l.jo("BatchGetDocuments",l.serializer.databaseId,je.emptyPath(),d,a.length),g=new Map;m.forEach((I=>{const E=Qb(l.serializer,I);g.set(E.key.toString(),E)}));const v=[];return a.forEach((I=>{const E=g.get(I.toString());ye(!!E,55234,{key:I}),v.push(E)})),v})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Vl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const i=le.fromPath(r);this.mutations.push(new by(i,this.precondition(i)))})),await(async function(r,i){const a=ue(r),l={writes:i.map((d=>bu(a.serializer,d)))};await a.Wo("Commit",a.serializer.databaseId,je.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw de(50498,{Gu:e.constructor.name});t=Ie.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Z(G.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ie.min())?ut.exists(!1):ut.updateTime(t):ut.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ie.min()))throw new Z(G.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ut.updateTime(t)}return ut.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.zu=r.maxAttempts,this.M_=new Ky(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new Mj(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Zu(i)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{const t=this.updateFunction(e);return!Gu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if((e==null?void 0:e.name)==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!CT(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri="FirestoreClient";class Uj{constructor(e,t,r,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=qt.UNAUTHENTICATED,this.clientId=_y.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async l=>{te(Ri,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(te(Ri,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Fl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Xp(n,e){n.asyncQueue.verifyOperationInProgress(),te(Ri,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await ax(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function OI(n,e){n.asyncQueue.verifyOperationInProgress();const t=await l_(n);te(Ri,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>NI(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>NI(e.remoteStore,i))),n._onlineComponents=e}async function l_(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){te(Ri,"Using user provided OfflineComponentProvider");try{await Xp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===G.FAILED_PRECONDITION||i.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Jr("Error using user provided cache. Falling back to memory cache: "+t),await Xp(n,new Du)}}else te(Ri,"Using default OfflineComponentProvider"),await Xp(n,new Vj(void 0));return n._offlineComponents}async function Qf(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(te(Ri,"Using user provided OnlineComponentProvider"),await OI(n,n._uninitializedComponentsProvider._online)):(te(Ri,"Using default OnlineComponentProvider"),await OI(n,new ju))),n._onlineComponents}function Dx(n){return l_(n).then((e=>e.persistence))}function c_(n){return l_(n).then((e=>e.localStore))}function jx(n){return Qf(n).then((e=>e.remoteStore))}function u_(n){return Qf(n).then((e=>e.syncEngine))}function Bj(n){return Qf(n).then((e=>e.datastore))}async function Sl(n){const e=await Qf(n),t=e.eventManager;return t.onListen=pj.bind(null,e.syncEngine),t.onUnlisten=yj.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=gj.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_j.bind(null,e.syncEngine),t}function zj(n){return n.asyncQueue.enqueue((async()=>{const e=await Dx(n),t=await jx(n);return e.setNetworkEnabled(!0),(function(i){const a=ue(i);return a.Ea.delete(0),nh(a)})(t)}))}function Wj(n){return n.asyncQueue.enqueue((async()=>{const e=await Dx(n),t=await jx(n);return e.setNetworkEnabled(!1),(async function(i){const a=ue(i);a.Ea.add(0),await Ll(a),a.Va.set("Offline")})(t)}))}function qj(n,e,t,r){const i=new Kf(r),a=new n_(e,i,t);return n.asyncQueue.enqueueAndForget((async()=>Zy(await Sl(n),a))),()=>{i.Nu(),n.asyncQueue.enqueueAndForget((async()=>e_(await Sl(n),a)))}}function $j(n,e){const t=new Xt;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,a,l){try{const d=await(function(g,v){const I=ue(g);return I.persistence.runTransaction("read document","readonly",(E=>I.localDocuments.getDocument(E,v)))})(i,a);d.isFoundDocument()?l.resolve(d):d.isNoDocument()?l.resolve(null):l.reject(new Z(G.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const m=Fl(d,`Failed to get document '${a} from cache`);l.reject(m)}})(await c_(n),e,t))),t.promise}function Vx(n,e,t={}){const r=new Xt;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,m,g){const v=new Kf({next:E=>{v.Nu(),l.enqueueAndForget((()=>e_(a,I)));const A=E.docs.has(d);!A&&E.fromCache?g.reject(new Z(G.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&E.fromCache&&m&&m.source==="server"?g.reject(new Z(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(E)},error:E=>g.reject(E)}),I=new n_(Dl(d.path),v,{includeMetadataChanges:!0,Ka:!0});return Zy(a,I)})(await Sl(n),n.asyncQueue,e,t,r))),r.promise}function Hj(n,e){const t=new Xt;return n.asyncQueue.enqueueAndForget((async()=>(async function(i,a,l){try{const d=await ff(i,a,!0),m=new Cx(a,d.ks),g=m.ru(d.documents),v=m.applyChanges(g,!1);l.resolve(v.snapshot)}catch(d){const m=Fl(d,`Failed to execute query '${a} against cache`);l.reject(m)}})(await c_(n),e,t))),t.promise}function Lx(n,e,t={}){const r=new Xt;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,m,g){const v=new Kf({next:E=>{v.Nu(),l.enqueueAndForget((()=>e_(a,I))),E.fromCache&&m.source==="server"?g.reject(new Z(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(E)},error:E=>g.reject(E)}),I=new n_(d,v,{includeMetadataChanges:!0,Ka:!0});return Zy(a,I)})(await Sl(n),n.asyncQueue,e,t,r))),r.promise}function Gj(n,e){const t=new Xt;return n.asyncQueue.enqueueAndForget((async()=>vj(await u_(n),e,t))),t.promise}function Kj(n,e){const t=new Kf(e);return n.asyncQueue.enqueueAndForget((async()=>(function(i,a){ue(i).Ca.add(a),a.next()})(await Sl(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(i,a){ue(i).Ca.delete(a)})(await Sl(n),t)))}}function Qj(n,e,t){const r=new Xt;return n.asyncQueue.enqueueAndForget((async()=>{const i=await Bj(n);new Fj(n.asyncQueue,i,t,e,r).ju()})),r.promise}function Jj(n,e,t,r){const i=(function(l,d){let m;return m=typeof l=="string"?NT().encode(l):l,(function(v,I){return new Oj(v,I)})((function(v,I){if(v instanceof Uint8Array)return LI(v,I);if(v instanceof ArrayBuffer)return LI(new Uint8Array(v),I);if(v instanceof ReadableStream)return v.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(m),d)})(t,th(e));n.asyncQueue.enqueueAndForget((async()=>{jj(await u_(n),i,r)}))}function Yj(n,e){return n.asyncQueue.enqueue((async()=>(function(r,i){const a=ue(r);return a.persistence.runTransaction("Get named query","readonly",(l=>a.Pi.getNamedQuery(l,i)))})(await c_(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj="ComponentProvider",MI=new Map;function Zj(n,e,t,r,i){return new fb(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Ox(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx="firestore.googleapis.com",FI=!0;class UI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Z(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Mx,this.ssl=FI}else this.host=e.host,this.ssl=e.ssl??FI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=QT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mD)throw new Z(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}P1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ox(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Z(G.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rh{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new UI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Z(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new UI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new SR;switch(r.type){case"firstParty":return new NR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=MI.get(t);r&&(te(Xj,"Removing Datastore"),MI.delete(t),r.terminate())})(this),Promise.resolve()}}function eV(n,e,t,r={}){var g;n=We(n,rh);const i=Cl(e),a=n._getSettings(),l={...a,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;i&&(nE(`https://${d}`),rE("Firestore",!0)),a.host!==Mx&&a.host!==d&&Jr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...a,host:d,ssl:i,emulatorOptions:r};if(!Ii(m,l)&&(n._setSettings(m),r.mockUserToken)){let v,I;if(typeof r.mockUserToken=="string")v=r.mockUserToken,I=qt.MOCK_USER;else{v=BA(r.mockUserToken,(g=n._app)==null?void 0:g.options.projectId);const E=r.mockUserToken.sub||r.mockUserToken.user_id;if(!E)throw new Z(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");I=new qt(E)}n._authCredentials=new AR(new k1(v,I))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _n=class Fx{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Fx(this.firestore,e,this._query)}},et=class Zc{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zc(this.firestore,e,this._key)}toJSON(){return{type:Zc._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Hu(t,Zc._jsonSchema))return new Zc(e,r||null,new le(je.fromString(t.referencePath)))}};et._jsonSchemaVersion="firestore/documentReference/1.0",et._jsonSchema={type:Dt("string",et._jsonSchemaVersion),referencePath:Dt("string")};let wi=class Ux extends _n{constructor(e,t,r){super(e,t,Dl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new et(this.firestore,null,new le(e))}withConverter(e){return new Ux(this.firestore,e,this._path)}};function Bx(n,e,...t){if(n=xe(n),vy("collection","path",e),n instanceof rh){const r=je.fromString(e,...t);return k0(r),new wi(n,null,r)}{if(!(n instanceof et||n instanceof wi))throw new Z(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(je.fromString(e,...t));return k0(r),new wi(n.firestore,null,r)}}function tV(n,e){if(n=We(n,rh),vy("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Z(G.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new _n(n,null,(function(r){return new Cs(je.emptyPath(),r)})(e))}function yf(n,e,...t){if(n=xe(n),arguments.length===1&&(e=_y.newId()),vy("doc","path",e),n instanceof rh){const r=je.fromString(e,...t);return C0(r),new et(n,null,new le(r))}{if(!(n instanceof et||n instanceof wi))throw new Z(G.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(je.fromString(e,...t));return C0(r),new et(n.firestore,n instanceof wi?n.converter:null,new le(r))}}function zx(n,e){return n=xe(n),e=xe(e),(n instanceof et||n instanceof wi)&&(e instanceof et||e instanceof wi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Wx(n,e){return n=xe(n),e=xe(e),n instanceof _n&&e instanceof _n&&n.firestore===e.firestore&&Ju(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI="AsyncQueue";class zI{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ky(this,"async_queue_retry"),this._c=()=>{const r=$d();r&&te(BI,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=$d();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=$d();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Xt;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Vi(e))throw e;te(BI,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,xt("INTERNAL UNHANDLED ERROR: ",WI(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Xy.createAndSchedule(this,e,t,r,(a=>this.hc(a)));return this.tc.push(i),i}uc(){this.nc&&de(47125,{Pc:WI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function WI(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(){this._progressObserver={},this._taskCompletionResolver=new Xt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV=-1;let At=class extends rh{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new zI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zI(e),this._firestoreClient=void 0,await e}}};function un(n){if(n._terminated)throw new Z(G.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||qx(n),n._firestoreClient}function qx(n){var r,i,a,l;const e=n._freezeSettings(),t=Zj(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,(i=n._app)==null?void 0:i.options.apiKey,e);n._componentsProvider||(a=e.localCache)!=null&&a._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Uj(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(m){const g=m==null?void 0:m._online.build();return{_offline:m==null?void 0:m._offline.build(g),_online:g}})(n._componentsProvider))}function sV(n,e){Jr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return $x(n,ju.provider,{build:r=>new bx(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function iV(n){Jr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();$x(n,ju.provider,{build:t=>new Lj(t,e.cacheSizeBytes)})}function $x(n,e,t){if((n=We(n,At))._firestoreClient||n._terminated)throw new Z(G.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Z(G.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},qx(n)}function oV(n){if(n._initialized&&!n._terminated)throw new Z(G.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Xt;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!Hr.v())return Promise.resolve();const i=r+sx;await Hr.delete(i)})(qy(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function aV(n){return(function(t){const r=new Xt;return t.asyncQueue.enqueueAndForget((async()=>Tj(await u_(t),r))),r.promise})(un(n=We(n,At)))}function lV(n){return zj(un(n=We(n,At)))}function cV(n){return Wj(un(n=We(n,At)))}function uV(n,e){const t=un(n=We(n,At)),r=new nV;return Jj(t,n._databaseId,e,r),r}function hV(n,e){return Yj(un(n=We(n,At)),e).then((t=>t?new _n(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ln(_t.fromBase64String(e))}catch(t){throw new Z(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ln(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ln._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Hu(e,ln._jsonSchema))return ln.fromBase64String(e.bytes)}}ln._jsonSchemaVersion="firestore/bytes/1.0",ln._jsonSchema={type:Dt("string",ln._jsonSchemaVersion),bytes:Dt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bo=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Z(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ho=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Z(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Z(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ke(this._lat,e._lat)||ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:mr._jsonSchemaVersion}}static fromJSON(e){if(Hu(e,mr._jsonSchema))return new mr(e.latitude,e.longitude)}}mr._jsonSchemaVersion="firestore/geoPoint/1.0",mr._jsonSchema={type:Dt("string",mr._jsonSchemaVersion),latitude:Dt("number"),longitude:Dt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:pr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Hu(e,pr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new pr(e.vectorValues);throw new Z(G.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}pr._jsonSchemaVersion="firestore/vectorValue/1.0",pr._jsonSchema={type:Dt("string",pr._jsonSchemaVersion),vectorValues:Dt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dV=/^__.*__$/;class fV{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ns(e,this.data,this.fieldMask,t,this.fieldTransforms):new jl(e,this.data,t,this.fieldTransforms)}}class Hx{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ns(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Gx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de(40011,{dataSource:n})}}class Jf{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,a===void 0&&this.validatePath(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Jf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return _f(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Gx(this.dataSource)&&dV.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class mV{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||th(e)}createContext(e,t,r,i=!1){return new Jf({dataSource:e,methodName:t,targetDoc:r,path:ct.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Go(n){const e=n._freezeSettings(),t=th(n._databaseId);return new mV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Yf(n,e,t,r,i,a={}){const l=n.createContext(a.merge||a.mergeFields?2:0,e,t,i);y_("Data must be an object, but it was:",l,r);const d=Jx(r,l);let m,g;if(a.merge)m=new Cn(l.fieldMask),g=l.fieldTransforms;else if(a.mergeFields){const v=[];for(const I of a.mergeFields){const E=zo(e,I,t);if(!l.contains(E))throw new Z(G.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);Zx(v,E)||v.push(E)}m=new Cn(v),g=l.fieldTransforms.filter((I=>m.covers(I.field)))}else m=null,g=l.fieldTransforms;return new fV(new Yt(d),m,g)}class sh extends Ho{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sh}}function Kx(n,e,t){return new Jf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class h_ extends Ho{_toFieldTransform(e){return new Xu(e.path,new yl)}isEqual(e){return e instanceof h_}}class d_ extends Ho{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Kx(this,e,!0),r=this.Ac.map((a=>Ko(a,t))),i=new Vo(r);return new Xu(e.path,i)}isEqual(e){return e instanceof d_&&Ii(this.Ac,e.Ac)}}class f_ extends Ho{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Kx(this,e,!0),r=this.Ac.map((a=>Ko(a,t))),i=new Lo(r);return new Xu(e.path,i)}isEqual(e){return e instanceof f_&&Ii(this.Ac,e.Ac)}}class m_ extends Ho{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new _l(e.serializer,wT(e.serializer,this.Vc));return new Xu(e.path,t)}isEqual(e){return e instanceof m_&&this.Vc===e.Vc}}function p_(n,e,t,r){const i=n.createContext(1,e,t);y_("Data must be an object, but it was:",i,r);const a=[],l=Yt.empty();Li(r,((m,g)=>{const v=Xx(e,m,t);g=xe(g);const I=i.childContextForFieldPath(v);if(g instanceof sh)a.push(v);else{const E=Ko(g,I);E!=null&&(a.push(v),l.set(v,E))}}));const d=new Cn(a);return new Hx(l,d,i.fieldTransforms)}function g_(n,e,t,r,i,a){const l=n.createContext(1,e,t),d=[zo(e,r,t)],m=[i];if(a.length%2!=0)throw new Z(G.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<a.length;E+=2)d.push(zo(e,a[E])),m.push(a[E+1]);const g=[],v=Yt.empty();for(let E=d.length-1;E>=0;--E)if(!Zx(g,d[E])){const A=d[E];let O=m[E];O=xe(O);const U=l.childContextForFieldPath(A);if(O instanceof sh)g.push(A);else{const L=Ko(O,U);L!=null&&(g.push(A),v.set(A,L))}}const I=new Cn(g);return new Hx(v,I,l.fieldTransforms)}function Qx(n,e,t,r=!1){return Ko(t,n.createContext(r?4:3,e))}function Ko(n,e){if(Yx(n=xe(n)))return y_("Unsupported field value:",e,n),Jx(n,e);if(n instanceof Ho)return(function(r,i){if(!Gx(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(i);a&&i.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,i){const a=[];let l=0;for(const d of r){let m=Ko(d,i.childContextForArray(l));m==null&&(m={nullValue:"NULL_VALUE"}),a.push(m),l++}return{arrayValue:{values:a}}})(n,e)}return(function(r,i){if((r=xe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return wT(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=He.fromDate(r);return{timestampValue:vl(i.serializer,a)}}if(r instanceof He){const a=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vl(i.serializer,a)}}if(r instanceof mr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ln)return{bytesValue:bT(i.serializer,r._byteString)};if(r instanceof et){const a=i.databaseId,l=r.firestore._databaseId;if(!l.isEqual(a))throw i.createError(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Oy(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof pr)return(function(l,d){const m=l instanceof pr?l.toArray():l;return{mapValue:{fields:{[Ay]:{stringValue:Cy},[ml]:{arrayValue:{values:m.map((v=>{if(typeof v!="number")throw d.createError("VectorValues must only contain numeric values.");return Ry(d.serializer,v)}))}}}}}})(r,i);if(qT(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${Df(r)}`)})(n,e)}function Jx(n,e){const t={};return Q1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Li(n,((r,i)=>{const a=Ko(i,e.childContextForField(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function Yx(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof He||n instanceof mr||n instanceof ln||n instanceof et||n instanceof Ho||n instanceof pr||qT(n))}function y_(n,e,t){if(!Yx(t)||!R1(t)){const r=Df(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function zo(n,e,t){if((e=xe(e))instanceof Bo)return e._internalPath;if(typeof e=="string")return Xx(n,e);throw _f("Field path arguments must be of type string or ",n,!1,void 0,t)}const pV=new RegExp("[~\\*/\\[\\]]");function Xx(n,e,t){if(e.search(pV)>=0)throw _f(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Bo(...e.split("."))._internalPath}catch{throw _f(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function _f(n,e,t,r,i){const a=r&&!r.isEmpty(),l=i!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let m="";return(a||l)&&(m+=" (found",a&&(m+=` in field ${r}`),l&&(m+=` in document ${i}`),m+=")"),new Z(G.INVALID_ARGUMENT,d+n+m)}function Zx(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{convertValue(e,t="none"){switch(Ci(e)){case 0:return null;case 1:return e.booleanValue;case 2:return at(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw de(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Li(e,((i,a)=>{r[i]=this.convertValue(a,t)})),r}convertVectorValue(e){var r,i,a;const t=(a=(i=(r=e.fields)==null?void 0:r[ml].arrayValue)==null?void 0:i.values)==null?void 0:a.map((l=>at(l.doubleValue)));return new pr(t)}convertGeoPoint(e){return new mr(at(e.latitude),at(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ff(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Cu(e));default:return null}}convertTimestamp(e){const t=Ts(e);return new He(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=je.fromString(e);ye(WT(r),9688,{name:e});const i=new Ai(r.get(1),r.get(3)),a=new le(r.popFirst(5));return i.isEqual(t)||xt(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends __{constructor(e){super(),this.firestore=e}convertBytes(e){return new ln(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new et(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gV(){return new sh("deleteField")}function yV(){return new h_("serverTimestamp")}function _V(...n){return new d_("arrayUnion",n)}function vV(...n){return new f_("arrayRemove",n)}function wV(n){return new m_("increment",n)}const qI="@firebase/firestore",$I="4.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const a of r)if(a in i&&typeof i[a]=="function")return!0;return!1})(n,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new et(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new IV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(zo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class IV extends Vu{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Z(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class v_{}class ih extends v_{}function hi(n,e,...t){let r=[];e instanceof v_&&r.push(e),r=r.concat(t),(function(a){const l=a.filter((m=>m instanceof w_)).length,d=a.filter((m=>m instanceof Xf)).length;if(l>1||l>0&&d>0)throw new Z(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Xf extends ih{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Xf(e,t,r)}_apply(e){const t=this._parse(e);return nS(e._query,t),new _n(e.firestore,e.converter,Tg(e._query,t))}_parse(e){const t=Go(e.firestore);return(function(a,l,d,m,g,v,I){let E;if(g.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new Z(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){GI(I,v);const O=[];for(const U of I)O.push(HI(m,a,U));E={arrayValue:{values:O}}}else E=HI(m,a,I)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||GI(I,v),E=Qx(d,l,I,v==="in"||v==="not-in");return Oe.create(g,v,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function EV(n,e,t){const r=e,i=zo("where",n);return Xf._create(i,r,t)}class w_ extends v_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new w_(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Ke.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,a){let l=i;const d=a.getFlattenedFilters();for(const m of d)nS(l,m),l=Tg(l,m)})(e._query,t),new _n(e.firestore,e.converter,Tg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class I_ extends ih{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new I_(e,t)}_apply(e){const t=(function(i,a,l){if(i.startAt!==null)throw new Z(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Z(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Pu(a,l)})(e._query,this._field,this._direction);return new _n(e.firestore,e.converter,Cb(e._query,t))}}function TV(n,e="asc"){const t=e,r=zo("orderBy",n);return I_._create(r,t)}class Zf extends ih{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Zf(e,t,r)}_apply(e){return new _n(e.firestore,e.converter,lf(e._query,this._limit,this._limitType))}}function xV(n){return b1("limit",n),Zf._create("limit",n,"F")}function SV(n){return b1("limitToLast",n),Zf._create("limitToLast",n,"L")}class em extends ih{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new em(e,t,r)}_apply(e){const t=tS(e,this.type,this._docOrFields,this._inclusive);return new _n(e.firestore,e.converter,kb(e._query,t))}}function AV(...n){return em._create("startAt",n,!0)}function CV(...n){return em._create("startAfter",n,!1)}class tm extends ih{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new tm(e,t,r)}_apply(e){const t=tS(e,this.type,this._docOrFields,this._inclusive);return new _n(e.firestore,e.converter,Nb(e._query,t))}}function kV(...n){return tm._create("endBefore",n,!1)}function NV(...n){return tm._create("endAt",n,!0)}function tS(n,e,t,r){if(t[0]=xe(t[0]),t[0]instanceof Vu)return(function(a,l,d,m,g){if(!m)throw new Z(G.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const v=[];for(const I of tl(a))if(I.field.isKeyField())v.push(Do(l,m.key));else{const E=m.data.field(I.field);if(Mf(E))throw new Z(G.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+I.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(E===null){const A=I.field.canonicalString();throw new Z(G.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}v.push(E)}return new Ni(v,g)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Go(n.firestore);return(function(l,d,m,g,v,I){const E=l.explicitOrderBy;if(v.length>E.length)throw new Z(G.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const A=[];for(let O=0;O<v.length;O++){const U=v[O];if(E[O].field.isKeyField()){if(typeof U!="string")throw new Z(G.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof U}`);if(!Ny(l)&&U.indexOf("/")!==-1)throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${U}' contains a slash.`);const L=l.path.child(je.fromString(U));if(!le.isDocumentKey(L))throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${L}' is not because it contains an odd number of segments.`);const oe=new le(L);A.push(Do(d,oe))}else{const L=Qx(m,g,U);A.push(L)}}return new Ni(A,I)})(n._query,n.firestore._databaseId,i,e,t,r)}}function HI(n,e,t){if(typeof(t=xe(t))=="string"){if(t==="")throw new Z(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ny(e)&&t.indexOf("/")!==-1)throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(je.fromString(t));if(!le.isDocumentKey(r))throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Do(n,new le(r))}if(t instanceof et)return Do(n,t._key);throw new Z(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Df(t)}.`)}function GI(n,e){if(!Array.isArray(n)||n.length===0)throw new Z(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nS(n,e){const t=(function(i,a){for(const l of i)for(const d of l.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Z(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Z(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function nm(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class PV extends __{constructor(e){super(),this.firestore=e}convertBytes(e){return new ln(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new et(this.firestore,null,t)}}class So{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Zn=class rS extends Vu{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new mu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(zo("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(G.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=rS._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Zn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zn._jsonSchema={type:Dt("string",Zn._jsonSchemaVersion),bundleSource:Dt("string","DocumentSnapshot"),bundleName:Dt("string"),bundle:Dt("string")};let mu=class extends Zn{data(e={}){return super.data(e)}},gr=class sS{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new So(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new mu(this._firestore,this._userDataWriter,r.key,r,new So(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Z(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,a){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((d=>{const m=new mu(i._firestore,i._userDataWriter,d.doc.key,d.doc,new So(i._snapshot.mutatedKeys.has(d.doc.key),i._snapshot.fromCache),i.query.converter);return d.doc,{type:"added",doc:m,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const m=new mu(i._firestore,i._userDataWriter,d.doc.key,d.doc,new So(i._snapshot.mutatedKeys.has(d.doc.key),i._snapshot.fromCache),i.query.converter);let g=-1,v=-1;return d.type!==0&&(g=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),v=l.indexOf(d.doc.key)),{type:RV(d.type),doc:m,oldIndex:g,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(G.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=sS._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_y.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function RV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de(61501,{type:n})}}function iS(n,e){return n instanceof Zn&&e instanceof Zn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof gr&&e instanceof gr&&n._firestore===e._firestore&&Wx(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gr._jsonSchemaVersion="firestore/querySnapshot/1.0",gr._jsonSchema={type:Dt("string",gr._jsonSchemaVersion),bundleSource:Dt("string","QuerySnapshot"),bundleName:Dt("string"),bundle:Dt("string")};const bV={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DV=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Go(e)}set(e,t,r){this._verifyNotCommitted();const i=pi(e,this._firestore),a=nm(i.converter,t,r),l=Yf(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,r);return this._mutations.push(l.toMutation(i._key,ut.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=pi(e,this._firestore);let l;return l=typeof(t=xe(t))=="string"||t instanceof Bo?g_(this._dataReader,"WriteBatch.update",a._key,t,r,i):p_(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,ut.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=pi(e,this._firestore);return this._mutations=this._mutations.concat(new Vl(t._key,ut.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Z(G.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function pi(n,e){if((n=xe(n)).firestore!==e)throw new Z(G.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Go(e)}get(e){const t=pi(e,this._firestore),r=new PV(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return de(24041);const a=i[0];if(a.isFoundDocument())return new Vu(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new Vu(this._firestore,r,t._key,null,t.converter);throw de(18433,{doc:a})}))}set(e,t,r){const i=pi(e,this._firestore),a=nm(i.converter,t,r),l=Yf(this._dataReader,"Transaction.set",i._key,a,i.converter!==null,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=pi(e,this._firestore);let l;return l=typeof(t=xe(t))=="string"||t instanceof Bo?g_(this._dataReader,"Transaction.update",a._key,t,r,i):p_(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=pi(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VV=class extends jV{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=pi(e,this._firestore),r=new Qo(this._firestore);return super.get(e).then((i=>new Zn(this._firestore,r,t._key,i._document,new So(!1,!1),t.converter)))}};function LV(n,e,t){n=We(n,At);const r={...bV,...t};(function(l){if(l.maxAttempts<1)throw new Z(G.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const i=un(n);return Qj(i,(a=>e(new VV(n,a))),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(n){n=We(n,et);const e=We(n.firestore,At),t=un(e);return Vx(t,n._key).then((r=>E_(e,n,r)))}function MV(n){n=We(n,et);const e=We(n.firestore,At),t=un(e),r=new Qo(e);return $j(t,n._key).then((i=>new Zn(e,r,n._key,i,new So(i!==null&&i.hasLocalMutations,!0),n.converter)))}function FV(n){n=We(n,et);const e=We(n.firestore,At),t=un(e);return Vx(t,n._key,{source:"server"}).then((r=>E_(e,n,r)))}function UV(n){n=We(n,_n);const e=We(n.firestore,At),t=un(e),r=new Qo(e);return eS(n._query),Lx(t,n._query).then((i=>new gr(e,r,n,i)))}function BV(n){n=We(n,_n);const e=We(n.firestore,At),t=un(e),r=new Qo(e);return Hj(t,n._query).then((i=>new gr(e,r,n,i)))}function zV(n){n=We(n,_n);const e=We(n.firestore,At),t=un(e),r=new Qo(e);return Lx(t,n._query,{source:"server"}).then((i=>new gr(e,r,n,i)))}function KI(n,e,t){n=We(n,et);const r=We(n.firestore,At),i=nm(n.converter,e,t),a=Go(r);return oh(r,[Yf(a,"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ut.none())])}function QI(n,e,t,...r){n=We(n,et);const i=We(n.firestore,At),a=Go(i);let l;return l=typeof(e=xe(e))=="string"||e instanceof Bo?g_(a,"updateDoc",n._key,e,t,r):p_(a,"updateDoc",n._key,e),oh(i,[l.toMutation(n._key,ut.exists(!0))])}function WV(n){return oh(We(n.firestore,At),[new Vl(n._key,ut.none())])}function qV(n,e){const t=We(n.firestore,At),r=yf(n),i=nm(n.converter,e),a=Go(n.firestore);return oh(t,[Yf(a,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,ut.exists(!1))]).then((()=>r))}function oS(n,...e){var g,v,I;n=xe(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Lg(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Lg(e[r])){const E=e[r];e[r]=(g=E.next)==null?void 0:g.bind(E),e[r+1]=(v=E.error)==null?void 0:v.bind(E),e[r+2]=(I=E.complete)==null?void 0:I.bind(E)}let a,l,d;if(n instanceof et)l=We(n.firestore,At),d=Dl(n._key.path),a={next:E=>{e[r]&&e[r](E_(l,n,E))},error:e[r+1],complete:e[r+2]};else{const E=We(n,_n);l=We(E.firestore,At),d=E._query;const A=new Qo(l);a={next:O=>{e[r]&&e[r](new gr(l,A,E,O))},error:e[r+1],complete:e[r+2]},eS(n._query)}const m=un(l);return qj(m,d,i,a)}function $V(n,e){n=We(n,At);const t=un(n),r=Lg(e)?e:{next:e};return Kj(t,r)}function oh(n,e){const t=un(n);return Gj(t,e)}function E_(n,e,t){const r=t.docs.get(e._key),i=new Qo(n);return new Zn(n,i,e._key,r,new So(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){ER(bi),xi(new Kr("firestore",((r,{instanceIdentifier:i,options:a})=>{const l=r.getProvider("app").getImmediate(),d=new At(new CR(r.getProvider("auth-internal")),new PR(l,r.getProvider("app-check-internal")),mb(l,i),l);return a={useFetchStreams:t,...a},d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),fr(qI,$I,e),fr(qI,$I,"esm2020")})();const HV="@firebase/firestore-compat",GV="0.4.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new Z("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(){if(typeof Uint8Array>"u")throw new Z("unimplemented","Uint8Arrays are not available in this environment.")}function YI(){if(!hb())throw new Z("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Lu{constructor(e){this._delegate=e}static fromBase64String(e){return YI(),new Lu(ln.fromBase64String(e))}static fromUint8Array(e){return JI(),new Lu(ln.fromUint8Array(e))}toBase64(){return YI(),this._delegate.toBase64()}toUint8Array(){return JI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(n){return KV(n,["next","error","complete"])}function KV(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{enableIndexedDbPersistence(e,t){return sV(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return iV(e._delegate)}clearIndexedDbPersistence(e){return oV(e._delegate)}}class aS{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ai||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Jr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){eV(this._delegate,e,t,r)}enableNetwork(){return lV(this._delegate)}disableNetwork(){return cV(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,P1("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return aV(this._delegate)}onSnapshotsInSync(e){return $V(this._delegate,e)}get app(){if(!this._appCompat)throw new Z("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Al(this,Bx(this._delegate,e))}catch(t){throw pn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Xn(this,yf(this._delegate,e))}catch(t){throw pn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new mn(this,tV(this._delegate,e))}catch(t){throw pn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return LV(this._delegate,t=>e(new lS(this,t)))}batch(){return un(this._delegate),new cS(new DV(this._delegate,e=>oh(this._delegate,e)))}loadBundle(e){return uV(this._delegate,e)}namedQuery(e){return hV(this._delegate,e).then(t=>t?new mn(this,t):null)}}class rm extends __{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lu(new ln(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Xn.forKey(t,this.firestore,null)}}function JV(n){TR(n)}class lS{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new rm(e)}get(e){const t=Ao(e);return this._delegate.get(t).then(r=>new Ou(this._firestore,new Zn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Ao(e);return r?(T_("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=Ao(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=Ao(e);return this._delegate.delete(t),this}}class cS{constructor(e){this._delegate=e}set(e,t,r){const i=Ao(e);return r?(T_("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=Ao(e);return arguments.length===2?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=Ao(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Wo{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new mu(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Mu(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Wo.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new Wo(e,new rm(e),t),i.set(t,a)),a}}Wo.INSTANCES=new WeakMap;class Xn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new rm(e)}static forPath(e,t,r){if(e.length%2!==0)throw new Z("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Xn(t,new et(t._delegate,r,new le(e)))}static forKey(e,t,r){return new Xn(t,new et(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Al(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Al(this.firestore,Bx(this._delegate,e))}catch(t){throw pn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=xe(e),e instanceof et?zx(this._delegate,e):!1}set(e,t){t=T_("DocumentReference.set",t);try{return t?KI(this._delegate,e,t):KI(this._delegate,e)}catch(r){throw pn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?QI(this._delegate,e):QI(this._delegate,e,t,...r)}catch(i){throw pn(i,"updateDoc()","DocumentReference.update()")}}delete(){return WV(this._delegate)}onSnapshot(...e){const t=uS(e),r=hS(e,i=>new Ou(this.firestore,new Zn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return oS(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=MV(this._delegate):(e==null?void 0:e.source)==="server"?t=FV(this._delegate):t=OV(this._delegate),t.then(r=>new Ou(this.firestore,new Zn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Xn(this.firestore,e?this._delegate.withConverter(Wo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function pn(n,e,t){return n.message=n.message.replace(e,t),n}function uS(n){for(const e of n)if(typeof e=="object"&&!Og(e))return e;return{}}function hS(n,e){var r,i;let t;return Og(n[0])?t=n[0]:Og(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:a=>{t.next&&t.next(e(a))},error:(r=t.error)==null?void 0:r.bind(t),complete:(i=t.complete)==null?void 0:i.bind(t)}}class Ou{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Xn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return iS(this._delegate,e._delegate)}}class Mu extends Ou{data(e){const t=this._delegate.data(e);return this._delegate._converter||xR(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class mn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new rm(e)}where(e,t,r){try{return new mn(this.firestore,hi(this._delegate,EV(e,t,r)))}catch(i){throw pn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new mn(this.firestore,hi(this._delegate,TV(e,t)))}catch(r){throw pn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new mn(this.firestore,hi(this._delegate,xV(e)))}catch(t){throw pn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new mn(this.firestore,hi(this._delegate,SV(e)))}catch(t){throw pn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new mn(this.firestore,hi(this._delegate,AV(...e)))}catch(t){throw pn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new mn(this.firestore,hi(this._delegate,CV(...e)))}catch(t){throw pn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new mn(this.firestore,hi(this._delegate,kV(...e)))}catch(t){throw pn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new mn(this.firestore,hi(this._delegate,NV(...e)))}catch(t){throw pn(t,"endAt()","Query.endAt()")}}isEqual(e){return Wx(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=BV(this._delegate):(e==null?void 0:e.source)==="server"?t=zV(this._delegate):t=UV(this._delegate),t.then(r=>new Mg(this.firestore,new gr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=uS(e),r=hS(e,i=>new Mg(this.firestore,new gr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return oS(this._delegate,t,r)}withConverter(e){return new mn(this.firestore,e?this._delegate.withConverter(Wo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class YV{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Mu(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Mg{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new mn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Mu(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new YV(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Mu(this._firestore,r))})}isEqual(e){return iS(this._delegate,e._delegate)}}class Al extends mn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Xn(this.firestore,e):null}doc(e){try{return e===void 0?new Xn(this.firestore,yf(this._delegate)):new Xn(this.firestore,yf(this._delegate,e))}catch(t){throw pn(t,"doc()","CollectionReference.doc()")}}add(e){return qV(this._delegate,e).then(t=>new Xn(this.firestore,t))}isEqual(e){return zx(this._delegate,e._delegate)}withConverter(e){return new Al(this.firestore,e?this._delegate.withConverter(Wo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ao(n){return We(n,et)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(...e){this._delegate=new Bo(...e)}static documentId(){return new x_(ct.keyField().canonicalString())}isEqual(e){return e=xe(e),e instanceof Bo?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{static serverTimestamp(){const e=yV();return e._methodName="FieldValue.serverTimestamp",new Io(e)}static delete(){const e=gV();return e._methodName="FieldValue.delete",new Io(e)}static arrayUnion(...e){const t=_V(...e);return t._methodName="FieldValue.arrayUnion",new Io(t)}static arrayRemove(...e){const t=vV(...e);return t._methodName="FieldValue.arrayRemove",new Io(t)}static increment(e){const t=wV(e);return t._methodName="FieldValue.increment",new Io(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XV={Firestore:aS,GeoPoint:mr,Timestamp:He,Blob:Lu,Transaction:lS,WriteBatch:cS,DocumentReference:Xn,DocumentSnapshot:Ou,Query:mn,QueryDocumentSnapshot:Mu,QuerySnapshot:Mg,CollectionReference:Al,FieldPath:x_,FieldValue:Io,setLogLevel:JV,CACHE_SIZE_UNLIMITED:rV};function ZV(n,e){n.INTERNAL.registerComponent(new Kr("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps({...XV}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(n){ZV(n,(e,t)=>new aS(e,t,new QV)),n.registerVersion(HV,GV)}e4(Lt);const dS={apiKey:"AIzaSyCieAhFTn4dL0FuB-SAC4-gtYBVrJlpHrA",authDomain:"web-kantawan.firebaseapp.com",projectId:"web-kantawan",storageBucket:"web-kantawan.firebasestorage.app",messagingSenderId:"281106098218",appId:"1:281106098218:web:1d782331286c6b779e7b53",measurementId:"G-T4J8H8WN7P"},t4=dS.apiKey==="YOUR_API_KEY_HERE";let Eo,ht;t4?(console.warn(" Firebase config not set! Please update src/firebase.js with your Firebase configuration."),console.warn("Get your config from: https://console.firebase.google.com/"),Eo={onAuthStateChanged:n=>(n(null),()=>{}),signInWithEmailAndPassword:()=>Promise.reject(new Error("Firebase not configured")),createUserWithEmailAndPassword:()=>Promise.reject(new Error("Firebase not configured")),signInWithPopup:()=>Promise.reject(new Error("Firebase not configured")),signOut:()=>Promise.resolve()},ht={collection:()=>({doc:()=>({get:()=>Promise.resolve({exists:!1}),set:()=>Promise.resolve(),update:()=>Promise.resolve()}),get:()=>Promise.resolve({docs:[]}),add:()=>Promise.resolve({id:"mock-id"})})}):(Lt.apps.length||Lt.initializeApp(dS),Eo=Lt.auth(),ht=Lt.firestore());const Xr=$.createContext(),fS=$.createContext(),Ul=$.createContext(),_r=$.createContext(),Zr=$.createContext(),sm=$.createContext(),n4=.029;function r4({children:n}){const[e,t]=$.useState("THB"),[r,i]=$.useState(!1),a=d=>e==="USD"?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d*n4):new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(d),l=d=>{t(d),i(!1)};return u.jsx(Zr.Provider,{value:{currency:e,setCurrency:t,formatPrice:a,isDropdownOpen:r,setIsDropdownOpen:i,toggleCurrency:l},children:n})}function s4({children:n}){const[e,t]=$.useState(null),[r,i]=$.useState(!0),[a,l]=$.useState(!1),[d,m]=$.useState("menu"),[g,v]=$.useState("");$.useEffect(()=>{const J=Eo.onAuthStateChanged(async W=>{var Y,he;if(W)try{const Q=await ht.collection("users").doc(W.uid).get();Q.exists?t({id:W.uid,email:W.email,...Q.data()}):t({id:W.uid,email:W.email,firstName:((Y=W.displayName)==null?void 0:Y.split(" ")[0])||"User",lastName:((he=W.displayName)==null?void 0:he.split(" ")[1])||""})}catch(Q){console.error("Error fetching user data:",Q),t({id:W.uid,email:W.email,firstName:"User"})}else t(null);i(!1)});return()=>J()},[]);const I=async J=>{try{v("");const W=await Eo.createUserWithEmailAndPassword(J.email,J.password);return await ht.collection("users").doc(W.user.uid).set({firstName:J.firstName,lastName:J.lastName,email:J.email,phone:J.phone||"",address:J.address||"",otherInfo:J.otherInfo||"",username:J.username,createdAt:Lt.firestore.FieldValue.serverTimestamp()}),l(!1),!0}catch(W){return console.error("Registration error:",W),W.code==="auth/email-already-in-use"?v("!"):W.code==="auth/weak-password"?v(" 6 !"):W.code==="auth/invalid-email"?v("!"):v(": "+W.message),!1}},E=async(J,W)=>{try{return v(""),await Eo.signInWithEmailAndPassword(J,W),l(!1),!0}catch(Y){return console.error("Login error:",Y),Y.code==="auth/user-not-found"||Y.code==="auth/wrong-password"?v("!"):Y.code==="auth/invalid-email"?v("!"):v(": "+Y.message),!1}},A=async()=>{var J,W;try{v("");const Y=new Lt.auth.GoogleAuthProvider,he=await Eo.signInWithPopup(Y);return(await ht.collection("users").doc(he.user.uid).get()).exists||await ht.collection("users").doc(he.user.uid).set({firstName:((J=he.user.displayName)==null?void 0:J.split(" ")[0])||"User",lastName:((W=he.user.displayName)==null?void 0:W.split(" ").slice(1).join(" "))||"",email:he.user.email,phone:"",address:"",createdAt:Lt.firestore.FieldValue.serverTimestamp()}),l(!1),!0}catch(Y){return console.error("Google login error:",Y),Y.code!=="auth/popup-closed-by-user"&&v(" Google"),!1}},O=async()=>{try{await Eo.signOut(),t(null)}catch(J){console.error("Logout error:",J)}},U=!!e,L=(J="menu")=>{m(J),v(""),l(!0)},oe=()=>{l(!1),m("menu"),v("")};return r?u.jsx("div",{className:"auth-loading",children:"Loading..."}):u.jsx(_r.Provider,{value:{user:e,isLoggedIn:U,register:I,login:E,loginWithGoogle:A,logout:O,isAuthModalOpen:a,setIsAuthModalOpen:l,authMode:d,setAuthMode:m,authError:g,setAuthError:v,openAuthModal:L,closeAuthModal:oe},children:n})}function i4({children:n}){const[e,t]=$.useState([]),[r,i]=$.useState(!1),{user:a}=$.useContext(_r);$.useEffect(()=>{if(a!=null&&a.id){const E=ht.collection("wishlists").doc(a.id).onSnapshot(A=>{A.exists?t(A.data().items||[]):t([])},A=>{console.error("Error loading wishlist:",A)});return()=>E()}else t([])},[a==null?void 0:a.id]);const l=async E=>{if(a!=null&&a.id)try{await ht.collection("wishlists").doc(a.id).set({items:E,updatedAt:Lt.firestore.FieldValue.serverTimestamp()})}catch(A){console.error("Error saving wishlist:",A)}},d=E=>{t(A=>{var L;if(A.find(oe=>oe.id===E.id))return A;const U=[...A,{id:E.id,name:E.name,price:E.price,image:E.image||((L=E.images)==null?void 0:L[0])}];return l(U),U})},m=E=>{t(A=>{const O=A.filter(U=>U.id!==E);return l(O),O})},g=E=>{e.find(O=>O.id===E.id)?m(E.id):d(E)},v=E=>e.some(A=>A.id===E),I=e.length;return u.jsx(Ul.Provider,{value:{wishlist:e,addToWishlist:d,removeFromWishlist:m,toggleWishlist:g,isInWishlist:v,wishlistCount:I,isWishlistOpen:r,setIsWishlistOpen:i},children:n})}function o4({children:n}){const[e,t]=$.useState([]),[r,i]=$.useState(!1),[a,l]=$.useState(!1),[d,m]=$.useState({show:!1,message:""}),{user:g}=$.useContext(_r);$.useEffect(()=>{if(g!=null&&g.id){const J=ht.collection("carts").doc(g.id).onSnapshot(W=>{W.exists?t(W.data().items||[]):t([])},W=>{console.error("Error loading cart:",W)});return()=>J()}else t([])},[g==null?void 0:g.id]);const v=async J=>{if(g!=null&&g.id)try{await ht.collection("carts").doc(g.id).set({items:J,updatedAt:Lt.firestore.FieldValue.serverTimestamp()})}catch(W){console.error("Error saving cart:",W)}},I=()=>{t([]),g!=null&&g.id&&v([])},E=J=>{t(W=>{var Q;const Y=W.find(P=>P.id===J.id&&P.selectedSize===J.selectedSize);let he;return Y?he=W.map(P=>P.id===J.id&&P.selectedSize===J.selectedSize?{...P,quantity:P.quantity+1}:P):he=[...W,{id:J.id,name:J.name,price:J.price,image:J.image||((Q=J.images)==null?void 0:Q[0]),selectedSize:J.selectedSize,quantity:1}],v(he),he}),oe(`Added ${J.name} to cart!`)},A=(J,W)=>{t(Y=>{const he=Y.filter(Q=>!(Q.id===J&&Q.selectedSize===W));return v(he),he})},O=(J,W,Y)=>{t(he=>{const Q=he.map(P=>{if(P.id===J&&P.selectedSize===W){const S=Math.max(1,P.quantity+Y);return{...P,quantity:S}}return P});return v(Q),Q})},U=e.reduce((J,W)=>J+W.price*W.quantity,0),L=e.reduce((J,W)=>J+W.quantity,0),oe=J=>{m({show:!0,message:J}),setTimeout(()=>m({show:!1,message:""}),3e3)};return u.jsx(Xr.Provider,{value:{cart:e,addToCart:E,removeFromCart:A,updateQuantity:O,clearCart:I,cartTotal:U,cartCount:L,isCartOpen:r,setIsCartOpen:i,isCheckoutOpen:a,setIsCheckoutOpen:l,toast:d},children:n})}function a4({children:n}){const[e,t]=$.useState(!1);$.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light")},[e]);const r=()=>t(i=>!i);return u.jsx(fS.Provider,{value:{isDark:e,toggleTheme:r},children:n})}function l4({children:n}){const[e,t]=$.useState([]),[r,i]=$.useState(!1),a=g=>{if(e.length>=3){alert(" 3 ");return}if(e.find(v=>v.id===g.id)){alert("");return}t([...e,g])},l=g=>{t(e.filter(v=>v.id!==g))},d=()=>{t([])},m=g=>e.some(v=>v.id===g);return u.jsx(sm.Provider,{value:{compareList:e,addToCompare:a,removeFromCompare:l,clearCompare:d,isInCompare:m,isCompareOpen:r,setIsCompareOpen:i,compareCount:e.length},children:n})}const c4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),u.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),u4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),h4=n=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:u.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),d4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),u.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),f4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("circle",{cx:"9",cy:"21",r:"1"}),u.jsx("circle",{cx:"20",cy:"21",r:"1"}),u.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),m4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),u.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),p4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("circle",{cx:"12",cy:"8",r:"5"}),u.jsx("path",{d:"M3 21v-2a7 7 0 0 1 7-7h4a7 7 0 0 1 7 7v2"}),u.jsx("line",{x1:"12",y1:"17",x2:"12",y2:"22"}),u.jsx("line",{x1:"9",y1:"22",x2:"15",y2:"22"})]}),g4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("circle",{cx:"12",cy:"8",r:"5"}),u.jsx("path",{d:"M3 21v-2a7 7 0 0 1 7-7h4a7 7 0 0 1 7 7v2"})]}),y4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),u.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),u.jsx("path",{d:"M16 10a4 4 0 0 1-8 0"})]}),_4=n=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:u.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),v4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),u.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),mS=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),u.jsx("polyline",{points:"22,6 12,13 2,6"})]}),w4=n=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",...n,children:u.jsx("path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"})}),I4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[u.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"5",ry:"5"}),u.jsx("path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"}),u.jsx("line",{x1:"17.5",y1:"6.5",x2:"17.51",y2:"6.5"})]}),E4=n=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",...n,children:u.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),T4=n=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",...n,children:u.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),x4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...n,children:[u.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),u.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),S4=n=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...n,children:u.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),A4=n=>u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...n,children:u.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),C4=n=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("polyline",{points:"12 6 12 12 16 14"})]});function k4({currentPage:n,onNavigate:e,onNavigateCategory:t,onShowSearch:r,onShowRegistration:i}){const[a,l]=$.useState(!1),[d,m]=$.useState(!1),{cartCount:g,setIsCartOpen:v}=$.useContext(Xr),{toggleTheme:I,isDark:E}=$.useContext(fS),{wishlistCount:A,setIsWishlistOpen:O}=$.useContext(Ul),{isLoggedIn:U,openAuthModal:L,user:oe}=$.useContext(_r),{currency:J,toggleCurrency:W,isDropdownOpen:Y,setIsDropdownOpen:he}=$.useContext(Zr);return $.useEffect(()=>{const Q=()=>l(window.scrollY>50);return window.addEventListener("scroll",Q),()=>window.removeEventListener("scroll",Q)},[]),u.jsxs("header",{className:`navbar-container ${a?"scrolled":""}`,children:[u.jsxs("nav",{className:"main-nav",children:[u.jsx("div",{className:"main-nav-left",children:u.jsxs("button",{className:"menu-btn",onClick:()=>m(!d),"aria-label":"","aria-expanded":d,"aria-controls":"mobile-menu",children:[" ",u.jsx("span",{children:"MENU"})]})}),u.jsx("div",{className:"logo",onClick:()=>e("home"),style:{cursor:"pointer"},children:"MAISON"}),u.jsxs("div",{className:"main-nav-right",children:[u.jsxs("div",{className:"currency-selector",children:[u.jsxs("button",{className:"nav-icon currency-btn",title:"Currency",onClick:()=>he(!Y),"aria-label":`  ${J}`,"aria-expanded":Y,"aria-haspopup":"listbox",children:[u.jsx(c4,{}),u.jsxs("span",{className:"currency-text",children:[J==="THB"?" THB":"$ USD"," "]})]}),Y&&u.jsxs("div",{className:"currency-dropdown",children:[u.jsxs("button",{className:`currency-option ${J==="THB"?"active":""}`,onClick:()=>W("THB"),children:[u.jsx("span",{className:"currency-symbol",children:""}),u.jsx("span",{className:"currency-name",children:"THB - Thai Baht"})]}),u.jsxs("button",{className:`currency-option ${J==="USD"?"active":""}`,onClick:()=>W("USD"),children:[u.jsx("span",{className:"currency-symbol",children:"$"}),u.jsx("span",{className:"currency-name",children:"USD - US Dollar"})]})]})]}),u.jsx("button",{className:"nav-icon",title:"Search","aria-label":"",onClick:r,children:u.jsx(u4,{})}),u.jsxs("button",{className:"nav-icon wishlist-btn",title:"Wishlist",onClick:()=>O(!0),"aria-label":"",children:[u.jsx(h4,{}),A>0&&u.jsx("span",{className:"wishlist-badge",children:A})]}),u.jsxs("button",{className:`nav-icon account-btn ${U?"logged-in":""}`,title:U?`Hi, ${oe.firstName}`:"Account",onClick:()=>L("menu"),"aria-label":U?` ${oe.firstName}`:"",children:[u.jsx(d4,{}),U&&u.jsx("span",{className:"login-indicator"})]}),u.jsxs("button",{className:"nav-icon cart-btn",onClick:()=>v(!0),title:"Cart","aria-label":` ${g} `,children:[u.jsx(f4,{}),g>0&&u.jsx("span",{className:"cart-badge",children:g})]}),u.jsx("button",{className:"theme-toggle",onClick:I,title:"Toggle Theme","aria-label":E?"":""})]})]}),u.jsxs("nav",{className:`secondary-nav ${a?"hidden":""}`,children:[u.jsx("a",{href:"#",onClick:Q=>{Q.preventDefault(),t("women")},children:"WOMENS+"}),u.jsx("a",{href:"#",onClick:Q=>{Q.preventDefault(),t("men")},children:"MENS+"}),u.jsx("a",{href:"#",onClick:Q=>{Q.preventDefault(),t("unisex")},children:"UNISEX+"}),u.jsx("a",{href:"#",onClick:Q=>{Q.preventDefault(),e("sale")},className:"sale-link",children:" FINAL SALE"}),u.jsx("a",{href:"#",onClick:Q=>{Q.preventDefault(),t("sports")},className:"sports-link",children:" SPORTS"}),u.jsx("a",{href:"#about",onClick:Q=>{Q.preventDefault(),e("home"),setTimeout(()=>document.getElementById("about").scrollIntoView(),100)},children:"ABOUT US"}),u.jsx("a",{href:"#",onClick:Q=>{Q.preventDefault(),i?i():e("contact")},children:"CONTACT US"}),u.jsx("a",{href:"#faq",onClick:Q=>{Q.preventDefault(),e("home"),setTimeout(()=>document.getElementById("faq").scrollIntoView(),100)},children:"FAQ"})]}),d&&u.jsx("div",{className:"mobile-menu-overlay",onClick:()=>m(!1),role:"dialog","aria-modal":"true","aria-label":"",children:u.jsxs("div",{className:"mobile-menu",id:"mobile-menu",onClick:Q=>Q.stopPropagation(),role:"navigation",children:[u.jsx("button",{className:"mobile-menu-close",onClick:()=>m(!1),"aria-label":"",children:""}),u.jsxs("a",{href:"#",onClick:Q=>{Q.preventDefault(),e("home"),m(!1)},children:[u.jsx(m4,{style:{marginRight:"12px",verticalAlign:"middle"}}),"HOME"]}),u.jsxs("a",{href:"#",onClick:Q=>{Q.preventDefault(),t("women"),m(!1)},children:[u.jsx(p4,{style:{marginRight:"12px",verticalAlign:"middle"}}),"WOMENS"]}),u.jsxs("a",{href:"#",onClick:Q=>{Q.preventDefault(),t("men"),m(!1)},children:[u.jsx(g4,{style:{marginRight:"12px",verticalAlign:"middle"}}),"MENS"]}),u.jsxs("a",{href:"#",onClick:Q=>{Q.preventDefault(),t("all"),m(!1)},children:[u.jsx(y4,{style:{marginRight:"12px",verticalAlign:"middle"}}),"BRANDS"]}),u.jsxs("a",{href:"#",onClick:Q=>{Q.preventDefault(),e("sale"),m(!1)},children:[u.jsx(_4,{style:{marginRight:"12px",verticalAlign:"middle"}}),"FINAL SALE"]}),u.jsxs("a",{href:"#about",onClick:Q=>{Q.preventDefault(),e("home"),setTimeout(()=>document.getElementById("about").scrollIntoView(),100),m(!1)},children:[u.jsx(v4,{style:{marginRight:"12px",verticalAlign:"middle"}}),"ABOUT US"]}),u.jsxs("a",{href:"#",onClick:Q=>{Q.preventDefault(),i&&i(),m(!1)},children:[u.jsx(mS,{style:{marginRight:"12px",verticalAlign:"middle"}}),"CONTACT US"]})]})})]})}const N4="/Web_FationS/assets/hero-fallback-Dpuj8qSv.jpg";function P4(){const[n,e]=$.useState(!1);return u.jsxs("section",{className:"hero",id:"home","aria-label":"Welcome to MAISON",children:[u.jsxs("div",{className:"hero-bg",children:[u.jsx("img",{src:N4,alt:"MAISON Hero Background",className:"hero-fallback",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:n?0:1,transition:"opacity 1s ease-in-out",zIndex:1},loading:"eager",fetchPriority:"high"}),u.jsx("iframe",{src:"https://www.youtube-nocookie.com/embed/YDErLmbjSRM?autoplay=1&mute=1&loop=1&playlist=YDErLmbjSRM&controls=0&showinfo=0&rel=0&modestbranding=1&playsinline=1&enablejsapi=1",title:"MAISON Hero Video",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,onLoad:()=>{setTimeout(()=>e(!0),1500)},loading:"lazy",style:{opacity:n?1:0,transition:"opacity 1s ease-in-out",zIndex:2}}),u.jsx("div",{className:"hero-video-overlay",style:{zIndex:3}})]}),u.jsx("div",{className:"hero-overlay"}),u.jsxs("div",{className:"hero-content",children:[u.jsx("h1",{className:"hero-title",children:"MAISON"}),u.jsx("p",{className:"hero-subtitle",children:"Premium Lifestyle Wear"}),u.jsxs("div",{className:"hero-buttons",children:[u.jsx("a",{href:"#shop",className:"btn btn-primary",children:"Shop Now"}),u.jsx("a",{href:"#about",className:"btn btn-outline",children:"Our Story"})]})]}),u.jsxs("div",{className:"scroll-indicator",children:[u.jsx("span",{children:"Scroll"}),u.jsx("div",{className:"scroll-line"})]})]})}const Mn={men:{title:"Men's Collection",description:"",image:"https://calvinklein.scene7.com/is/image/CalvinKlein/4RE100G_2EX_main?wid=1728&qlt=80%2C0&resMode=sharp2&op_usm=0.9%2C1.0%2C8%2C0&iccEmbed=0&fmt=webp",products:[{id:0,name:"Cropped Relaxed Button-Down Shirt",price:1990,model:"Cropped Relaxed",size:"S, M, L, XL",material:"100% Cotton",color:"Brown, White,",stock:10,image:"https://calvinklein.scene7.com/is/image/CalvinKlein/4RE100G_2EX_alternate3?wid=1728&qlt=80%2C0&resMode=sharp2&op_usm=0.9%2C1.0%2C8%2C0&iccEmbed=0&fmt=webp",colorVariants:[{name:"Brown",hex:"#8B4513",image:"https://calvinklein.scene7.com/is/image/CalvinKlein/4RE100G_2EX_alternate3?wid=1728&qlt=80%2C0&resMode=sharp2&op_usm=0.9%2C1.0%2C8%2C0&iccEmbed=0&fmt=webp"},{name:"White",hex:"#fafafa",image:"https://calvinklein.scene7.com/is/image/CalvinKlein/4RE100G_YAA_main?wid=1728&qlt=80%2C0&resMode=sharp2&op_usm=0.9%2C1.0%2C8%2C0&iccEmbed=0&fmt=webp"}]},{id:1,name:"Lanvin Embroidered",price:17147.9,model:"Lanvin x Gallery Dept. Embroidered Logo",size:"S, M, L, XL, XXL",material:"100% Premium Cotton",color:"Milk, Black, Red",stock:10,image:"https://www.careofcarl.com/bilder/artiklar/zoom/24874411r_1.jpg?m=1678713083",colorVariants:[{name:"Milk",hex:"#FFFAF0",image:"https://www.careofcarl.com/bilder/artiklar/zoom/24874411r_1.jpg?m=1678713083"},{name:"Black",hex:"#000000",image:"https://us.lanvin.com/cdn/shop/files/RM-TS0012-J303-H2510_3.jpg?v=1753304215&width=600"},{name:"Red",hex:"#DC143C",image:"https://encrypted-tbn0.gstatic.com/shopping?q=tbn:ANd9GcRVqaj1axInipgUfKUF8ZoYvF1hsdjWzjjNswDHQpRIGeAHm1TX9N-GbL92f3u8BnNsZpCz_hGdLpf8CvdiZEauUXRGQW3dJAjbVYT_nJbX1_DTeA0pvZ492g"}]},{id:2,name:"JADED LONDON JEANS",price:3490.65,model:"Colossus",size:"28, 30, 32, 34, 36",material:"Denim Cotton 100%",color:"Blue, ",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/Artboard3_645df2f2-2859-407f-ba66-2cfcb3b8335e.jpg?v=1758557493",colorVariants:[{name:"Blue",hex:"#4169E1",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/Artboard3_645df2f2-2859-407f-ba66-2cfcb3b8335e.jpg?v=1758557493"}]},{id:3,name:"Air Jordan 1 Low SE",price:4200.87,model:"DC6991-400",size:"42, 44, 46, 48",material:"Premium Leather",color:"Sky",stock:10,image:"https://static.nike.com/a/images/t_web_pdp_535_v2/f_auto,u_126ab356-44d8-4a06-89b4-fcdcc8df0245,c_scale,fl_relative,w_1.0,h_1.0,fl_layer_apply/b82e5764-c9ce-4fec-b72a-d4ea98d28614/AIR+JORDAN+1+LOW+SE.png",colorVariants:[{name:"Sky",hex:"#4fc3f7",image:"https://static.nike.com/a/images/t_web_pdp_535_v2/f_auto,u_126ab356-44d8-4a06-89b4-fcdcc8df0245,c_scale,fl_relative,w_1.0,h_1.0,fl_layer_apply/b82e5764-c9ce-4fec-b72a-d4ea98d28614/AIR+JORDAN+1+LOW+SE.png"}]},{id:4,name:"Shield Sunglasses",price:7600.34,model:"Horizon Slate",size:"-",material:"Stainless Steel, Titanium",color:"Gold Silver",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/JADEDEYEWEAR7136.jpg?v=1752057589",colorVariants:[{name:"Gold Silver",hex:"#ae917c",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/JADEDEYEWEAR7136.jpg?v=1752057589"}]},{id:5,name:"Tour Belt",price:16990.34,model:"925 Sterling Silver Necklace",size:"-",material:"leather",color:"Cream",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/FLAT6.jpg",colorVariants:[{name:"Cream",hex:"#fff",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/FLAT6.jpg"}]},{id:101,name:"Kasper Digi Waffle T-Shirt",price:12990.43,model:"Digi Waffle Premium",size:"S, M, L, XL",material:"100% Cotton Waffle Knit",color:"Cream",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMT6381_3.jpg",colorVariants:[{name:"Cream",hex:"#f5f5dc",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMT6381_3.jpg"}],tag:"NEW"}]},women:{title:"Women's Collection",description:"",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/15JANWWECCOM1725_b7eeee80-0a2c-46b7-8113-65b6913bdb0a.jpg",products:[{id:201,name:"Mid Blue Slub Colossus Jeans",price:1990,model:"Colossus Jeans",size:"S, M, L, XL",material:"100% Cotton",color:"Blue",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/19DECWW1715.jpg",colorVariants:[{name:"Blue",hex:"#4169E1",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/19DECWW1792.jpg?v=1735045513"}]},{id:6,name:"Sand Oil Wash Colossus Jorts",price:1990,model:"Colossus Jorts",size:"S, M, L, XL",material:"100% Cotton",color:"Brown",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/sow4.jpg?v=1718728210",colorVariants:[{name:"Brown",hex:"#d7ccc8",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/sow2.jpg?v=1718728210"}]},{id:601,name:"Liberty 2 In 1 Detachable Denim Black Midi Dress",price:4560,model:"Midi Dress",size:"S, M, L, XL",material:"100% Cotton",color:"Gray",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/products/WOMENS4125.jpg",colorVariants:[{name:"Gray",hex:"#757575",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/products/WOMENS4125.jpg"}]},{id:602,name:"Woodland Camo Colossus Baggy Jeans",price:4350.34,model:"Camo Colossus",size:"XS, S, M, L",material:"Heavyweight Cotton Canvas",color:"Brown",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/Artboard9_5aa03e9d-b79e-475f-8296-985e8ab60f7c.jpg?v=1764004687",colorVariants:[{name:"Brown",hex:"#9d877eff",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/Artboard9_5aa03e9d-b79e-475f-8296-985e8ab60f7c.jpg?v=1764004687"}]},{id:7,name:"Haka Mongolian Faux Fur Knit Shrug",price:3490.76,model:"Cropped Zip-up Hoodie",size:"XS, S, M, L",material:"Cotton Fleece, Synthetic Faux Fur",color:"Burgundy",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/15JANWWECCOM0527.jpg",colorVariants:[{name:"Burgundy",hex:"#ec407a",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/15JANWWECCOM0527.jpg"}]},{id:8,name:"Maison Margiela Future High-Top",price:34708.1,model:"Maison Margiela",size:"XS, S, M, L",material:"Nappa Leather",color:"Off-White / Bone",stock:10,image:"https://cdn-images.farfetch-contents.com/32/12/66/11/32126611_61968168_1000.jpg",colorVariants:[{name:"Off-White / Bone",hex:"#fffde7",image:"https://cdn-images.farfetch-contents.com/32/12/66/11/32126611_61968168_1000.jpg"}]},{id:9,name:"Oversized Shield Sunglasses",price:4490.61,model:"BELOW 0 Sunglasses",size:"Oversized",material:"Premium Acetate",color:"Jelly Brown/Amber",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/STYLE_12.jpg?v=1751897296",colorVariants:[{name:"Jelly Brown/Amber",hex:"#bcaaa4",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/STYLE_12.jpg?v=1751897296"}]},{id:102,name:"Shadow Studded Corset Top",price:15490.76,model:"Studded Leather Corset",size:"S, M, L, XL, XXL",material:"Premium Leather with Metal Studs",color:"Black",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/11NOVWW0238.jpg",colorVariants:[{name:"Black",hex:"#1a1a1a",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/11NOVWW0238.jpg"}],tag:"HOT"},{id:103,name:"Black Mist Mini Dress",price:8990.9,model:"Mist Collection",size:"XS, S, M, L",material:"Premium Stretch Fabric",color:"Black",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/Artboard1_89082489-8716-4060-b764-2095115259e3.jpg",colorVariants:[{name:"Black",hex:"#0d0d0d",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/Artboard1_89082489-8716-4060-b764-2095115259e3.jpg"}],tag:"NEW"}]},unisex:{title:"Unisex Collection",description:"",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/JMG5580_FLF5_0925_fed9e934-530c-4e4f-8272-5f8b9c123beb.jpg?v=1759308216",products:[{id:11,name:"Asymmetrical Faux Fur Buckle Vest",price:2490.87,model:"Faux Fur Buckle",size:"-",material:"High-quality Faux Fur",color:"Brown / Sandy Brown",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/JMA4434_F2_0925_fc2f751c-639a-4ded-b756-62bbcffb36c2.jpg?v=1759308172",colorVariants:[{name:"Brown",hex:"#a1887f",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/JMA4434_F2_0925_fc2f751c-639a-4ded-b756-62bbcffb36c2.jpg?v=1759308172"}]},{id:1101,name:"Rebel Military Jacket in Khaki",price:3670.87,model:"Military Jacket",size:"M, L, XL",material:"100% Cutton",color:"Green, Gray, Black",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMDJ6064_F1_1125.jpg",colorVariants:[{name:"Green",hex:"#33691e",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMDJ6064_F1_1125.jpg"},{name:"Gray",hex:"#bdbdbd",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMJK4056_F1_0725.jpg"},{name:"Black",hex:"#000000",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JADEDMAN23MAY73480.jpg"}]},{id:1102,name:"Sporty Baggy Monster Hoodie",price:5470.87,model:"Sporty Baggy",size:"M, L, XL",material:"100% Cutton",color:"Gray, Blue",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/15JANWWECCOM1292.jpg?v=1737996348",colorVariants:[{name:"Gray",hex:"#bdbdbd",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/15JANWWECCOM1292.jpg?v=1737996348"},{name:"Blue",hex:"#283593",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/Artboard1_a7af62d9-1df2-4e06-a649-003dee60d630.jpg"}]},{id:1103,name:"Strike Metal Belt",price:2200.87,model:"Strike Metal ",size:"-",material:"High-quality Leather",color:"Black",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMA6231_F1_0925edited.jpg",colorVariants:[{name:"Black",hex:"#000000",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/JMA6231_F1_0925.jpg?v=1760096508"}]},{id:12,name:"Super Baggy Distressed Jeans",price:2990.87,model:"Baggy Distressed Jeans",size:"M, L, XL",material:"Washed Denim",color:"Light Blue",stock:10,image:"https://www.fugazee.com/cdn/shop/files/28-04-202533082.jpg?v=1746881795&width=860",colorVariants:[{name:"Light Blue",hex:"#4fc3f7",image:"https://www.fugazee.com/cdn/shop/files/28-04-202533082.jpg?v=1746881795&width=860"}]},{id:13,name:"Fluffy Tote Bag",price:1398.73,model:"Fluffy",size:"-",material:"Fluffy Material",color:"Cream",stock:10,image:"https://futurefusiononline.com/cdn/shop/files/HNE024.0.jpg?v=1701783873",colorVariants:[{name:"Brown",hex:"#a1887f",image:"https://futurefusiononline.com/cdn/shop/files/HNE024.0.jpg?v=1701783873"}]},{id:14,name:"Raised Embroidery XL Jeans",price:1498.73,model:"Embroidery",size:"M, L, XL",material:"Washed Denim",color:"Black",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/12-12-25FLATS1.jpg",colorVariants:[{name:"Black",hex:"#000000",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/12-12-25FLATS1.jpg"}]},{id:15,name:"Ecru Merida Jacket",price:2698.43,model:"Ecru Merida",size:"M, L, XL",material:"High-quality Fluffy",color:"Cream",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/29-10-25FLATS27.jpg",colorVariants:[{name:"Cream",hex:"#a1887f",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/29-10-25FLATS27.jpg"}]},{id:16,name:"Premium Silk Scarf",price:1990,model:"AC-SC-2026",size:"90x90 cm",material:"100% Silk",color:"Various Patterns",stock:10,image:"https://images.unsplash.com/photo-1591047139829-d91aecb6caea?w=600",colorVariants:[{name:"Various Patterns",hex:"#b27c68ff",image:"https://images.unsplash.com/photo-1591047139829-d91aecb6caea?w=600"}]},{id:17,name:"Chunky Silver Bangles",price:12990.25,model:"Chunky silver bangle",size:"7.8mm x 2mm",material:"Stainless Steel",color:"Silver",stock:10,image:"https://hotdiamonds.co.uk/images/trio-bangle-p3481-11871_image.jpg",colorVariants:[{name:"Silver",hex:"#e0e0e0",image:"https://hotdiamonds.co.uk/images/trio-bangle-p3481-11871_image.jpg"}]},{id:104,name:"Mendoza Faux Fur Jacket",price:6490.87,model:"Mendoza Collection",size:"One Size",material:"High-Quality Faux Fur",color:"Brown",stock:10,image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/29SEP1629.jpg",colorVariants:[{name:"Brown",hex:"#8d6e63",image:"https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/29SEP1629.jpg"}],tag:"SALE"}]},sports:{title:"Sports & Lifestyle",description:"",image:"https://backend.liverpoolfc.com/sites/default/files/styles/lg/public/2025-08/lfc-adidas-kit-players-gallery-290725-_%285%29_aa98730959953c4ca02084644878a82b.webp?itok=E8bSx0tx&width=1680",products:[{id:301,name:"Premium Running Sneakers",price:4990,model:"Air Flow X",size:"39, 40, 41, 42, 43, 44",material:"Mesh & Synthetic",color:"White/Black, Red/White",stock:15,image:"https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=800",colorVariants:[{name:"White/Black",hex:"#ffffff",image:"https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=800"},{name:"Red/White",hex:"#e53935",image:"https://images.unsplash.com/photo-1608231387042-66d1773070a5?w=800"}],tag:"NEW"},{id:302,name:"Athletic Performance Hoodie",price:2490,model:"Comfort Fit",size:"S, M, L, XL, XXL",material:"Cotton Blend with DryFit",color:"Black, Gray, Navy",stock:20,image:"https://images.unsplash.com/photo-1556821840-3a63f95609a7?w=800",colorVariants:[{name:"Black",hex:"#212121",image:"https://images.unsplash.com/photo-1556821840-3a63f95609a7?w=800"},{name:"Gray",hex:"#9e9e9e",image:"https://images.unsplash.com/photo-1620799140408-edc6dcb6d633?w=800"}]},{id:303,name:"Premium Jogger Pants",price:1890,model:"Flex Motion",size:"S, M, L, XL",material:"Stretch Cotton",color:"Black, Olive",stock:18,image:"https://images.unsplash.com/photo-1552902865-b72c031ac5ea?w=800",colorVariants:[{name:"Black",hex:"#212121",image:"https://images.unsplash.com/photo-1552902865-b72c031ac5ea?w=800"},{name:"Olive",hex:"#6d7c4e",image:"https://images.unsplash.com/photo-1624378439575-d8705ad7ae80?w=800"}]},{id:304,name:"Sports Duffle Bag",price:2290,model:"Gym Essential",size:"50x30x25 cm",material:"Durable Nylon",color:"Black, Navy",stock:12,image:"https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=800",colorVariants:[{name:"Black",hex:"#212121",image:"https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=800"}]},{id:305,name:"Training Tank Top",price:890,model:"Breathe Tech",size:"S, M, L, XL",material:"Quick-Dry Polyester",color:"White, Black, Blue",stock:25,image:"https://images.unsplash.com/photo-1571902943202-507ec2618e8f?w=800",colorVariants:[{name:"White",hex:"#ffffff",image:"https://images.unsplash.com/photo-1571902943202-507ec2618e8f?w=800"},{name:"Black",hex:"#212121",image:"https://images.unsplash.com/photo-1618354691373-d851c5c3a990?w=800"}],tag:"HOT"},{id:306,name:"Performance Compression Shorts",price:1290,model:"Pro Stretch",size:"S, M, L, XL",material:"Spandex Blend",color:"Black, Gray",stock:20,image:"https://images.unsplash.com/photo-1591195853828-11db59a44f6b?w=800",colorVariants:[{name:"Black",hex:"#212121",image:"https://images.unsplash.com/photo-1591195853828-11db59a44f6b?w=800"}]},{id:307,name:"Adjustable Cap",price:790,model:"Sun Shield",size:"Adjustable",material:"Cotton Canvas",color:"Navy, White",stock:30,image:"https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800",colorVariants:[{name:"Navy",hex:"#1a237e",image:"https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800"},{name:"White",hex:"#ffffff",image:"https://images.unsplash.com/photo-1588850561407-ed78c282e89b?w=800"}]},{id:308,name:"Yoga Mat Premium",price:1590,model:"Non-Slip Pro",size:"183x61 cm",material:"TPE Eco-Friendly",color:"Purple, Teal",stock:15,image:"https://images.unsplash.com/photo-1601925260368-ae2f83cf8b7f?w=800",colorVariants:[{name:"Purple",hex:"#7b1fa2",image:"https://images.unsplash.com/photo-1601925260368-ae2f83cf8b7f?w=800"},{name:"Teal",hex:"#00796b",image:"https://images.unsplash.com/photo-1592432678016-e910b452f9a2?w=800"}]}]}},R4=[{id:101,name:"Kasper Digi Waffle T-Shirt",price:12990.43,size:"S, M, L, XL",stock:10,images:["https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMT6381_3.jpg","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/12-12-25FLATS16.jpg?v=1765796400","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/JMT6381_1.jpg?v=1765796400"],tag:"NEW",description:""},{id:102,name:"Shadow Studded Corset Top",price:15490.76,size:"S, M, L, XL, XXL",stock:10,images:["https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/11NOVWW0238.jpg","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/11NOVWW02636.jpg?v=1742381921","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/11NOVWW0261.jpg?v=1742381921"],tag:"HOT",description:" "},{id:103,name:"Black Mist Mini Dress",price:8990.9,size:"XS, S, M, L",stock:10,images:["https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/Artboard1_89082489-8716-4060-b764-2095115259e3.jpg","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/Artboard2_bbd8f9a1-5df7-4352-858f-6753d0fe8dfa.jpg?v=1764686209","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/Artboard3_59f5cece-6486-4999-81ae-7fb38fcd13a7.jpg?v=1764686209"],tag:"NEW",description:""},{id:104,name:"Mendoza Faux Fur Jacket",price:6490.87,size:"One Size",stock:10,images:["https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/29SEP1629.jpg","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/29SEP1593.jpg?v=1696350547","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/29SEP1679.jpg?v=1696350547"],tag:"SALE",description:""}];function b4({collectionKey:n,data:e,onClick:t}){return u.jsxs("div",{className:"collection-card",onClick:t,children:[u.jsx("img",{src:e.image,alt:e.title,loading:"lazy",decoding:"async"}),u.jsxs("div",{className:"collection-info",children:[u.jsx("h3",{className:"collection-name",children:e.title}),u.jsx("p",{className:"collection-desc",children:e.description}),u.jsxs("span",{className:"collection-count",children:[e.products.length," Products "]})]})]})}function D4({onOpenModal:n}){return u.jsxs("section",{className:"collections",id:"shop",children:[u.jsxs("div",{className:"section-header",children:[u.jsx("span",{className:"section-tag",children:"Discover"}),u.jsx("h2",{className:"section-title",children:"Featured Collections"}),u.jsx("div",{className:"section-line"})]}),u.jsx("div",{className:"collection-grid",children:Object.entries(Mn).map(([e,t])=>u.jsx(b4,{collectionKey:e,data:t,onClick:()=>n(e)},e))})]})}var pS=ZI();function S_({product:n,onClose:e,onAddToCart:t}){const[r,i]=$.useState(null),{formatPrice:a}=$.useContext(Zr),l=$.useRef(null),d=$.useRef(null),g=n.size?n.size==="One Size"||n.size==="-"?["One Size"]:n.size.split(",").map(E=>E.trim()):[],v=E=>{E.target.classList.contains("size-modal-overlay")&&e()};$.useEffect(()=>{const E=O=>{if(O.key==="Escape"){e();return}if(O.key==="Tab"&&l.current){const U=l.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),L=U[0],oe=U[U.length-1];O.shiftKey&&document.activeElement===L?(O.preventDefault(),oe.focus()):!O.shiftKey&&document.activeElement===oe&&(O.preventDefault(),L.focus())}},A=document.activeElement;return document.addEventListener("keydown",E),document.body.style.overflow="hidden",setTimeout(()=>{d.current&&d.current.focus()},100),()=>{document.removeEventListener("keydown",E),document.body.style.overflow="auto",A&&A.focus()}},[e]);const I=()=>{r&&(t({...n,image:n.images?n.images[0]:n.image,selectedSize:r}),e())};return pS.createPortal(u.jsx("div",{className:"size-modal-overlay active",onClick:v,role:"dialog","aria-modal":"true","aria-labelledby":"size-modal-title",children:u.jsxs("div",{className:"size-modal",ref:l,children:[u.jsx("button",{className:"size-modal-close",onClick:e,"aria-label":"",ref:d,children:""}),u.jsxs("div",{className:"size-modal-content",children:[u.jsx("div",{className:"size-modal-image",children:u.jsx("img",{src:n.images?n.images[0]:n.image,alt:` ${n.name}`})}),u.jsxs("div",{className:"size-modal-info",children:[u.jsx("h3",{className:"size-modal-title",id:"size-modal-title",children:n.name}),u.jsx("p",{className:"size-modal-price",children:a(n.price)}),u.jsxs("p",{className:"size-modal-stock",children:["In Stock: ",n.stock||0]}),u.jsxs("div",{className:"size-selection",role:"group","aria-label":"",children:[u.jsx("p",{className:"size-label",id:"size-group-label",children:""}),u.jsx("div",{className:"size-options",role:"radiogroup","aria-labelledby":"size-group-label",children:g.map(E=>u.jsx("button",{className:`size-option ${r===E?"selected":""}`,onClick:()=>i(E),role:"radio","aria-checked":r===E,"aria-label":` ${E}`,children:E},E))}),!r&&u.jsx("p",{className:"size-hint",role:"alert",children:""})]}),u.jsx("button",{className:`size-add-btn ${r?"":"disabled"}`,onClick:I,disabled:!r,"aria-label":r?` ${r} `:"",children:r?`Add to Cart - ${r}`:"Please Select Size"})]})]})]})}),document.body)}function j4({product:n}){const{addToCart:e}=$.useContext(Xr),{formatPrice:t}=$.useContext(Zr),[r,i]=$.useState(0),[a,l]=$.useState(!1),[d,m]=$.useState(!1),g=E=>{E.stopPropagation(),i(A=>A===n.images.length-1?0:A+1)},v=E=>{E.stopPropagation(),i(A=>A===0?n.images.length-1:A-1)},I=E=>{E.stopPropagation(),m(!0)};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"new-arrival-card",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[u.jsxs("div",{className:"new-arrival-image",children:[u.jsx("img",{src:n.images[r],alt:n.name,loading:"lazy",decoding:"async"}),u.jsx("span",{className:`arrival-tag ${n.tag.toLowerCase()}`,children:n.tag}),a&&n.images.length>1&&u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"carousel-arrow left",onClick:v,children:""}),u.jsx("button",{className:"carousel-arrow right",onClick:g,children:""})]}),u.jsx("div",{className:"image-dots",children:n.images.map((E,A)=>u.jsx("span",{className:`dot ${A===r?"active":""}`,onClick:O=>{O.stopPropagation(),i(A)}},A))}),u.jsx("button",{className:"arrival-add-to-cart",onClick:I,children:"Add to Cart"})]}),u.jsxs("div",{className:"new-arrival-info",children:[u.jsx("h3",{className:"arrival-name",children:n.name}),u.jsx("p",{className:"arrival-desc",children:n.description}),u.jsx("span",{className:"arrival-price",children:t(n.price)})]})]}),d&&u.jsx(S_,{product:n,onClose:()=>m(!1),onAddToCart:e})]})}function V4(){return u.jsxs("section",{className:"new-arrivals",id:"new-arrivals",children:[u.jsxs("div",{className:"section-header",children:[u.jsx("span",{className:"section-tag",children:"Just In"}),u.jsx("h2",{className:"section-title",children:"New Arrivals"}),u.jsx("div",{className:"section-line"})]}),u.jsx("div",{className:"arrivals-grid",children:R4.map(n=>u.jsx(j4,{product:n},n.id))})]})}const L4="/Web_FationS/assets/kantawan-DjDlOoaw.jpg",O4="/Web_FationS/assets/thanaphat-m19izJh8.jpg";function M4(){const[n,e]=$.useState(!1),t=[{id:1,name:"Mr.Kantawan Maisonklang",role:"Lead Developer & Designer",image:L4,description:" Front-end  UI/UX ",skills:["React","JavaScript","CSS","UI Design"]},{id:2,name:"Mr.Thanaphat Wibakthaisong",role:"Backend Developer & Project Manager",image:O4,description:" Backend ",skills:["Node.js","Database","API","Project Management"]}];return u.jsxs("section",{className:"about",id:"about",children:[u.jsxs("div",{className:"about-wrapper",children:[u.jsx("div",{className:"about-image",children:u.jsx("img",{src:"https://a-static.besthdwallpaper.com/aespa-s-ningning-drama-album-the-giant-vers-shoot-wallpaper-2560x1600-123396_7.jpg",alt:"About MAISON",loading:"lazy",decoding:"async"})}),u.jsxs("div",{className:"about-content",children:[u.jsx("span",{className:"section-tag",children:"About Us"}),u.jsx("h2",{className:"about-title",children:"Our Story"}),u.jsx("p",{className:"about-text",children:"MAISON     "}),u.jsxs("div",{className:"about-features",children:[u.jsxs("div",{className:"feature-item",children:[u.jsx("div",{className:"feature-number",children:"500+"}),u.jsx("div",{className:"feature-label",children:"Products"})]}),u.jsxs("div",{className:"feature-item",children:[u.jsx("div",{className:"feature-number",children:"10K+"}),u.jsx("div",{className:"feature-label",children:"Customers"})]}),u.jsxs("div",{className:"feature-item",children:[u.jsx("div",{className:"feature-number",children:"50+"}),u.jsx("div",{className:"feature-label",children:"Countries"})]})]})]})]}),u.jsxs("div",{className:"more-section",children:[u.jsxs("button",{className:`more-btn ${n?"active":""}`,onClick:()=>e(!n),children:[u.jsx("span",{children:n?"CLOSE":"MORE"}),u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n?"rotate":"",children:u.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),u.jsxs("div",{className:`creators-panel ${n?"open":""}`,children:[u.jsxs("div",{className:"creators-header",children:[u.jsx("h3",{children:""}),u.jsx("p",{children:" MAISON"})]}),u.jsx("div",{className:"creators-grid",children:t.map(r=>u.jsxs("div",{className:"creator-card",children:[u.jsx("div",{className:"creator-image",children:u.jsx("img",{src:r.image,alt:r.name,loading:"lazy",decoding:"async"})}),u.jsxs("div",{className:"creator-info",children:[u.jsx("h4",{className:"creator-name",children:r.name}),u.jsx("span",{className:"creator-role",children:r.role}),u.jsx("p",{className:"creator-description",children:r.description}),u.jsx("div",{className:"creator-skills",children:r.skills.map((i,a)=>u.jsx("span",{className:"skill-tag",children:i},a))})]})]},r.id))})]})]})]})}function F4({onNavigate:n,onNavigateCategory:e}){const t=(a,l)=>{a.preventDefault(),e&&e(l)},r=(a,l)=>{a.preventDefault(),n&&n(l)},i=(a,l)=>{a.preventDefault(),n&&(n("home"),setTimeout(()=>{const d=document.getElementById(l);d&&d.scrollIntoView({behavior:"smooth"})},100))};return u.jsxs("footer",{className:"footer",children:[u.jsxs("div",{className:"footer-content",children:[u.jsxs("div",{className:"footer-brand",children:[u.jsx("div",{className:"logo",children:"MAISON"}),u.jsx("p",{children:" "}),u.jsxs("div",{className:"footer-social",children:[u.jsx("a",{href:"https://facebook.com",target:"_blank",rel:"noopener noreferrer",className:"social-icon",title:"Facebook","aria-label":"Facebook",children:u.jsx(w4,{})}),u.jsx("a",{href:"https://instagram.com",target:"_blank",rel:"noopener noreferrer",className:"social-icon",title:"Instagram","aria-label":"Instagram",children:u.jsx(I4,{})}),u.jsx("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer",className:"social-icon",title:"Twitter","aria-label":"Twitter",children:u.jsx(E4,{})}),u.jsx("a",{href:"https://youtube.com",target:"_blank",rel:"noopener noreferrer",className:"social-icon",title:"YouTube","aria-label":"YouTube",children:u.jsx(T4,{})})]})]}),u.jsxs("div",{className:"footer-column",children:[u.jsx("h4",{children:"Shop"}),u.jsxs("ul",{children:[u.jsx("li",{children:u.jsx("a",{href:"#men",onClick:a=>t(a,"men"),children:"Men's Collection"})}),u.jsx("li",{children:u.jsx("a",{href:"#women",onClick:a=>t(a,"women"),children:"Women's Collection"})}),u.jsx("li",{children:u.jsx("a",{href:"#accessories",onClick:a=>t(a,"accessories"),children:"Accessories"})}),u.jsx("li",{children:u.jsx("a",{href:"#new",onClick:a=>t(a,"new-arrivals"),children:"New Arrivals"})}),u.jsx("li",{children:u.jsx("a",{href:"#sale",onClick:a=>r(a,"sale"),children:"Sale"})})]})]}),u.jsxs("div",{className:"footer-column",children:[u.jsx("h4",{children:"Support"}),u.jsxs("ul",{children:[u.jsx("li",{children:u.jsx("a",{href:"#contact",onClick:a=>i(a,"footer"),children:"Contact Us"})}),u.jsx("li",{children:u.jsx("a",{href:"#faqs",children:"FAQs"})}),u.jsx("li",{children:u.jsx("a",{href:"#shipping",children:"Shipping Info"})}),u.jsx("li",{children:u.jsx("a",{href:"#returns",children:"Returns"})}),u.jsx("li",{children:u.jsx("a",{href:"#size-guide",children:"Size Guide"})})]})]}),u.jsxs("div",{className:"footer-column",children:[u.jsx("h4",{children:"Company"}),u.jsxs("ul",{children:[u.jsx("li",{children:u.jsx("a",{href:"#about",onClick:a=>i(a,"about"),children:"About Us"})}),u.jsx("li",{children:u.jsx("a",{href:"#careers",children:"Careers"})}),u.jsx("li",{children:u.jsx("a",{href:"#press",children:"Press"})}),u.jsx("li",{children:u.jsx("a",{href:"#privacy",children:"Privacy Policy"})}),u.jsx("li",{children:u.jsx("a",{href:"#terms",children:"Terms of Service"})})]})]}),u.jsxs("div",{className:"footer-column contact-column",children:[u.jsx("h4",{children:""}),u.jsxs("ul",{className:"contact-list",children:[u.jsxs("li",{children:[u.jsx("span",{className:"contact-icon",children:u.jsx(x4,{})}),u.jsxs("div",{className:"contact-info",children:[u.jsx("span",{className:"contact-label",children:""}),u.jsx("span",{children:"123  "}),u.jsx("span",{children:"  10110"})]})]}),u.jsxs("li",{children:[u.jsx("span",{className:"contact-icon",children:u.jsx(S4,{})}),u.jsxs("div",{className:"contact-info",children:[u.jsx("span",{className:"contact-label",children:""}),u.jsx("a",{href:"tel:+6621234567",children:"02-123-4567"}),u.jsx("a",{href:"tel:+66812345678",children:"081-234-5678"})]})]}),u.jsxs("li",{children:[u.jsx("span",{className:"contact-icon",children:u.jsx(mS,{})}),u.jsxs("div",{className:"contact-info",children:[u.jsx("span",{className:"contact-label",children:""}),u.jsx("a",{href:"mailto:contact@maison.co.th",children:"contact@maison.co.th"})]})]}),u.jsxs("li",{children:[u.jsx("span",{className:"contact-icon",children:u.jsx(A4,{})}),u.jsxs("div",{className:"contact-info",children:[u.jsx("span",{className:"contact-label",children:"Line Official"}),u.jsx("a",{href:"https://line.me/ti/p/@maison",target:"_blank",rel:"noopener noreferrer",children:"@maison"})]})]}),u.jsxs("li",{children:[u.jsx("span",{className:"contact-icon",children:u.jsx(C4,{})}),u.jsxs("div",{className:"contact-info",children:[u.jsx("span",{className:"contact-label",children:""}),u.jsx("span",{children:" - : 10:00 - 20:00"}),u.jsx("span",{children:" - : 11:00 - 21:00"})]})]})]})]})]}),u.jsxs("div",{className:"footer-bottom",children:[u.jsx("p",{children:" 2026 MAISON. All rights reserved."}),u.jsx("p",{children:"Made with  in Thailand"})]})]})}function U4({product:n,formatPrice:e,onAddToCart:t}){const[r,i]=$.useState(0),{toggleWishlist:a,isInWishlist:l}=$.useContext(Ul),{isLoggedIn:d,openAuthModal:m}=$.useContext(_r),g=l(n.id),v=n.colorVariants&&n.colorVariants.length>0,I=v?n.colorVariants[r].image:n.image,E=v?n.colorVariants[r].name:n.color,A=()=>{t({...n,image:I,selectedColor:E})},O=()=>{if(!d){m("menu");return}a({...n,selectedColor:E,image:I})};return u.jsxs("div",{className:"gallery-card",children:[u.jsxs("div",{className:"gallery-card-image",children:[u.jsx("img",{src:I,alt:`${n.name} - ${E}`,loading:"lazy",decoding:"async"}),u.jsx("span",{className:`category-badge ${n.category}`,children:n.category==="men"?"Men's":n.category==="women"?"Women's":"Unisex"}),n.tag&&u.jsx("span",{className:`gallery-tag ${n.tag.toLowerCase()}`,children:n.tag}),u.jsx("button",{className:`gallery-wishlist ${g?"active":""}`,onClick:O,title:g?"Remove from Wishlist":"Add to Wishlist",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:g?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),u.jsx("button",{className:"quick-add",onClick:A,children:"+ Add to Cart"})]}),u.jsxs("div",{className:"gallery-card-info",children:[u.jsx("h3",{className:"gallery-card-name",children:n.name}),u.jsx("p",{className:"gallery-card-model",children:n.model}),v&&u.jsxs("div",{className:"gallery-color-selector",children:[u.jsxs("span",{className:"gallery-color-label",children:["Color: ",E]}),u.jsx("div",{className:"gallery-color-options",children:n.colorVariants.map((U,L)=>u.jsx("button",{className:`gallery-color-option ${r===L?"active":""}`,style:{backgroundColor:U.hex},onClick:()=>i(L),title:U.name},U.name))})]}),u.jsxs("div",{className:"gallery-card-footer",children:[u.jsx("span",{className:"gallery-card-price",children:e(n.price)}),u.jsxs("span",{className:"gallery-card-stock",children:["In Stock: ",n.stock]})]})]})]})}function B4({onBack:n,initialSearchTerm:e="",initialCategory:t="all"}){const{addToCart:r}=$.useContext(Xr),[i,a]=$.useState(t),[l,d]=$.useState(e),[m,g]=$.useState("default"),[v,I]=$.useState(null),[E,A]=$.useState([]);$.useEffect(()=>{(async()=>{try{const he=(await ht.collection("products").get()).docs.map(Q=>({id:`fs-${Q.id}`,...Q.data(),category:Q.data().collection||"unisex"}));A(he)}catch(Y){console.log("No Firestore products or error loading:",Y)}})()},[]),$.useEffect(()=>{e&&d(e)},[e]),$.useEffect(()=>{t&&a(t)},[t]);const O=[...Mn.men.products.map(W=>({...W,category:"men"})),...Mn.women.products.map(W=>({...W,category:"women"})),...Mn.unisex.products.map(W=>({...W,category:"unisex"})),...Mn.sports.products.map(W=>({...W,category:"sports"})),...E.map(W=>({...W,model:W.model||W.name}))];let U=O.filter(W=>{const Y=i==="all"||W.category===i,he=W.name.toLowerCase().includes(l.toLowerCase())||W.model.toLowerCase().includes(l.toLowerCase());return Y&&he});m==="price-low"?U=[...U].sort((W,Y)=>W.price-Y.price):m==="price-high"?U=[...U].sort((W,Y)=>Y.price-W.price):m==="name"&&(U=[...U].sort((W,Y)=>W.name.localeCompare(Y.name)));const{formatPrice:L}=$.useContext(Zr),oe=W=>{I(W)},J=[{key:"all",label:"All",count:O.length},{key:"men",label:"Men's",count:Mn.men.products.length},{key:"women",label:"Women's",count:Mn.women.products.length},{key:"unisex",label:"Unisex",count:Mn.unisex.products.length},{key:"sports",label:"Sports",count:Mn.sports.products.length}];return u.jsxs(u.Fragment,{children:[u.jsxs("section",{className:"gallery-section",id:"gallery",children:[u.jsxs("div",{className:"gallery-header",children:[u.jsx("button",{className:"back-btn",onClick:n,children:" Back to Home"}),u.jsxs("div",{className:"section-header",children:[u.jsx("span",{className:"section-tag",children:"Shop"}),u.jsx("h2",{className:"section-title",children:"Product Gallery"}),u.jsx("div",{className:"section-line"})]})]}),u.jsxs("div",{className:"gallery-controls",children:[u.jsxs("div",{className:"search-box",children:[u.jsx("span",{className:"search-icon",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),u.jsx("input",{type:"text",placeholder:"Search products...",value:l,onChange:W=>d(W.target.value)})]}),u.jsx("div",{className:"filter-buttons",children:J.map(W=>u.jsxs("button",{className:`filter-btn ${i===W.key?"active":""}`,onClick:()=>a(W.key),children:[W.label,u.jsx("span",{className:"filter-count",children:W.count})]},W.key))}),u.jsx("div",{className:"sort-dropdown",children:u.jsxs("select",{value:m,onChange:W=>g(W.target.value),children:[u.jsx("option",{value:"default",children:"Sort By"}),u.jsx("option",{value:"price-low",children:"Price: Low - High"}),u.jsx("option",{value:"price-high",children:"Price: High - Low"}),u.jsx("option",{value:"name",children:"Name: A - Z"})]})})]}),u.jsx("div",{className:"gallery-results",children:u.jsxs("p",{children:["Showing ",U.length," items"]})}),u.jsx("div",{className:"gallery-grid",children:U.map((W,Y)=>u.jsx(U4,{product:W,formatPrice:L,onAddToCart:oe},`${W.id}-${Y}`))}),U.length===0&&u.jsxs("div",{className:"no-results",children:[u.jsx("div",{className:"no-results-icon",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),u.jsx("h3",{children:"No products found"}),u.jsx("p",{children:"Try a different search term or select another category"})]})]}),v&&u.jsx(S_,{product:v,onClose:()=>I(null),onAddToCart:r})]})}const z4=[{id:201,name:"Vintage Denim Jacket",originalPrice:5990,price:4792,size:"S, M, L, XL",stock:5,images:["https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JADEDMAN23MAY73480.jpg","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMJK4056_F1_0725.jpg","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMDJ6064_F1_1125.jpg"],discount:20,description:""},{id:202,name:"Premium Leather Belt",originalPrice:2490,price:1992,size:"S, M, L",stock:8,images:["https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/JMA6231_F1_0925.jpg?v=1760096508","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMA6231_F1_0925edited.jpg","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/FLAT6.jpg"],discount:20,description:""},{id:203,name:"Oversized Graphic Tee",originalPrice:1890,price:1512,size:"M, L, XL, XXL",stock:12,images:["https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1600,c_limit/shopi///cdn/shop/files/15JANWWECCOM1292.jpg?v=1737996348","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/Artboard1_a7af62d9-1df2-4e06-a649-003dee60d630.jpg","https://assets.jadedldn.com/image/upload/e_sharpen:50,w_1000,c_limit/shopi///cdn/shop/files/JMT6381_3.jpg"],discount:20,description:""}];function W4({product:n}){const{addToCart:e}=$.useContext(Xr),{toggleWishlist:t,isInWishlist:r}=$.useContext(Ul),{formatPrice:i}=$.useContext(Zr),a=r(n.id);return u.jsxs("div",{className:"sale-product-card",children:[u.jsxs("div",{className:"sale-product-image",children:[u.jsx("img",{src:n.images[0],alt:n.name}),u.jsxs("span",{className:"sale-discount-tag",children:["-",n.discount,"%"]}),n.stock<5&&u.jsxs("span",{className:"sale-badge",style:{fontSize:"12px",padding:"5px 10px",top:"60px",left:"15px",position:"absolute",background:"rgba(0,0,0,0.7)",animation:"none"},children:["Only ",n.stock," left!"]}),u.jsx("button",{className:`wishlist-icon ${a?"active":""}`,onClick:l=>{l.stopPropagation(),t({...n,image:n.images[0]})},style:{position:"absolute",top:"15px",right:"15px",background:"white",border:"none",borderRadius:"50%",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:10},children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:a?"#e74c3c":"none",stroke:a?"#e74c3c":"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})})]}),u.jsxs("div",{className:"sale-product-info",children:[u.jsx("h3",{className:"sale-product-name",children:n.name}),u.jsx("p",{className:"sale-product-desc",children:n.description}),u.jsxs("div",{className:"sale-price-container",children:[u.jsx("span",{className:"sale-discounted-price",children:i(n.price)}),u.jsx("span",{className:"sale-original-price",children:i(n.originalPrice)})]}),u.jsxs("div",{className:"sale-product-sizes",style:{margin:"10px 0",fontSize:"13px",color:"#666"},children:[u.jsx("span",{children:"Sizes: "}),u.jsx("span",{className:"sizes-list",style:{fontWeight:500,color:"#333"},children:n.size})]}),u.jsx("button",{className:"sale-add-to-cart",onClick:l=>{l.stopPropagation(),e({...n,image:n.images[0],selectedSize:n.size.split(",")[0].trim()})},children:"Add to Cart"})]})]})}function q4({onBack:n}){return u.jsxs("section",{className:"final-sale-page",children:[u.jsxs("div",{className:"sale-page-header",children:[u.jsxs("button",{className:"back-button",onClick:n,children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("polyline",{points:"15 18 9 12 15 6"})}),"Back"]}),u.jsxs("div",{className:"sale-banner",children:[u.jsx("span",{className:"sale-badge",children:"FINAL SALE"}),u.jsx("h1",{className:"sale-title",children:" Special Discount 20% OFF "}),u.jsx("p",{className:"sale-subtitle",children:" !"})]})]}),u.jsx("div",{className:"sale-products-grid",children:z4.map(e=>u.jsx(W4,{product:e},e.id))})]})}function Fg({rating:n,onRatingChange:e,readonly:t=!1,size:r=24}){const[i,a]=$.useState(0),l=m=>{!t&&e&&e(m)},d=(m,g)=>{t||(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),l(g))};return u.jsx("div",{className:`star-rating ${t?"readonly":""}`,role:"radiogroup","aria-label":`Rating: ${n} out of 5 stars`,"aria-disabled":t,children:[1,2,3,4,5].map(m=>u.jsx("button",{type:"button",className:`star ${m<=(i||n)?"filled":""}`,onClick:()=>l(m),onMouseEnter:()=>!t&&a(m),onMouseLeave:()=>!t&&a(0),onKeyDown:g=>d(g,m),style:{fontSize:r,cursor:t?"default":"pointer",background:"none",border:"none",padding:0,transition:"color 0.2s ease, transform 0.1s ease",color:m<=(i||n)?"#ffc107":"#e4e5e9"},"aria-label":`Rate ${m} star${m>1?"s":""}`,"aria-pressed":m===n,disabled:t,tabIndex:t?-1:0,children:""},m))})}function $4({productId:n,productName:e,onSubmit:t,onCancel:r}){const{user:i}=$.useContext(_r),[a,l]=$.useState(0),[d,m]=$.useState(""),[g,v]=$.useState(!1),[I,E]=$.useState(""),A=async O=>{var U;if(O.preventDefault(),a===0){E("");return}if(d.trim().length<10){E(" 10 ");return}v(!0),E("");try{const L={productId:n,productName:e,userId:i.id,userName:`${i.firstName} ${((U=i.lastName)==null?void 0:U.charAt(0))||""}.`,rating:a,reviewText:d.trim(),createdAt:Lt.firestore.FieldValue.serverTimestamp()};await ht.collection("reviews").add(L),l(0),m(""),t&&t()}catch(L){console.error("Error submitting review:",L),E("")}v(!1)};return u.jsxs("div",{className:"review-form",children:[u.jsx("h4",{className:"review-form-title",children:""}),I&&u.jsx("div",{className:"review-error",children:I}),u.jsxs("form",{onSubmit:A,children:[u.jsxs("div",{className:"review-rating-section",children:[u.jsx("label",{children:":"}),u.jsx(Fg,{rating:a,onRatingChange:l,size:28})]}),u.jsxs("div",{className:"review-text-section",children:[u.jsx("label",{children:":"}),u.jsx("textarea",{value:d,onChange:O=>m(O.target.value),placeholder:"...",rows:"4",maxLength:"500"}),u.jsxs("span",{className:"char-count",children:[d.length,"/500"]})]}),u.jsxs("div",{className:"review-form-actions",children:[u.jsx("button",{type:"button",className:"review-cancel-btn",onClick:r,children:""}),u.jsx("button",{type:"submit",className:"review-submit-btn",disabled:g,children:g?"...":""})]})]})]})}function H4({productId:n}){const[e,t]=$.useState([]),[r,i]=$.useState(!0);$.useEffect(()=>{if(n){const l=ht.collection("reviews").where("productId","==",n).orderBy("createdAt","desc").limit(10).onSnapshot(d=>{const m=d.docs.map(g=>({id:g.id,...g.data()}));t(m),i(!1)},d=>{console.error("Error loading reviews:",d),i(!1)});return()=>l()}},[n]);const a=e.length>0?(e.reduce((l,d)=>l+d.rating,0)/e.length).toFixed(1):0;return r?u.jsx("div",{className:"reviews-loading",children:"..."}):u.jsxs("div",{className:"product-reviews",children:[u.jsx("div",{className:"reviews-summary",children:u.jsxs("div",{className:"average-rating",children:[u.jsx("span",{className:"rating-number",children:a}),u.jsx(Fg,{rating:Math.round(a),readonly:!0,size:20}),u.jsxs("span",{className:"review-count",children:["(",e.length," )"]})]})}),e.length===0?u.jsxs("div",{className:"no-reviews",children:[u.jsx("p",{children:""}),u.jsx("p",{className:"no-reviews-hint",children:"!"})]}):u.jsx("div",{className:"reviews-list",children:e.map(l=>u.jsxs("div",{className:"review-card",children:[u.jsxs("div",{className:"review-header",children:[u.jsxs("div",{className:"reviewer-info",children:[u.jsx("span",{className:"reviewer-name",children:l.userName}),u.jsx(Fg,{rating:l.rating,readonly:!0,size:16})]}),u.jsx("span",{className:"review-date",children:l.createdAt?new Date(l.createdAt.seconds*1e3).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric"}):""})]}),u.jsx("p",{className:"review-text",children:l.reviewText})]},l.id))})]})}function G4({product:n,onClose:e}){var v;const{user:t,isLoggedIn:r,openAuthModal:i}=$.useContext(_r),[a,l]=$.useState(!1),d=I=>{I.target.classList.contains("review-modal-overlay")&&e()};$.useEffect(()=>{const I=E=>{E.key==="Escape"&&e()};return document.addEventListener("keydown",I),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",I),document.body.style.overflow="auto"}},[e]);const m={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e5,overflow:"hidden"},g={position:"relative",backgroundColor:"#fff",borderRadius:"16px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto",padding:"24px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)"};return pS.createPortal(u.jsx("div",{className:"review-modal-overlay active",style:m,onClick:d,children:u.jsxs("div",{className:"review-modal",style:g,children:[u.jsx("button",{className:"review-modal-close",onClick:e,style:{position:"absolute",top:"12px",right:"12px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},children:""}),u.jsxs("div",{className:"review-modal-header",style:{display:"flex",gap:"16px",marginBottom:"20px"},children:[u.jsx("img",{src:n.image||((v=n.images)==null?void 0:v[0]),alt:n.name,className:"review-product-image",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"8px"}}),u.jsx("div",{className:"review-product-info",style:{display:"flex",alignItems:"center"},children:u.jsx("h3",{style:{margin:0,fontSize:"1.25rem",fontWeight:600},children:n.name})})]}),a&&r?u.jsx($4,{productId:n.id,productName:n.name,onSubmit:()=>l(!1),onCancel:()=>l(!1)}):u.jsxs(u.Fragment,{children:[u.jsx(H4,{productId:n.id}),u.jsx("div",{className:"review-modal-actions",style:{marginTop:"20px",textAlign:"center"},children:r?u.jsx("button",{className:"write-review-btn",onClick:()=>l(!0),style:{background:"linear-gradient(135deg, #c9a55a, #dbb978)",color:"#fff",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:600},children:" "}):u.jsx("button",{className:"write-review-btn",onClick:()=>i("login"),style:{background:"linear-gradient(135deg, #c9a55a, #dbb978)",color:"#fff",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:600},children:""})})]})]})}),document.body)}function K4({product:n,onClose:e}){var m;const t=window.location.href,r=`${n.name} - ${(m=n.price)==null?void 0:m.toLocaleString()} | MAISON Premium Lifestyle Wear`,i=()=>{window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}&quote=${encodeURIComponent(r)}`,"_blank","width=600,height=400")},a=()=>{window.open(`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(t)}&text=${encodeURIComponent(r)}`,"_blank","width=600,height=400")},l=()=>{window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(t)}&text=${encodeURIComponent(r)}`,"_blank","width=600,height=400")},d=()=>{navigator.clipboard.writeText(t).then(()=>{alert("!")})};return u.jsxs("div",{className:"share-buttons",children:[u.jsx("button",{className:"share-btn facebook",onClick:i,title:"Share to Facebook",children:u.jsx("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:u.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}),u.jsx("button",{className:"share-btn line",onClick:a,title:"Share to Line",children:u.jsx("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:u.jsx("path",{d:"M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"})})}),u.jsx("button",{className:"share-btn twitter",onClick:l,title:"Share to X/Twitter",children:u.jsx("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:u.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})}),u.jsx("button",{className:"share-btn copy",onClick:d,title:"Copy Link",children:u.jsxs("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),u.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})})]})}function Q4({product:n}){const{addToCart:e}=$.useContext(Xr),{toggleWishlist:t,isInWishlist:r}=$.useContext(Ul),{isLoggedIn:i,openAuthModal:a}=$.useContext(_r),{formatPrice:l}=$.useContext(Zr),{addToCompare:d,isInCompare:m}=$.useContext(sm),[g,v]=$.useState(!1),[I,E]=$.useState(!1),[A,O]=$.useState(!1),[U,L]=$.useState(0),oe=r(n.id),J=m(n.id),W=n.colorVariants&&n.colorVariants.length>0,Y=W?n.colorVariants[U].image:n.image,he=W?n.colorVariants[U].name:n.color,Q=()=>{if(!i){a("menu");return}v(!0)},P=()=>{if(!i){a("menu");return}t({...n,selectedColor:he,image:Y})},S=()=>{d({...n,image:Y})};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"product-card",children:[u.jsxs("div",{className:"product-image",children:[u.jsx("img",{src:Y,alt:n.name,loading:"lazy",decoding:"async"}),u.jsxs("span",{className:"product-badge",children:["In Stock: ",n.stock]}),u.jsx("button",{className:`product-wishlist ${oe?"active":""}`,onClick:P,children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:oe?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),u.jsxs("div",{className:"product-quick-actions",children:[u.jsx("button",{className:`quick-action-btn compare ${J?"active":""}`,onClick:S,title:J?"":"",children:""}),u.jsx("button",{className:"quick-action-btn share",onClick:()=>O(!A),title:"",children:""})]}),A&&u.jsx("div",{className:"share-dropdown",children:u.jsx(K4,{product:{...n,image:Y}})})]}),u.jsxs("div",{className:"product-info",children:[u.jsx("h3",{className:"product-name",children:n.name}),W&&u.jsxs("div",{className:"color-selector",children:[u.jsxs("span",{className:"color-label",children:["Color: ",he]}),u.jsx("div",{className:"color-options",children:n.colorVariants.map((R,j)=>u.jsx("button",{className:`color-option ${U===j?"active":""}`,style:{backgroundColor:R.hex},onClick:()=>L(j),title:R.name},R.name))})]}),u.jsxs("ul",{className:"product-details",children:[u.jsxs("li",{children:[u.jsx("span",{className:"detail-label",children:"Model"}),u.jsx("span",{className:"detail-value",children:n.model})]}),u.jsxs("li",{children:[u.jsx("span",{className:"detail-label",children:"Size"}),u.jsx("span",{className:"detail-value",children:n.size})]}),u.jsxs("li",{children:[u.jsx("span",{className:"detail-label",children:"Material"}),u.jsx("span",{className:"detail-value",children:n.material})]})]}),u.jsx("div",{className:"product-price",children:l(n.price)}),u.jsxs("div",{className:"product-actions",children:[u.jsx("button",{className:"add-to-cart",onClick:Q,children:"Add to Cart"}),u.jsx("button",{className:"review-btn",onClick:()=>E(!0),title:"",children:" Reviews"})]})]})]}),g&&u.jsx(S_,{product:{...n,image:Y,selectedColor:he},onClose:()=>v(!1),onAddToCart:e}),I&&u.jsx(G4,{product:{...n,image:Y},onClose:()=>E(!1)})]})}function J4({collectionKey:n,onClose:e}){const t=Mn[n],[r,i]=$.useState([]);if($.useEffect(()=>{n&&(async()=>{try{const g=(await ht.collection("products").where("collection","==",n).get()).docs.map(v=>({id:`fs-${v.id}`,...v.data(),model:v.data().model||v.data().name,colorVariants:v.data().colorVariants||[{name:v.data().color||"Default",hex:"#888888",image:v.data().image}]}));i(g)}catch(m){console.log("Error loading Firestore products:",m)}})()},[n]),!t)return null;const a=[...t.products,...r],l=d=>{d.target.classList.contains("modal-overlay")&&e()};return $.useEffect(()=>{const d=m=>{m.key==="Escape"&&e()};return document.addEventListener("keydown",d),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",d),document.body.style.overflow="auto"}},[e]),u.jsx("div",{className:"modal-overlay active",onClick:l,children:u.jsxs("div",{className:"modal",children:[u.jsxs("div",{className:"modal-header",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"modal-title",children:t.title}),u.jsx("p",{className:"modal-subtitle",children:t.description})]}),u.jsx("button",{className:"modal-close",onClick:e,children:""})]}),u.jsx("div",{className:"products-grid",children:a.map(d=>u.jsx(Q4,{product:d},d.id))})]})})}function Y4({onClose:n,onSearch:e}){const[t,r]=$.useState(""),i=m=>{m.preventDefault(),t.trim()&&(e(t.trim()),n())},a=m=>{m.target.classList.contains("search-overlay")&&n()};$.useEffect(()=>{const m=g=>{g.key==="Escape"&&n()};return document.addEventListener("keydown",m),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",m),document.body.style.overflow="auto"}},[n]);const l=[...Mn.men.products,...Mn.women.products,...Mn.unisex.products],d=t.length>1?l.filter(m=>m.name.toLowerCase().includes(t.toLowerCase())||m.model.toLowerCase().includes(t.toLowerCase())).slice(0,5):[];return u.jsx("div",{className:"search-overlay active",onClick:a,children:u.jsxs("div",{className:"search-modal",children:[u.jsxs("div",{className:"search-header",children:[u.jsxs("form",{onSubmit:i,className:"search-form",children:[u.jsx("span",{className:"search-input-icon",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),u.jsx("input",{type:"text",placeholder:"Search products...",value:t,onChange:m=>r(m.target.value),autoFocus:!0}),u.jsx("button",{type:"submit",className:"search-submit-btn",children:"Search"})]}),u.jsx("button",{className:"search-close",onClick:n,children:""})]}),d.length>0&&u.jsxs("div",{className:"search-suggestions",children:[u.jsx("p",{className:"suggestions-title",children:"Suggested Products"}),d.map(m=>u.jsxs("div",{className:"suggestion-item",onClick:()=>{e(m.name),n()},children:[u.jsx("img",{src:m.image,alt:m.name}),u.jsxs("div",{className:"suggestion-info",children:[u.jsx("span",{className:"suggestion-name",children:m.name}),u.jsx("span",{className:"suggestion-model",children:m.model})]})]},m.id))]}),t.length===0&&u.jsxs("div",{className:"search-popular",children:[u.jsx("p",{className:"suggestions-title",children:"Popular Categories"}),u.jsxs("div",{className:"popular-tags",children:[u.jsx("button",{onClick:()=>{e("Jeans"),n()},children:" Jeans"}),u.jsx("button",{onClick:()=>{e("Sunglasses"),n()},children:" Sunglasses"}),u.jsx("button",{onClick:()=>{e("Jacket"),n()},children:" Jacket"}),u.jsx("button",{onClick:()=>{e("Jordan"),n()},children:" Jordan"})]})]})]})})}function X4(){const{cart:n,removeFromCart:e,updateQuantity:t,cartTotal:r,isCartOpen:i,setIsCartOpen:a,setIsCheckoutOpen:l}=$.useContext(Xr),{formatPrice:d}=$.useContext(Zr);return i?u.jsx("div",{className:`cart-overlay ${i?"active":""}`,children:u.jsxs("div",{className:"cart-sidebar",children:[u.jsxs("div",{className:"cart-header",children:[u.jsx("h3",{className:"cart-title",children:"Shopping Cart"}),u.jsx("button",{className:"modal-close",onClick:()=>a(!1),children:""})]}),u.jsx("div",{className:"cart-items",children:n.length===0?u.jsxs("div",{className:"cart-empty",children:[u.jsx("div",{className:"cart-empty-icon",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("circle",{cx:"9",cy:"21",r:"1"}),u.jsx("circle",{cx:"20",cy:"21",r:"1"}),u.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})}),u.jsx("p",{children:"Your cart is empty"})]}):n.map(m=>u.jsxs("div",{className:"cart-item",children:[u.jsx("div",{className:"cart-item-image",children:u.jsx("img",{src:m.image,alt:m.name})}),u.jsxs("div",{className:"cart-item-info",children:[u.jsx("h4",{className:"cart-item-name",children:m.name}),u.jsxs("p",{className:"cart-item-size",children:["Size: ",m.selectedSize]}),u.jsx("p",{className:"cart-item-price",children:d(m.price)}),u.jsxs("div",{className:"cart-item-qty",children:[u.jsx("button",{className:"qty-btn",onClick:()=>t(m.id,m.selectedSize,-1),children:"-"}),u.jsx("span",{children:m.quantity}),u.jsx("button",{className:"qty-btn",onClick:()=>t(m.id,m.selectedSize,1),children:"+"})]})]}),u.jsx("button",{className:"cart-item-remove",onClick:()=>e(m.id,m.selectedSize),children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("polyline",{points:"3 6 5 6 21 6"}),u.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},`${m.id}-${m.selectedSize}`))}),n.length>0&&u.jsxs("div",{className:"cart-footer",children:[u.jsxs("div",{className:"cart-total",children:[u.jsx("span",{className:"cart-total-label",children:"Total"}),u.jsx("span",{className:"cart-total-price",children:d(r)})]}),u.jsx("button",{className:"checkout-btn",onClick:()=>{a(!1),l(!0)},children:"Proceed to Checkout"})]})]})}):null}function Z4(){const{wishlist:n,removeFromWishlist:e,wishlistCount:t,isWishlistOpen:r,setIsWishlistOpen:i}=$.useContext(Ul),{addToCart:a}=$.useContext(Xr),{formatPrice:l}=$.useContext(Zr);return r?u.jsx("div",{className:`wishlist-overlay ${r?"active":""}`,children:u.jsxs("div",{className:"wishlist-sidebar",children:[u.jsxs("div",{className:"wishlist-header",children:[u.jsxs("h3",{className:"wishlist-title",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"8px",display:"inline"},children:u.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})," My Wishlist (",t,")"]}),u.jsx("button",{className:"modal-close",onClick:()=>i(!1),children:""})]}),u.jsx("div",{className:"wishlist-items",children:n.length===0?u.jsxs("div",{className:"wishlist-empty",children:[u.jsx("div",{className:"wishlist-empty-icon",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[u.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"}),u.jsx("line",{x1:"2",y1:"2",x2:"22",y2:"22"})]})}),u.jsx("p",{children:"Your wishlist is empty"}),u.jsx("span",{className:"wishlist-empty-hint",children:"Click the heart icon on products you love!"})]}):n.map(d=>{var m;return u.jsxs("div",{className:"wishlist-item",children:[u.jsx("div",{className:"wishlist-item-image",children:u.jsx("img",{src:d.image||((m=d.images)==null?void 0:m[0]),alt:d.name})}),u.jsxs("div",{className:"wishlist-item-info",children:[u.jsx("h4",{className:"wishlist-item-name",children:d.name}),u.jsx("p",{className:"wishlist-item-price",children:l(d.price)}),u.jsx("button",{className:"wishlist-add-cart-btn",onClick:()=>{a(d),e(d.id)},children:"Add to Cart"})]}),u.jsx("button",{className:"wishlist-item-remove",onClick:()=>e(d.id),children:""})]},d.id)})})]})}):null}function eL({userId:n}){const[e,t]=$.useState([]),[r,i]=$.useState(!0);$.useEffect(()=>{if(n){const l=ht.collection("orders").where("userId","==",n).orderBy("createdAt","desc").onSnapshot(d=>{const m=d.docs.map(g=>({id:g.id,...g.data()}));t(m),i(!1)},d=>{console.error("Error loading orders:",d),i(!1)});return()=>l()}},[n]);const a=l=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(l);return r?u.jsx("div",{className:"orders-loading",children:"..."}):e.length===0?u.jsxs("div",{className:"orders-empty",children:[u.jsx("div",{className:"orders-empty-icon",children:""}),u.jsx("p",{children:""})]}):u.jsx("div",{className:"orders-list",children:e.map(l=>{var d,m;return u.jsxs("div",{className:"order-card",children:[u.jsxs("div",{className:"order-header",children:[u.jsxs("div",{className:"order-id",children:["#",l.id.slice(-8).toUpperCase()]}),u.jsx("div",{className:`order-status status-${l.status||"pending"}`,children:l.status==="completed"?"":l.status==="shipped"?"":""})]}),u.jsx("div",{className:"order-date",children:l.createdAt?new Date(l.createdAt.seconds*1e3).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}),u.jsxs("div",{className:"order-items",children:[(d=l.items)==null?void 0:d.slice(0,3).map((g,v)=>u.jsx("span",{className:"order-item-name",children:g.name},v)),((m=l.items)==null?void 0:m.length)>3&&u.jsxs("span",{className:"order-more",children:["+",l.items.length-3," "]})]}),u.jsxs("div",{className:"order-total",children:[": ",u.jsx("strong",{children:a(l.total)})]})]},l.id)})})}function tL({user:n,onBack:e,onSave:t}){const[r,i]=$.useState({firstName:n.firstName||"",lastName:n.lastName||"",phone:n.phone||"",address:n.address||""}),[a,l]=$.useState(!1),[d,m]=$.useState(!1),g=I=>{i({...r,[I.target.name]:I.target.value})},v=async I=>{I.preventDefault(),l(!0);try{await t(r),m(!0),setTimeout(()=>m(!1),2e3)}catch(E){console.error("Error saving:",E)}l(!1)};return u.jsxs("div",{className:"auth-edit-profile",children:[u.jsx("button",{className:"auth-back",onClick:e,children:" Back"}),u.jsx("h2",{className:"auth-title",children:""}),d&&u.jsx("div",{className:"auth-success",children:"!"}),u.jsxs("form",{onSubmit:v,className:"auth-form",children:[u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"text",name:"firstName",value:r.firstName,onChange:g,placeholder:""})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"text",name:"lastName",value:r.lastName,onChange:g,placeholder:""})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:g,placeholder:""})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("textarea",{name:"address",value:r.address,onChange:g,placeholder:"",rows:"3"})]}),u.jsx("button",{type:"submit",className:"auth-submit-btn",disabled:a,children:a?"...":""})]})]})}function nL({onBack:n,onSuccess:e}){const[t,r]=$.useState({name:"",price:"",model:"",size:"S, M, L, XL",material:"",color:"",colorHex:"#3498db",stock:"10",image:"",collection:"men"}),[i,a]=$.useState(!1),[l,d]=$.useState(""),[m,g]=$.useState(!1),v=E=>{r({...t,[E.target.name]:E.target.value})},I=async E=>{if(E.preventDefault(),!t.name||!t.price||!t.image){d(",   URL ");return}a(!0),d("");try{const A={name:t.name,price:parseFloat(t.price),model:t.model||t.name,size:t.size,material:t.material||"Mixed Materials",color:t.color||"Various",stock:parseInt(t.stock)||10,image:t.image,collection:t.collection,colorVariants:[{name:t.color||"Default",hex:t.colorHex||"#888888",image:t.image}],createdAt:Lt.firestore.FieldValue.serverTimestamp()};await ht.collection("products").add(A),g(!0),r({name:"",price:"",model:"",size:"S, M, L, XL",material:"",color:"",colorHex:"#3498db",stock:"10",image:"",collection:"men"}),setTimeout(()=>{g(!1),e&&e()},2e3)}catch(A){console.error("Error adding product:",A),d("")}a(!1)};return u.jsxs("div",{className:"admin-add-product",children:[u.jsx("button",{className:"auth-back",onClick:n,children:" "}),u.jsx("h2",{className:"admin-title",children:" "}),l&&u.jsx("div",{className:"admin-error",children:l}),m&&u.jsx("div",{className:"admin-success",children:" !"}),u.jsxs("form",{onSubmit:I,className:"admin-product-form",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" *"}),u.jsx("input",{type:"text",name:"name",value:t.name,onChange:v,placeholder:""})]}),u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" () *"}),u.jsx("input",{type:"number",name:"price",value:t.price,onChange:v,placeholder:"1990.00",step:"0.01"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"number",name:"stock",value:t.stock,onChange:v,placeholder:"10"})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" / Model"}),u.jsx("input",{type:"text",name:"model",value:t.model,onChange:v,placeholder:""})]}),u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"text",name:"size",value:t.size,onChange:v,placeholder:"S, M, L, XL"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"text",name:"color",value:t.color,onChange:v,placeholder:"White / Clear Blue"})]})]}),u.jsx("div",{className:"form-row",children:u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" ()"}),u.jsxs("div",{className:"color-picker-wrapper",children:[u.jsx("input",{type:"color",name:"colorHex",value:t.colorHex,onChange:v,className:"color-picker-input"}),u.jsx("input",{type:"text",name:"colorHex",value:t.colorHex,onChange:v,placeholder:"#3498db",className:"color-hex-input"}),u.jsx("div",{className:"color-preview",style:{backgroundColor:t.colorHex}})]})]})}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"text",name:"material",value:t.material,onChange:v,placeholder:"100% Cotton"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"URL  *"}),u.jsx("input",{type:"url",name:"image",value:t.image,onChange:v,placeholder:"https://..."}),t.image&&u.jsx("div",{className:"image-preview",children:u.jsx("img",{src:t.image,alt:"Preview",onError:E=>E.target.style.display="none"})})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" Collection *"}),u.jsxs("select",{name:"collection",value:t.collection,onChange:v,children:[u.jsx("option",{value:"men",children:"Men's Collection"}),u.jsx("option",{value:"women",children:"Women's Collection"}),u.jsx("option",{value:"unisex",children:"Unisex Collection"}),u.jsx("option",{value:"sports",children:"Sports & Lifestyle"})]})]}),u.jsx("button",{type:"submit",className:"admin-submit-btn",disabled:i,children:i?"...":" "})]})]})}function rL({onBack:n}){const[e,t]=$.useState("menu"),[r,i]=$.useState([]),[a,l]=$.useState(!1),d=()=>{l(!0),ht.collection("products").orderBy("createdAt","desc").limit(20).get().then(g=>{const v=g.docs.map(I=>({id:I.id,...I.data()}));i(v),l(!1)}).catch(g=>{console.error("Error loading products:",g),l(!1)})},m=async g=>{if(window.confirm("?"))try{await ht.collection("products").doc(g).delete(),i(r.filter(v=>v.id!==g))}catch(v){console.error("Error deleting product:",v)}};return e==="add"?u.jsx(nL,{onBack:()=>t("menu"),onSuccess:()=>t("menu")}):e==="list"?u.jsxs("div",{className:"admin-product-list",children:[u.jsx("button",{className:"auth-back",onClick:()=>t("menu"),children:" "}),u.jsx("h2",{className:"admin-title",children:"  Admin"}),a?u.jsx("div",{className:"admin-loading",children:"..."}):r.length===0?u.jsx("div",{className:"admin-empty",children:" Admin"}):u.jsx("div",{className:"admin-products-grid",children:r.map(g=>{var v;return u.jsxs("div",{className:"admin-product-card",children:[u.jsx("img",{src:g.image,alt:g.name}),u.jsxs("div",{className:"admin-product-info",children:[u.jsx("h4",{children:g.name}),u.jsxs("p",{className:"admin-product-price",children:["",(v=g.price)==null?void 0:v.toLocaleString()]}),u.jsx("p",{className:"admin-product-collection",children:g.collection})]}),u.jsx("button",{className:"admin-delete-btn",onClick:()=>m(g.id),children:""})]},g.id)})})]}):u.jsxs("div",{className:"admin-panel",children:[u.jsx("button",{className:"auth-back",onClick:n,children:" "}),u.jsx("h2",{className:"admin-title",children:" Admin Panel"}),u.jsxs("div",{className:"admin-menu",children:[u.jsxs("button",{className:"admin-menu-btn",onClick:()=>t("add"),children:[u.jsx("span",{className:"admin-menu-icon",children:""}),u.jsx("span",{className:"admin-menu-text",children:""})]}),u.jsxs("button",{className:"admin-menu-btn",onClick:()=>{t("list"),d()},children:[u.jsx("span",{className:"admin-menu-icon",children:""}),u.jsx("span",{className:"admin-menu-text",children:""})]})]})]})}function sL(){var R,j;const{user:n,isLoggedIn:e,register:t,login:r,loginWithGoogle:i,logout:a,isAuthModalOpen:l,authMode:d,setAuthMode:m,authError:g,setAuthError:v,closeAuthModal:I}=$.useContext(_r),[E,A]=$.useState({email:"",password:""}),[O,U]=$.useState({firstName:"",lastName:"",phone:"",email:"",address:"",other:"",username:"",password:"",confirmPassword:""}),[L,oe]=$.useState({}),J=N=>{A({...E,[N.target.name]:N.target.value}),v("")},W=N=>{U({...O,[N.target.name]:N.target.value}),oe({...L,[N.target.name]:""}),v("")},Y=()=>{const N={};return O.firstName.trim()||(N.firstName="First name is required"),O.lastName.trim()||(N.lastName="Last name is required"),O.phone.trim()||(N.phone="Phone is required"),O.email.trim()?/\S+@\S+\.\S+/.test(O.email)||(N.email="Invalid email format"):N.email="Email is required",O.address.trim()||(N.address="Address is required"),O.username.trim()?O.username.length<4&&(N.username="Username must be at least 4 characters"):N.username="Username is required",O.password?O.password.length<6&&(N.password="Password must be at least 6 characters"):N.password="Password is required",O.password!==O.confirmPassword&&(N.confirmPassword="Passwords do not match"),oe(N),Object.keys(N).length===0},he=async N=>{if(N.preventDefault(),!E.email||!E.password){v("");return}await r(E.email,E.password)},Q=async()=>{await i()},P=async N=>{N.preventDefault(),Y()&&await t(O)},S=N=>{N.target.classList.contains("auth-overlay")&&I()};return $.useEffect(()=>{const N=M=>{M.key==="Escape"&&I()};return l&&(document.addEventListener("keydown",N),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",N),document.body.style.overflow=""}},[l]),l?u.jsx("div",{className:"auth-overlay",onClick:S,children:u.jsxs("div",{className:"auth-modal",children:[u.jsx("button",{className:"modal-close",onClick:I,children:""}),d==="menu"&&u.jsxs("div",{className:"auth-menu",children:[u.jsx("div",{className:"auth-icon",children:""}),u.jsx("h2",{className:"auth-title",children:"Welcome to MAISON"}),e?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"auth-user-info",children:[u.jsxs("p",{className:"user-greeting",children:["Hello, ",u.jsxs("strong",{children:[n.firstName,"!"]})]}),u.jsx("p",{className:"user-email",children:n.email})]}),u.jsxs("button",{className:"auth-btn profile-btn",onClick:()=>m("profile"),children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),u.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"View Profile"]}),u.jsxs("button",{className:"auth-btn logout-btn",onClick:a,children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),u.jsx("polyline",{points:"16 17 21 12 16 7"}),u.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Logout"]})]}):u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"auth-subtitle",children:"Sign in to add items to cart and wishlist"}),u.jsx("button",{className:"auth-btn signin-btn",onClick:()=>m("login"),children:"Sign In"}),u.jsx("button",{className:"auth-btn register-btn",onClick:()=>m("register"),children:"Create Account"})]})]}),d==="profile"&&e&&u.jsxs("div",{className:"auth-profile",children:[u.jsx("button",{className:"auth-back",onClick:()=>m("menu"),children:" Back"}),u.jsxs("div",{className:"profile-header",children:[u.jsxs("div",{className:"profile-avatar",children:[(R=n.firstName)==null?void 0:R.charAt(0).toUpperCase(),((j=n.lastName)==null?void 0:j.charAt(0).toUpperCase())||""]}),u.jsxs("h2",{className:"profile-name",children:[n.firstName," ",n.lastName]}),u.jsx("p",{className:"profile-email",children:n.email})]}),u.jsxs("div",{className:"profile-tabs",children:[u.jsx("button",{className:"profile-tab active",onClick:N=>{N.target.parentElement.querySelectorAll(".profile-tab").forEach(M=>M.classList.remove("active")),N.target.classList.add("active"),document.getElementById("profile-info").style.display="block",document.getElementById("profile-orders").style.display="none"},children:""}),u.jsx("button",{className:"profile-tab",onClick:N=>{N.target.parentElement.querySelectorAll(".profile-tab").forEach(M=>M.classList.remove("active")),N.target.classList.add("active"),document.getElementById("profile-info").style.display="none",document.getElementById("profile-orders").style.display="block"},children:""})]}),u.jsxs("div",{id:"profile-info",className:"profile-details",children:[u.jsxs("div",{className:"profile-item",children:[u.jsx("span",{className:"profile-label",children:"-"}),u.jsxs("span",{className:"profile-value",children:[n.firstName," ",n.lastName]})]}),u.jsxs("div",{className:"profile-item",children:[u.jsx("span",{className:"profile-label",children:""}),u.jsx("span",{className:"profile-value",children:n.email})]}),u.jsxs("div",{className:"profile-item",children:[u.jsx("span",{className:"profile-label",children:""}),u.jsx("span",{className:"profile-value",children:n.phone||""})]}),u.jsxs("div",{className:"profile-item",children:[u.jsx("span",{className:"profile-label",children:""}),u.jsx("span",{className:"profile-value",children:n.address||""})]}),n.username&&u.jsxs("div",{className:"profile-item",children:[u.jsx("span",{className:"profile-label",children:"Username"}),u.jsx("span",{className:"profile-value",children:n.username})]}),u.jsxs("div",{className:"profile-item",children:[u.jsx("span",{className:"profile-label",children:""}),u.jsx("span",{className:"profile-value",children:n.createdAt?new Date(n.createdAt.seconds*1e3).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}):""})]}),u.jsxs("button",{className:"auth-btn edit-profile-btn",onClick:()=>m("editProfile"),children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),u.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),""]})]}),u.jsx("div",{id:"profile-orders",className:"profile-orders",style:{display:"none"},children:u.jsx(eL,{userId:n.id})}),u.jsxs("div",{className:"profile-actions",children:[u.jsxs("button",{className:"auth-btn admin-btn",onClick:()=>m("admin"),children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("circle",{cx:"12",cy:"12",r:"3"}),u.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),"Admin Panel"]}),u.jsxs("button",{className:"auth-btn logout-btn",onClick:a,children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),u.jsx("polyline",{points:"16 17 21 12 16 7"}),u.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Logout"]})]})]}),d==="editProfile"&&e&&u.jsx(tL,{user:n,onBack:()=>m("profile"),onSave:async N=>{try{await ht.collection("users").doc(n.id).update(N),(await ht.collection("users").doc(n.id).get()).exists,m("profile")}catch(M){console.error("Error updating profile:",M)}}}),d==="admin"&&e&&u.jsx(rL,{onBack:()=>m("profile")}),d==="login"&&u.jsxs("div",{className:"auth-login",children:[u.jsx("button",{className:"auth-back",onClick:()=>m("menu"),children:" Back"}),u.jsx("h2",{className:"auth-title",children:"Sign In"}),u.jsx("p",{className:"auth-subtitle",children:""}),g&&u.jsx("div",{className:"auth-error",children:g}),u.jsxs("form",{onSubmit:he,className:"auth-form",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Email"}),u.jsx("input",{type:"email",name:"email",value:E.email,onChange:J,placeholder:"Enter email"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Password"}),u.jsx("input",{type:"password",name:"password",value:E.password,onChange:J,placeholder:"Enter password"})]}),u.jsx("button",{type:"submit",className:"auth-submit-btn",children:"Sign In"})]}),u.jsx("div",{className:"auth-divider",children:u.jsx("span",{children:""})}),u.jsxs("button",{className:"google-signin-btn",onClick:Q,children:[u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:[u.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),u.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),u.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),u.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Sign in with Google"]}),u.jsxs("p",{className:"auth-switch",children:["Don't have an account?"," ",u.jsx("button",{className:"auth-link",onClick:()=>m("register"),children:"Create Account"})]})]}),d==="register"&&u.jsxs("div",{className:"auth-register",children:[u.jsx("button",{className:"auth-back",onClick:()=>m("menu"),children:" Back"}),u.jsx("h2",{className:"auth-title",children:"Create Account"}),u.jsx("p",{className:"auth-subtitle",children:"Fill in your details"}),g&&u.jsx("div",{className:"auth-error",children:g}),u.jsxs("form",{onSubmit:P,className:"auth-form",children:[u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"First Name *"}),u.jsx("input",{type:"text",name:"firstName",value:O.firstName,onChange:W,placeholder:"First name",className:L.firstName?"error":""}),L.firstName&&u.jsx("span",{className:"field-error",children:L.firstName})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Last Name *"}),u.jsx("input",{type:"text",name:"lastName",value:O.lastName,onChange:W,placeholder:"Last name",className:L.lastName?"error":""}),L.lastName&&u.jsx("span",{className:"field-error",children:L.lastName})]})]}),u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Phone *"}),u.jsx("input",{type:"tel",name:"phone",value:O.phone,onChange:W,placeholder:"Phone",className:L.phone?"error":""}),L.phone&&u.jsx("span",{className:"field-error",children:L.phone})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Email *"}),u.jsx("input",{type:"email",name:"email",value:O.email,onChange:W,placeholder:"Email",className:L.email?"error":""}),L.email&&u.jsx("span",{className:"field-error",children:L.email})]})]}),u.jsxs("div",{className:"form-group full",children:[u.jsx("label",{children:"Address *"}),u.jsx("textarea",{name:"address",value:O.address,onChange:W,placeholder:"Address",className:L.address?"error":""}),L.address&&u.jsx("span",{className:"field-error",children:L.address})]}),u.jsxs("div",{className:"form-group full",children:[u.jsx("label",{children:"Username *"}),u.jsx("input",{type:"text",name:"username",value:O.username,onChange:W,placeholder:"Username (at least 4 chars)",className:L.username?"error":""}),L.username&&u.jsx("span",{className:"field-error",children:L.username})]}),u.jsxs("div",{className:"form-group full",children:[u.jsx("label",{children:"Password *"}),u.jsx("input",{type:"password",name:"password",value:O.password,onChange:W,placeholder:"Password (at least 6 chars)",className:L.password?"error":""}),L.password&&u.jsx("span",{className:"field-error",children:L.password})]}),u.jsxs("div",{className:"form-group full",children:[u.jsx("label",{children:"Confirm Password *"}),u.jsx("input",{type:"password",name:"confirmPassword",value:O.confirmPassword,onChange:W,placeholder:"Confirm Password",className:L.confirmPassword?"error":""}),L.confirmPassword&&u.jsx("span",{className:"field-error",children:L.confirmPassword})]}),u.jsx("button",{type:"submit",className:"auth-submit-btn",children:"Register"})]})]})]})}):null}function iL(){const{cart:n,cartTotal:e,clearCart:t,isCheckoutOpen:r,setIsCheckoutOpen:i}=$.useContext(Xr),{user:a}=$.useContext(_r),[l,d]=$.useState(1),[m,g]=$.useState(""),[v,I]=$.useState(!1),[E,A]=$.useState(""),[O,U]=$.useState(""),[L,oe]=$.useState(null),[J,W]=$.useState(""),[Y,he]=$.useState({firstName:(a==null?void 0:a.firstName)||"",lastName:(a==null?void 0:a.lastName)||"",phone:(a==null?void 0:a.phone)||"",email:(a==null?void 0:a.email)||"",address:(a==null?void 0:a.address)||"",notes:"",cardNumber:"",cardExpiry:"",cardCvv:"",cardName:""}),[Q,P]=$.useState({}),S=(L==null?void 0:L.type)==="shipping"||e>2e3?0:150,R=L?L.type==="percent"?e*(L.value/100):L.type==="fixed"?L.value:0:0,j=e>5e3?500:0,N=R+j,M=Math.max(0,e+S-N),k=b=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(b),be=b=>{const{name:X,value:Se}=b.target;he(Ce=>({...Ce,[X]:Se})),Q[X]&&P(Ce=>({...Ce,[X]:""}))},Ct=()=>{const b={};return Y.firstName.trim()||(b.firstName=""),Y.lastName.trim()||(b.lastName=""),Y.phone.trim()?/^[0-9]{9,10}$/.test(Y.phone.replace(/[-\s]/g,""))||(b.phone=""):b.phone="",Y.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Y.email)||(b.email=""):b.email="",Y.address.trim()||(b.address=""),P(b),Object.keys(b).length===0},Ft=()=>{const b={};return m||(b.paymentMethod=""),m==="card"&&(Y.cardNumber.trim()||(b.cardNumber=""),Y.cardExpiry.trim()||(b.cardExpiry=""),Y.cardCvv.trim()||(b.cardCvv=" CVV"),Y.cardName.trim()||(b.cardName="")),P(b),Object.keys(b).length===0},Xe=()=>{l===1&&Ct()?d(2):l===2&&Ft()&&ce()},ce=async()=>{I(!0);try{const b={userId:(a==null?void 0:a.id)||"guest",items:n.map(Se=>({id:Se.id,name:Se.name,price:Se.price,quantity:Se.quantity,size:Se.selectedSize,image:Se.image})),subtotal:e,shipping:S,discount:N,coupon:(L==null?void 0:L.code)||null,total:M,paymentMethod:m,shippingAddress:{firstName:Y.firstName,lastName:Y.lastName,phone:Y.phone,email:Y.email,address:Y.address,notes:Y.notes},status:"pending",createdAt:Lt.firestore.FieldValue.serverTimestamp()},X=await ht.collection("orders").add(b);A(X.id.slice(-8).toUpperCase()),I(!1),d(3),t()}catch(b){console.error("Error creating order:",b),I(!1);const X="ORD-"+Date.now().toString().slice(-8);A(X),d(3),t()}},we=()=>{i(!1),setTimeout(()=>{d(1),g(""),he({firstName:"",lastName:"",phone:"",email:"",address:"",notes:"",cardNumber:"",cardExpiry:"",cardCvv:"",cardName:""}),P({})},300)},me=b=>{b.target.classList.contains("checkout-overlay")&&we()};return $.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[r]),$.useEffect(()=>{const b=X=>{X.key==="Escape"&&r&&we()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[r]),r?u.jsx("div",{className:`checkout-overlay ${r?"active":""}`,onClick:me,children:u.jsxs("div",{className:"checkout-modal",children:[u.jsx("button",{className:"checkout-close",onClick:we,children:""}),u.jsxs("div",{className:"checkout-progress",children:[u.jsxs("div",{className:`progress-step ${l>=1?"active":""} ${l>1?"completed":""}`,children:[u.jsx("span",{className:"step-number",children:"1"}),u.jsx("span",{className:"step-label",children:""})]}),u.jsx("div",{className:"progress-line"}),u.jsxs("div",{className:`progress-step ${l>=2?"active":""} ${l>2?"completed":""}`,children:[u.jsx("span",{className:"step-number",children:"2"}),u.jsx("span",{className:"step-label",children:""})]}),u.jsx("div",{className:"progress-line"}),u.jsxs("div",{className:`progress-step ${l>=3?"active":""}`,children:[u.jsx("span",{className:"step-number",children:"3"}),u.jsx("span",{className:"step-label",children:""})]})]}),u.jsxs("div",{className:"checkout-content",children:[u.jsxs("div",{className:"checkout-form-section",children:[l===1&&u.jsxs("div",{className:"shipping-form",children:[u.jsx("h3",{className:"form-title",children:" "}),u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" *"}),u.jsx("input",{type:"text",name:"firstName",value:Y.firstName,onChange:be,placeholder:"",className:Q.firstName?"error":""}),Q.firstName&&u.jsx("span",{className:"error-msg",children:Q.firstName})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" *"}),u.jsx("input",{type:"text",name:"lastName",value:Y.lastName,onChange:be,placeholder:"",className:Q.lastName?"error":""}),Q.lastName&&u.jsx("span",{className:"error-msg",children:Q.lastName})]})]}),u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" *"}),u.jsx("input",{type:"tel",name:"phone",value:Y.phone,onChange:be,placeholder:"08X-XXX-XXXX",className:Q.phone?"error":""}),Q.phone&&u.jsx("span",{className:"error-msg",children:Q.phone})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:" *"}),u.jsx("input",{type:"email",name:"email",value:Y.email,onChange:be,placeholder:"your@email.com",className:Q.email?"error":""}),Q.email&&u.jsx("span",{className:"error-msg",children:Q.email})]})]}),u.jsxs("div",{className:"form-group full",children:[u.jsx("label",{children:" *"}),u.jsx("textarea",{name:"address",value:Y.address,onChange:be,placeholder:"  / /  ",rows:"3",className:Q.address?"error":""}),Q.address&&u.jsx("span",{className:"error-msg",children:Q.address})]}),u.jsxs("div",{className:"form-group full",children:[u.jsx("label",{children:" ()"}),u.jsx("textarea",{name:"notes",value:Y.notes,onChange:be,placeholder:",  ",rows:"2"})]})]}),l===2&&u.jsxs("div",{className:"payment-form",children:[u.jsx("h3",{className:"form-title",children:" "}),Q.paymentMethod&&u.jsx("div",{className:"payment-error",children:Q.paymentMethod}),u.jsxs("div",{className:"payment-options",children:[u.jsxs("div",{className:`payment-option ${m==="card"?"selected":""}`,onClick:()=>g("card"),children:[u.jsxs("div",{className:"payment-option-header",children:[u.jsx("span",{className:"payment-icon",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),u.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]})}),u.jsx("span",{className:"payment-name",children:" / "}),u.jsx("span",{className:"payment-check",children:m==="card"?"":""})]}),m==="card"&&u.jsxs("div",{className:"card-form",children:[u.jsxs("div",{className:"form-group full",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"text",name:"cardNumber",value:Y.cardNumber,onChange:be,placeholder:"1234 5678 9012 3456",maxLength:"19",className:Q.cardNumber?"error":""}),Q.cardNumber&&u.jsx("span",{className:"error-msg",children:Q.cardNumber})]}),u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"text",name:"cardExpiry",value:Y.cardExpiry,onChange:be,placeholder:"MM/YY",maxLength:"5",className:Q.cardExpiry?"error":""}),Q.cardExpiry&&u.jsx("span",{className:"error-msg",children:Q.cardExpiry})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"CVV"}),u.jsx("input",{type:"text",name:"cardCvv",value:Y.cardCvv,onChange:be,placeholder:"123",maxLength:"4",className:Q.cardCvv?"error":""}),Q.cardCvv&&u.jsx("span",{className:"error-msg",children:Q.cardCvv})]})]}),u.jsxs("div",{className:"form-group full",children:[u.jsx("label",{children:""}),u.jsx("input",{type:"text",name:"cardName",value:Y.cardName,onChange:be,placeholder:"JOHN DOE",className:Q.cardName?"error":""}),Q.cardName&&u.jsx("span",{className:"error-msg",children:Q.cardName})]})]})]}),u.jsxs("div",{className:`payment-option ${m==="promptpay"?"selected":""}`,onClick:()=>g("promptpay"),children:[u.jsxs("div",{className:"payment-option-header",children:[u.jsx("span",{className:"payment-icon",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}),u.jsx("line",{x1:"12",y1:"18",x2:"12.01",y2:"18"})]})}),u.jsx("span",{className:"payment-name",children:"PromptPay QR Code"}),u.jsx("span",{className:"payment-check",children:m==="promptpay"?"":""})]}),m==="promptpay"&&u.jsx("div",{className:"promptpay-section",children:u.jsxs("div",{className:"qr-placeholder",children:[u.jsx("img",{src:"https://scontent.fbkk4-3.fna.fbcdn.net/v/t1.15752-9/611668838_770002659476648_8793778093247162605_n.jpg?stp=dst-jpg_p480x480_tt6&_nc_cat=109&ccb=1-7&_nc_sid=0024fc&_nc_eui2=AeHZcyqljRo3wEexKCZLhcYrL3QFaPz4uzYvdAVo_Pi7NuetOgtrAz_KciXkWN5i4mEN42h3oi4dzqm9xaKKlmo1&_nc_ohc=YhQfwfUAgCoQ7kNvwHWLEik&_nc_oc=AdlJMIb9ujWZoJKFlvCd8IfMMe99rvvrnLchH_BO0cwU2o_wDcMLmCUE7w6n88Rvqhk&_nc_ad=z-m&_nc_cid=1483&_nc_zt=23&_nc_ht=scontent.fbkk4-3.fna&oh=03_Q7cD4QHvRfpZrEhmKhkjHBN13WTyo6NF-u8pxzRSwqc3PzIC-Q&oe=698EF370",alt:"PromptPay QR Code",className:"promptpay-qr-image"}),u.jsxs("p",{className:"qr-amount",children:[": ",k(M)]}),u.jsx("p",{className:"qr-hint",children:" QR Code "})]})})]}),u.jsxs("div",{className:`payment-option ${m==="cod"?"selected":""}`,onClick:()=>g("cod"),children:[u.jsxs("div",{className:"payment-option-header",children:[u.jsx("span",{className:"payment-icon",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),u.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}),u.jsx("span",{className:"payment-name",children:" (COD)"}),u.jsx("span",{className:"payment-check",children:m==="cod"?"":""})]}),m==="cod"&&u.jsxs("div",{className:"cod-section",children:[u.jsxs("p",{className:"cod-info",children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"8px",verticalAlign:"middle"},children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),u.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})," "]}),u.jsx("p",{className:"cod-fee",children:" COD: 30 ()"})]})]})]})]}),l===3&&u.jsxs("div",{className:"success-section",children:[u.jsx("div",{className:"success-icon",children:""}),u.jsx("h3",{className:"success-title",children:"!"}),u.jsxs("p",{className:"success-order-number",children:[": ",u.jsx("strong",{children:E})]}),u.jsxs("p",{className:"success-message",children:["!  ",Y.email," "]}),u.jsxs("div",{className:"success-details",children:[u.jsxs("p",{children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"8px",verticalAlign:"middle"},children:u.jsx("path",{d:"M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10"})}),"  3-5 "]}),u.jsxs("p",{children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"8px",verticalAlign:"middle"},children:[u.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),u.jsx("polyline",{points:"22,6 12,13 2,6"})]})," "]})]}),u.jsx("button",{className:"success-btn",onClick:we,children:""})]})]}),l!==3&&u.jsxs("div",{className:"checkout-summary",children:[u.jsxs("h3",{className:"summary-title",children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"8px",verticalAlign:"middle"},children:[u.jsx("circle",{cx:"9",cy:"21",r:"1"}),u.jsx("circle",{cx:"20",cy:"21",r:"1"}),u.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})," "]}),u.jsx("div",{className:"summary-items",children:n.map(b=>u.jsxs("div",{className:"summary-item",children:[u.jsx("div",{className:"summary-item-image",children:u.jsx("img",{src:b.image,alt:b.name})}),u.jsxs("div",{className:"summary-item-info",children:[u.jsx("p",{className:"summary-item-name",children:b.name}),u.jsxs("p",{className:"summary-item-details",children:[b.selectedSize&&`: ${b.selectedSize} | `,": ",b.quantity]})]}),u.jsx("div",{className:"summary-item-price",children:k(b.price*b.quantity)})]},b.id))}),u.jsxs("div",{className:"summary-totals",children:[u.jsxs("div",{className:"summary-row",children:[u.jsx("span",{children:""}),u.jsx("span",{children:k(e)})]}),u.jsxs("div",{className:"summary-row",children:[u.jsx("span",{children:""}),u.jsx("span",{children:S===0?"":k(S)})]}),N>0&&u.jsxs("div",{className:"summary-row discount",children:[u.jsx("span",{children:""}),u.jsxs("span",{children:["-",k(N)]})]}),m==="cod"&&u.jsxs("div",{className:"summary-row",children:[u.jsx("span",{children:" COD"}),u.jsx("span",{children:k(30)})]}),u.jsxs("div",{className:"summary-row total",children:[u.jsx("span",{children:""}),u.jsx("span",{children:k(M+(m==="cod"?30:0))})]})]}),S===0&&u.jsxs("div",{className:"free-shipping-badge",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"8px",verticalAlign:"middle"},children:u.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),"!"]}),u.jsxs("div",{className:"checkout-actions",children:[l>1&&l<3&&u.jsx("button",{className:"back-btn",onClick:()=>d(l-1),children:" "}),l<3&&u.jsx("button",{className:`next-btn ${v?"processing":""}`,onClick:Xe,disabled:v,children:v?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"spinner"}),"..."]}):l===1?" ":""})]})]})]})]})}):null}function oL(){const{compareList:n,removeFromCompare:e,clearCompare:t,isCompareOpen:r,setIsCompareOpen:i}=$.useContext(sm),{formatPrice:a}=$.useContext(Zr);return $.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[r]),r?u.jsx("div",{className:"compare-modal-overlay active",onClick:()=>i(!1),children:u.jsxs("div",{className:"compare-modal",onClick:l=>l.stopPropagation(),children:[u.jsx("button",{className:"compare-modal-close",onClick:()=>i(!1),children:""}),u.jsx("h2",{className:"compare-title",children:" "}),n.length===0?u.jsxs("div",{className:"compare-empty",children:[u.jsx("p",{children:""}),u.jsx("p",{className:"compare-hint",children:' "Compare" '})]}):u.jsx("div",{className:"compare-grid",style:{gridTemplateColumns:`repeat(${n.length}, 1fr)`},children:n.map(l=>u.jsxs("div",{className:"compare-product",children:[u.jsx("button",{className:"compare-remove",onClick:()=>e(l.id),children:""}),u.jsx("img",{src:l.image,alt:l.name,className:"compare-product-image"}),u.jsx("h4",{className:"compare-product-name",children:l.name}),u.jsx("div",{className:"compare-product-price",children:a(l.price)}),u.jsxs("div",{className:"compare-specs",children:[u.jsxs("div",{className:"compare-spec",children:[u.jsx("span",{className:"spec-label",children:"Model"}),u.jsx("span",{className:"spec-value",children:l.model})]}),u.jsxs("div",{className:"compare-spec",children:[u.jsx("span",{className:"spec-label",children:"Size"}),u.jsx("span",{className:"spec-value",children:l.size})]}),u.jsxs("div",{className:"compare-spec",children:[u.jsx("span",{className:"spec-label",children:"Material"}),u.jsx("span",{className:"spec-value",children:l.material})]}),u.jsxs("div",{className:"compare-spec",children:[u.jsx("span",{className:"spec-label",children:"Color"}),u.jsx("span",{className:"spec-value",children:l.color})]}),u.jsxs("div",{className:"compare-spec",children:[u.jsx("span",{className:"spec-label",children:"Stock"}),u.jsxs("span",{className:"spec-value",children:[l.stock," "]})]})]})]},l.id))}),n.length>0&&u.jsx("button",{className:"compare-clear-btn",onClick:t,children:" "})]})}):null}function aL(){const{compareCount:n,setIsCompareOpen:e}=$.useContext(sm);return n===0?null:u.jsxs("button",{className:"compare-floating-btn",onClick:()=>e(!0),children:[u.jsx("span",{className:"compare-icon",children:""}),u.jsx("span",{className:"compare-count",children:n}),u.jsx("span",{className:"compare-text",children:""})]})}function lL(){const{user:n,isLoggedIn:e}=$.useContext(_r),[t,r]=$.useState(!1),[i,a]=$.useState([]),[l,d]=$.useState(""),[m,g]=$.useState(!1),v=vf.useRef(null);$.useEffect(()=>{if(e&&(n!=null&&n.id)&&t){const A=`chat_${n.id}`,O=ht.collection("chats").doc(A).collection("messages").orderBy("createdAt","asc").limit(50).onSnapshot(U=>{const L=U.docs.map(oe=>({id:oe.id,...oe.data()}));a(L),I()});return()=>O()}},[e,n==null?void 0:n.id,t]);const I=()=>{setTimeout(()=>{var A;(A=v.current)==null||A.scrollIntoView({behavior:"smooth"})},100)},E=async A=>{if(A.preventDefault(),!l.trim()||m)return;g(!0);const O=`chat_${n.id}`;try{await ht.collection("chats").doc(O).collection("messages").add({text:l.trim(),senderId:n.id,senderName:n.firstName||"User",isAdmin:!1,createdAt:Lt.firestore.FieldValue.serverTimestamp()}),await ht.collection("chats").doc(O).set({userId:n.id,userName:`${n.firstName} ${n.lastName||""}`,userEmail:n.email,lastMessage:l.trim(),lastMessageAt:Lt.firestore.FieldValue.serverTimestamp(),unreadByAdmin:!0},{merge:!0}),d("")}catch(U){console.error("Error sending message:",U)}g(!1)};return e?u.jsxs(u.Fragment,{children:[u.jsx("button",{className:`chat-widget-btn ${t?"active":""}`,onClick:()=>r(!t),children:t?"":""}),t&&u.jsxs("div",{className:"chat-widget-panel",children:[u.jsxs("div",{className:"chat-widget-header",children:[u.jsxs("div",{className:"chat-header-info",children:[u.jsx("span",{className:"chat-status-dot"}),u.jsx("span",{children:"MAISON Support"})]}),u.jsx("button",{className:"chat-minimize",onClick:()=>r(!1),children:""})]}),u.jsxs("div",{className:"chat-messages",children:[i.length===0?u.jsxs("div",{className:"chat-welcome",children:[u.jsx("p",{children:"! "}),u.jsx("p",{children:"?"})]}):i.map(A=>u.jsxs("div",{className:`chat-message ${A.isAdmin?"admin":"user"}`,children:[u.jsx("div",{className:"chat-message-content",children:A.text}),u.jsx("div",{className:"chat-message-time",children:A.createdAt?new Date(A.createdAt.seconds*1e3).toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"}):""})]},A.id)),u.jsx("div",{ref:v})]}),u.jsxs("form",{className:"chat-input-form",onSubmit:E,children:[u.jsx("input",{type:"text",value:l,onChange:A=>d(A.target.value),placeholder:"...",className:"chat-input"}),u.jsx("button",{type:"submit",className:"chat-send-btn",disabled:m,children:m?"...":""})]})]})]}):u.jsx("button",{className:"chat-widget-btn",onClick:()=>alert(" Live Chat"),children:""})}function cL(){const[n,e]=$.useState(!1),[t,r]=$.useState([{type:"bot",text:`!   AI  MAISON

:
 
 
 
 `}]),[i,a]=$.useState(""),[l,d]=$.useState(!1),m=vf.useRef(null),g={:{keywords:["","","delivery","shipping"],response:` :

  1,500
  2-3 
  SMS/Email
  Kerry, Flash, `},:{keywords:["","size","",""],response:` :

 S:  34-36"
 M:  36-38"
 L:  38-40"
 XL:  40-42"

  1 `},:{keywords:["","","return","exchange"],response:` :

  14 
  
  support@maison.com
  5-7 `},:{keywords:["","recommend","","best"],response:` :

1. Cropped Relaxed Button-Down - 1,990
2. Lanvin Embroidered - 17,147
3. JADED LONDON JEANS - 3,490

 "Shop Now" !`},:{keywords:["","contact","","email"],response:` :

 Email: support@maison.com
 Line: @maison
 Tel: 02-xxx-xxxx

 9:00 - 18:00 . `},:{keywords:["","","payment",""],response:` :

 /
 
 PromptPay
  (COD)

 100%`}},v=()=>{setTimeout(()=>{var E;(E=m.current)==null||E.scrollIntoView({behavior:"smooth"})},100)},I=async E=>{if(E.preventDefault(),!i.trim())return;const A=i.trim();r(L=>[...L,{type:"user",text:A}]),a(""),d(!0),v(),await new Promise(L=>setTimeout(L,1e3+Math.random()*1e3));let O=`  

:
 
 
 
 
 `;const U=A.toLowerCase();for(const L in g)if(g[L].keywords.some(oe=>U.includes(oe))){O=g[L].response;break}r(L=>[...L,{type:"bot",text:O}]),d(!1),v()};return u.jsxs(u.Fragment,{children:[u.jsx("button",{className:`ai-chatbot-btn ${n?"active":""}`,onClick:()=>e(!n),title:"AI Assistant",children:""}),n&&u.jsxs("div",{className:"ai-chatbot-panel",children:[u.jsxs("div",{className:"ai-chatbot-header",children:[u.jsx("span",{className:"ai-header-title",children:" MAISON AI Assistant"}),u.jsx("button",{className:"ai-close-btn",onClick:()=>e(!1),children:""})]}),u.jsxs("div",{className:"ai-chatbot-messages",children:[t.map((E,A)=>u.jsx("div",{className:`ai-message ${E.type}`,children:E.text},A)),l&&u.jsx("div",{className:"ai-message bot typing",children:u.jsxs("span",{className:"typing-dots",children:[u.jsx("span",{children:"."}),u.jsx("span",{children:"."}),u.jsx("span",{children:"."})]})}),u.jsx("div",{ref:m})]}),u.jsxs("form",{className:"ai-chatbot-input",onSubmit:I,children:[u.jsx("input",{type:"text",value:i,onChange:E=>a(E.target.value),placeholder:"..."}),u.jsx("button",{type:"submit",children:""})]})]})]})}function uL(){const{toast:n}=$.useContext(Xr);return u.jsxs("div",{className:`toast ${n.show?"show":""}`,children:[u.jsx("span",{className:"toast-icon",children:""}),n.message]})}class hL extends vf.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("App Error:",e,t)}render(){return this.state.hasError?u.jsxs("div",{style:{padding:"2rem",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:[u.jsx("h2",{children:"Something went wrong."}),u.jsx("p",{children:"Please try refreshing the page."}),u.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"1rem",padding:"0.5rem 1rem",cursor:"pointer",backgroundColor:"#333",color:"white",border:"none",borderRadius:"4px"},children:"Refresh Page"})]}):this.props.children}}function dL(){const[n,e]=$.useState(null),[t,r]=$.useState("home"),[i,a]=$.useState(!1),[l,d]=$.useState(""),[m,g]=$.useState("all"),v=A=>{r(A),window.scrollTo({top:0,behavior:"smooth"})},I=A=>{g(A),d(""),v("gallery")},E=A=>{d(A),g("all"),v("gallery")};return u.jsx(a4,{children:u.jsx(r4,{children:u.jsx(s4,{children:u.jsx(l4,{children:u.jsx(o4,{children:u.jsx(i4,{children:u.jsxs("div",{className:"app",id:"main-content",role:"main",children:[u.jsx(k4,{currentPage:t,onNavigate:v,onNavigateCategory:I,onShowSearch:()=>a(!0)}),t==="home"&&u.jsxs(u.Fragment,{children:[u.jsx(P4,{}),u.jsx(D4,{onOpenModal:e}),u.jsx(V4,{}),u.jsx(M4,{})]}),t==="gallery"&&u.jsx(B4,{onBack:()=>{d(""),g("all"),v("home")},initialSearchTerm:l,initialCategory:m}),t==="sale"&&u.jsx(q4,{onBack:()=>v("home")}),u.jsx(F4,{onNavigate:v,onNavigateCategory:I}),n&&u.jsx(J4,{collectionKey:n,onClose:()=>e(null)}),i&&u.jsx(Y4,{onClose:()=>a(!1),onSearch:E}),u.jsx(X4,{}),u.jsx(Z4,{}),u.jsx(sL,{}),u.jsx(iL,{}),u.jsx(oL,{}),u.jsx(aL,{}),u.jsx(lL,{}),u.jsx(cL,{}),u.jsx(uL,{})]})})})})})})})}PA.createRoot(document.getElementById("root")).render(u.jsx(vf.StrictMode,{children:u.jsx(hL,{children:u.jsx(dL,{})})}));
//# sourceMappingURL=index-Vh3E--01.js.map
